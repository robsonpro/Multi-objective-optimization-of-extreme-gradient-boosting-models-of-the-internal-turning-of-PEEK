<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jéssica Tito Vieira, Robson Bruno Dutra Pereira, Carlos Henrique Lauro, Lincoln Cardoso Brandão, João Roberto Ferreira">

<title>Multi-objective evolutionary optimization of extreme gradient boosting regression models of the internal turning of PEEK tubes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="MOEA_XGB_Internal_turning_PEEK_files/libs/clipboard/clipboard.min.js"></script>
<script src="MOEA_XGB_Internal_turning_PEEK_files/libs/quarto-html/quarto.js"></script>
<script src="MOEA_XGB_Internal_turning_PEEK_files/libs/quarto-html/popper.min.js"></script>
<script src="MOEA_XGB_Internal_turning_PEEK_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="MOEA_XGB_Internal_turning_PEEK_files/libs/quarto-html/anchor.min.js"></script>
<link href="MOEA_XGB_Internal_turning_PEEK_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="MOEA_XGB_Internal_turning_PEEK_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="MOEA_XGB_Internal_turning_PEEK_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="MOEA_XGB_Internal_turning_PEEK_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="MOEA_XGB_Internal_turning_PEEK_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Multi-objective evolutionary optimization of extreme gradient boosting regression models of the internal turning of PEEK tubes</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jéssica Tito Vieira, Robson Bruno Dutra Pereira, Carlos Henrique Lauro, Lincoln Cardoso Brandão, João Roberto Ferreira </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<hr>
<section id="loading-libraries" class="level2">
<h2 class="anchored" data-anchor-id="loading-libraries">Loading libraries</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rsm)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DiceDesign)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(splines)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xgboost)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mco)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plot3D)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emoa)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caRamel)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="experimental-design" class="level2">
<h2 class="anchored" data-anchor-id="experimental-design">Experimental design</h2>
<p>Central composite design with Faure sampling aditional points:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>plan_ccd <span class="ot">&lt;-</span> <span class="fu">ccd</span>(<span class="at">basis =</span> <span class="sc">~</span>x1<span class="sc">+</span>x2<span class="sc">+</span>x3, </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">n0 =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>),</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="st">"rotatable"</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">randomize =</span> F,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">coding =</span> <span class="fu">list</span> (x1 <span class="sc">~</span> (vc <span class="sc">-</span> <span class="dv">250</span>)<span class="sc">/</span><span class="dv">85</span>, </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                           x2 <span class="sc">~</span> (f <span class="sc">-</span> <span class="fl">0.125</span>)<span class="sc">/</span><span class="fl">0.04</span>, </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                           x3 <span class="sc">~</span> (fp <span class="sc">-</span> <span class="dv">15</span>)<span class="sc">/</span><span class="dv">8</span>))</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>plan_ccd<span class="sc">$</span>vc <span class="ot">&lt;-</span> plan_ccd<span class="sc">$</span>x1<span class="sc">*</span><span class="dv">85</span> <span class="sc">+</span> <span class="dv">250</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>plan_ccd<span class="sc">$</span>f  <span class="ot">&lt;-</span> plan_ccd<span class="sc">$</span>x2<span class="sc">*</span><span class="fl">0.04</span> <span class="sc">+</span> <span class="fl">0.125</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>plan_ccd<span class="sc">$</span>fp <span class="ot">&lt;-</span> plan_ccd<span class="sc">$</span>x3<span class="sc">*</span><span class="dv">8</span> <span class="sc">+</span> <span class="dv">15</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>plan_ccd <span class="ot">&lt;-</span>  <span class="fu">data.frame</span>(plan_ccd)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">runif.faure</span>(<span class="dv">8</span>,<span class="dv">3</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>f<span class="sc">$</span>design[,<span class="dv">1</span>] <span class="ot">&lt;-</span> (f<span class="sc">$</span>design[,<span class="dv">1</span>] <span class="sc">-</span> <span class="fl">0.5</span>)<span class="sc">/</span><span class="fl">0.5</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>f<span class="sc">$</span>design[,<span class="dv">2</span>] <span class="ot">&lt;-</span> (f<span class="sc">$</span>design[,<span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.5</span>)<span class="sc">/</span><span class="fl">0.5</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>f<span class="sc">$</span>design[,<span class="dv">3</span>] <span class="ot">&lt;-</span> (f<span class="sc">$</span>design[,<span class="dv">3</span>] <span class="sc">-</span> <span class="fl">0.5</span>)<span class="sc">/</span><span class="fl">0.5</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>plan_faure <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">23</span><span class="sc">:</span><span class="dv">30</span>, <span class="dv">23</span><span class="sc">:</span><span class="dv">30</span>,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>                    f<span class="sc">$</span>design, <span class="fu">rep</span>(<span class="st">"3"</span>,<span class="dv">8</span>))</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>plan_faure <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(plan_faure)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>plan_faure<span class="sc">$</span>X1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(plan_faure<span class="sc">$</span>X1)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>plan_faure<span class="sc">$</span>X2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(plan_faure<span class="sc">$</span>X2)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>plan_faure<span class="sc">$</span>X3 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(plan_faure<span class="sc">$</span>X3)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>plan_faure<span class="sc">$</span>X4 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(plan_faure<span class="sc">$</span>X4)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>plan_faure<span class="sc">$</span>X5 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(plan_faure<span class="sc">$</span>X5)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>f<span class="sc">$</span>design[,<span class="dv">1</span>] <span class="ot">&lt;-</span> f<span class="sc">$</span>design[,<span class="dv">1</span>]<span class="sc">*</span><span class="dv">85</span> <span class="sc">+</span> <span class="dv">250</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>f<span class="sc">$</span>design[,<span class="dv">2</span>] <span class="ot">&lt;-</span> f<span class="sc">$</span>design[,<span class="dv">2</span>]<span class="sc">*</span><span class="fl">0.04</span> <span class="sc">+</span> <span class="fl">0.125</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>f<span class="sc">$</span>design[,<span class="dv">3</span>] <span class="ot">&lt;-</span> f<span class="sc">$</span>design[,<span class="dv">3</span>]<span class="sc">*</span><span class="dv">8</span> <span class="sc">+</span> <span class="dv">15</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>plan_faure <span class="ot">&lt;-</span> <span class="fu">cbind</span>(plan_faure, f<span class="sc">$</span>design)</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(plan_faure) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"run.order"</span>, <span class="st">"std.order"</span>, </span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>, <span class="st">"Block"</span>, <span class="st">"vc"</span>, <span class="st">"f"</span>, <span class="st">"fp"</span>)</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>plan <span class="ot">&lt;-</span> <span class="fu">rbind</span>(plan_ccd, plan_faure)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>plan<span class="sc">$</span>std.order <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>runorder <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">30</span>, <span class="dv">30</span>, <span class="at">replace =</span> F)</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>plan<span class="sc">$</span>run.order <span class="ot">&lt;-</span> runorder</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(plan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  run.order std.order x1 x2 x3 Block  vc     f fp
1        11         1 -1 -1 -1     1 165 0.085  7
2         9         2  1 -1 -1     1 335 0.085  7
3        10         3 -1  1 -1     1 165 0.165  7
4        16         4  1  1 -1     1 335 0.165  7
5        12         5 -1 -1  1     1 165 0.085 23
6        23         6  1 -1  1     1 335 0.085 23</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(plan, file = "plan.csv")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="responses-reading" class="level2">
<h2 class="anchored" data-anchor-id="responses-reading">Responses reading</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>respostas <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Respostas.csv"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>plan_respostas <span class="ot">&lt;-</span> <span class="fu">cbind</span>(plan,respostas)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(plan_respostas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  run.order std.order x1 x2 x3 Block  vc     f fp      Fc     Ra     Ront
1        11         1 -1 -1 -1     1 165 0.085  7 25.2195 1.8510 166.6557
2         9         2  1 -1 -1     1 335 0.085  7 34.8081 1.8666 123.9033
3        10         3 -1  1 -1     1 165 0.165  7 40.1323 4.0483 151.2919
4        16         4  1  1 -1     1 335 0.165  7 45.6892 4.9744 112.9433
5        12         5 -1 -1  1     1 165 0.085 23 29.2456 2.0304 139.2281
6        23         6  1 -1  1     1 335 0.085 23 29.5840 2.3512  56.7790</code></pre>
</div>
</div>
</section>
<section id="rsm-model-selection" class="level2">
<h2 class="anchored" data-anchor-id="rsm-model-selection">RSM model selection</h2>
<p>Function to calculate model performance metrics:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>metrics <span class="ot">&lt;-</span> <span class="cf">function</span>(pred, obs) {</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  RSE <span class="ot">&lt;-</span> <span class="fu">sum</span>((obs <span class="sc">-</span> pred)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  SST <span class="ot">&lt;-</span> <span class="fu">sum</span>((obs <span class="sc">-</span> <span class="fu">mean</span>(obs))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  R2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> RSE<span class="sc">/</span>SST </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  MSE <span class="ot">&lt;-</span>  <span class="fu">mean</span>((obs <span class="sc">-</span> pred)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  RMSE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((obs <span class="sc">-</span> pred)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  MAE <span class="ot">&lt;-</span>  <span class="fu">mean</span>(<span class="fu">abs</span>(obs <span class="sc">-</span> pred))</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(<span class="at">RMSE =</span> RMSE,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">MSE =</span> MSE,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">R2 =</span> R2, </span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">MAE =</span> MAE))</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>RSM model reduction through backward elimination for Ra:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>compRa <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ra <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x1<span class="sc">*</span>x2 <span class="sc">+</span> x1<span class="sc">*</span>x3 <span class="sc">+</span> x2<span class="sc">*</span>x3 <span class="sc">+</span> <span class="fu">I</span>(x1<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x2<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x3<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> plan_respostas)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(compRa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Ra ~ x1 + x2 + x3 + x1 * x2 + x1 * x3 + x2 * x3 + 
    I(x1^2) + I(x2^2) + I(x3^2), data = plan_respostas)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.57671 -0.16501 -0.01621  0.15869  0.75093 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.780728   0.093259  29.817  &lt; 2e-16 ***
x1           0.192097   0.082230   2.336    0.030 *  
x2           1.303793   0.082230  15.855 8.62e-13 ***
x3           0.008383   0.082230   0.102    0.920    
I(x1^2)      0.014186   0.079752   0.178    0.861    
I(x2^2)      0.408238   0.079752   5.119 5.23e-05 ***
I(x3^2)     -0.013947   0.079752  -0.175    0.863    
x1:x2        0.020133   0.112374   0.179    0.860    
x1:x3       -0.019334   0.112374  -0.172    0.865    
x2:x3       -0.129438   0.112374  -1.152    0.263    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3257 on 20 degrees of freedom
Multiple R-squared:  0.9338,    Adjusted R-squared:  0.904 
F-statistic: 31.35 on 9 and 20 DF,  p-value: 7.12e-10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>red_compRa <span class="ot">&lt;-</span> <span class="fu">step</span>(compRa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=-59.48
Ra ~ x1 + x2 + x3 + x1 * x2 + x1 * x3 + x2 * x3 + I(x1^2) + I(x2^2) + 
    I(x3^2)

          Df Sum of Sq    RSS     AIC
- x1:x3    1   0.00314 2.1243 -61.433
- I(x3^2)  1   0.00324 2.1244 -61.432
- I(x1^2)  1   0.00336 2.1245 -61.430
- x1:x2    1   0.00340 2.1245 -61.430
- x2:x3    1   0.14071 2.2618 -59.551
&lt;none&gt;                 2.1211 -59.478
- I(x2^2)  1   2.77896 4.9001 -36.358

Step:  AIC=-61.43
Ra ~ x1 + x2 + x3 + I(x1^2) + I(x2^2) + I(x3^2) + x1:x2 + x2:x3

          Df Sum of Sq    RSS     AIC
- I(x3^2)  1   0.00334 2.1276 -63.386
- x1:x2    1   0.00342 2.1277 -63.385
- I(x1^2)  1   0.00348 2.1277 -63.384
- x2:x3    1   0.14063 2.2649 -61.510
&lt;none&gt;                 2.1243 -61.433
- I(x2^2)  1   2.77599 4.9002 -38.357

Step:  AIC=-63.39
Ra ~ x1 + x2 + x3 + I(x1^2) + I(x2^2) + x1:x2 + x2:x3

          Df Sum of Sq    RSS     AIC
- x1:x2    1   0.00325 2.1308 -65.340
- I(x1^2)  1   0.00341 2.1310 -65.338
- x2:x3    1   0.13985 2.2674 -63.476
&lt;none&gt;                 2.1276 -63.386
- I(x2^2)  1   2.77422 4.9018 -40.348

Step:  AIC=-65.34
Ra ~ x1 + x2 + x3 + I(x1^2) + I(x2^2) + x2:x3

          Df Sum of Sq    RSS     AIC
- I(x1^2)  1   0.00351 2.1344 -67.291
- x2:x3    1   0.13995 2.2708 -65.432
&lt;none&gt;                 2.1308 -65.340
- x1       1   0.57878 2.7096 -60.132
- I(x2^2)  1   2.77162 4.9025 -42.344

Step:  AIC=-67.29
Ra ~ x1 + x2 + x3 + I(x2^2) + x2:x3

          Df Sum of Sq    RSS     AIC
- x2:x3    1   0.13892 2.2733 -67.399
&lt;none&gt;                 2.1344 -67.291
- x1       1   0.57878 2.7131 -62.093
- I(x2^2)  1   2.77385 4.9082 -44.309

Step:  AIC=-67.4
Ra ~ x1 + x2 + x3 + I(x2^2)

          Df Sum of Sq     RSS     AIC
- x3       1    0.0011  2.2744 -69.385
&lt;none&gt;                  2.2733 -67.399
- x1       1    0.5788  2.8521 -62.595
- I(x2^2)  1    2.7565  5.0297 -45.575
- x2       1   26.6618 28.9351   6.916

Step:  AIC=-69.38
Ra ~ x1 + x2 + I(x2^2)

          Df Sum of Sq     RSS     AIC
&lt;none&gt;                  2.2744 -69.385
- x1       1    0.5777  2.8521 -64.595
- I(x2^2)  1    2.7565  5.0308 -47.568
- x2       1   26.6893 28.9636   4.945</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(red_compRa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Ra ~ x1 + x2 + I(x2^2), data = plan_respostas)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.55365 -0.18472 -0.03535  0.18699  0.73494 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.78442    0.06600  42.187  &lt; 2e-16 ***
x1           0.19177    0.07462   2.570   0.0163 *  
x2           1.30347    0.07462  17.467 6.95e-16 ***
I(x2^2)      0.40629    0.07238   5.613 6.71e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2958 on 26 degrees of freedom
Multiple R-squared:  0.929, Adjusted R-squared:  0.9208 
F-statistic: 113.4 on 3 and 26 DF,  p-value: 4.699e-15</code></pre>
</div>
</div>
<p>RSM model comparison through k-fold for Ra:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>nr <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(plan_respostas)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>prop <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>nfolds <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">1</span><span class="sc">/</span>prop,<span class="dv">0</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>fr <span class="ot">&lt;-</span> <span class="fu">round</span>(prop<span class="sc">*</span><span class="fu">nrow</span>(plan_respostas))</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>res.teste_Ra <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fold =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">model =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">RMSE =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">Rsquared =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">MAE =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds))</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nfolds) {</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> <span class="fu">sample</span>(nr[<span class="sc">!</span><span class="fu">is.na</span>(nr)], fr, <span class="at">replace =</span> F)    </span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"fold"</span>, i),fold)                     </span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  nr[fold] <span class="ot">&lt;-</span> <span class="cn">NA</span>                                     </span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  plan.tr <span class="ot">&lt;-</span> plan_respostas[<span class="sc">-</span>fold,]</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>  lm_Ra1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ra <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x1<span class="sc">*</span>x2 <span class="sc">+</span> x1<span class="sc">*</span>x3 <span class="sc">+</span> x2<span class="sc">*</span>x3 <span class="sc">+</span> <span class="fu">I</span>(x1<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x2<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x3<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> plan.tr)</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>  lm_Ra2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ra <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> <span class="fu">I</span>(x2<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> plan.tr)</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"rsm_Ra1."</span>, i), lm_Ra1) </span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"rsm_Ra2."</span>, i), lm_Ra2) </span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>  res.teste.lm_Ra1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_Ra1, <span class="at">newdata =</span> plan_respostas[fold,])</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>  res.teste.lm_Ra2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_Ra2, <span class="at">newdata =</span> plan_respostas[fold,])</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>  testee.rsm1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Ra[fold], </span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>                            <span class="at">pred =</span> res.teste.lm_Ra1)</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>  testee.rsm2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Ra[fold], </span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>                            <span class="at">pred =</span> res.teste.lm_Ra2)</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>  res.teste.rsm1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">rsm.Ra =</span> <span class="fu">defaultSummary</span>(testee.rsm1))</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>  res.teste.rsm2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">rsm.Ra =</span> <span class="fu">defaultSummary</span>(testee.rsm2))</span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"res.teste.rsm1"</span>, i), <span class="fu">t</span>(res.teste.rsm1))</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"res.teste.rsm2"</span>, i), <span class="fu">t</span>(res.teste.rsm2))</span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>  j <span class="ot">&lt;-</span> (i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>  res.teste_Ra[j<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">1</span>),<span class="dv">1</span>] <span class="ot">&lt;-</span> i</span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>  res.teste_Ra[j<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">1</span>),<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"rsm1"</span>, <span class="st">"rsm2"</span>)</span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>  res.teste_Ra[j,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>]   <span class="ot">&lt;-</span> <span class="fu">t</span>(res.teste.rsm1)</span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>  res.teste_Ra[j<span class="sc">+</span><span class="dv">1</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">t</span>(res.teste.rsm2)</span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a>res.teste_Ra <span class="sc">%&gt;%</span></span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span></span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(RMSE, Rsquared, MAE), <span class="fu">list</span>(<span class="at">name =</span> mean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  model RMSE_name Rsquared_name MAE_name
  &lt;chr&gt;     &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;
1 rsm1      0.440         0.948    0.399
2 rsm2      0.287         0.953    0.259</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>res.teste_Ra <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(RMSE, Rsquared, MAE), <span class="fu">list</span>(<span class="at">name =</span> sd))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  model RMSE_name Rsquared_name MAE_name
  &lt;chr&gt;     &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;
1 rsm1      0.266        0.0683    0.260
2 rsm2      0.128        0.0690    0.123</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(RMSE <span class="sc">~</span> model, res.teste_Ra)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum exact test

data:  RMSE by model
W = 72, p-value = 0.1051
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(MAE <span class="sc">~</span> model, res.teste_Ra)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>res2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum exact test

data:  MAE by model
W = 70, p-value = 0.1431
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<p>RSM model reduction through backward elimination for Fc:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>compFc <span class="ot">&lt;-</span> <span class="fu">lm</span>(Fc <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x1<span class="sc">*</span>x2 <span class="sc">+</span> x1<span class="sc">*</span>x3 <span class="sc">+</span> x2<span class="sc">*</span>x3 <span class="sc">+</span> <span class="fu">I</span>(x1<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x2<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x3<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> plan_respostas)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(compFc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Fc ~ x1 + x2 + x3 + x1 * x2 + x1 * x3 + x2 * x3 + 
    I(x1^2) + I(x2^2) + I(x3^2), data = plan_respostas)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.0816 -1.4222 -0.0153  0.8182  7.1310 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  37.9235     0.8771  43.237  &lt; 2e-16 ***
x1            1.1475     0.7734   1.484    0.153    
x2            6.6081     0.7734   8.544 4.15e-08 ***
x3           -0.1505     0.7734  -0.195    0.848    
I(x1^2)      -0.5207     0.7501  -0.694    0.496    
I(x2^2)      -0.9104     0.7501  -1.214    0.239    
I(x3^2)      -1.0615     0.7501  -1.415    0.172    
x1:x2        -0.2820     1.0569  -0.267    0.792    
x1:x3        -1.5571     1.0569  -1.473    0.156    
x2:x3        -0.7298     1.0569  -0.691    0.498    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.063 on 20 degrees of freedom
Multiple R-squared:  0.803, Adjusted R-squared:  0.7144 
F-statistic: 9.061 on 9 and 20 DF,  p-value: 2.413e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>red_compFc <span class="ot">&lt;-</span> <span class="fu">step</span>(compFc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=75
Fc ~ x1 + x2 + x3 + x1 * x2 + x1 * x3 + x2 * x3 + I(x1^2) + I(x2^2) + 
    I(x3^2)

          Df Sum of Sq    RSS    AIC
- x1:x2    1    0.6678 188.29 73.104
- x2:x3    1    4.4734 192.10 73.705
- I(x1^2)  1    4.5208 192.15 73.712
&lt;none&gt;                 187.63 74.998
- I(x2^2)  1   13.8216 201.45 75.130
- I(x3^2)  1   18.7903 206.42 75.861
- x1:x3    1   20.3627 207.99 76.089

Step:  AIC=73.1
Fc ~ x1 + x2 + x3 + I(x1^2) + I(x2^2) + I(x3^2) + x1:x3 + x2:x3

          Df Sum of Sq    RSS    AIC
- x2:x3    1     4.467 192.76 71.808
- I(x1^2)  1     4.572 192.87 71.824
&lt;none&gt;                 188.29 73.104
- I(x2^2)  1    13.710 202.00 73.213
- I(x3^2)  1    18.985 207.28 73.986
- x1:x3    1    20.349 208.64 74.183

Step:  AIC=71.81
Fc ~ x1 + x2 + x3 + I(x1^2) + I(x2^2) + I(x3^2) + x1:x3

          Df Sum of Sq    RSS     AIC
- I(x1^2)  1      4.81 197.57  70.547
&lt;none&gt;                 192.76  71.808
- I(x2^2)  1     13.94 206.70  71.903
- I(x3^2)  1     18.64 211.40  72.577
- x1:x3    1     20.31 213.08  72.813
- x2       1    684.90 877.66 115.282

Step:  AIC=70.55
Fc ~ x1 + x2 + x3 + I(x2^2) + I(x3^2) + x1:x3

          Df Sum of Sq    RSS     AIC
&lt;none&gt;                 197.57  70.547
- I(x2^2)  1     14.12 211.69  70.618
- I(x3^2)  1     18.84 216.41  71.280
- x1:x3    1     19.94 217.51  71.432
- x2       1    684.90 882.47 113.446</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(red_compFc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Fc ~ x1 + x2 + x3 + I(x2^2) + I(x3^2) + x1:x3, data = plan_respostas)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.8342 -1.6398  0.1479  1.1333  7.3784 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  37.6761     0.7534  50.011  &lt; 2e-16 ***
x1            1.1475     0.7401   1.551    0.135    
x2            6.6081     0.7401   8.929 6.19e-09 ***
x3           -0.1505     0.7401  -0.203    0.841    
I(x2^2)      -0.9198     0.7175  -1.282    0.213    
I(x3^2)      -1.0623     0.7173  -1.481    0.152    
x1:x3        -1.5406     1.0111  -1.524    0.141    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.931 on 23 degrees of freedom
Multiple R-squared:  0.7926,    Adjusted R-squared:  0.7385 
F-statistic: 14.65 on 6 and 23 DF,  p-value: 7.684e-07</code></pre>
</div>
</div>
<p>RSM model comparison through k-fold for Fc:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>nr <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(plan_respostas)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>prop <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>nfolds <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">1</span><span class="sc">/</span>prop,<span class="dv">0</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>fr <span class="ot">&lt;-</span> <span class="fu">round</span>(prop<span class="sc">*</span><span class="fu">nrow</span>(plan_respostas))</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>res.teste_Fc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fold =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">model =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">RMSE =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">Rsquared =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">MAE =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds))</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nfolds) {</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> <span class="fu">sample</span>(nr[<span class="sc">!</span><span class="fu">is.na</span>(nr)], fr, <span class="at">replace =</span> F)    </span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"fold"</span>, i),fold)                     </span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>  nr[fold] <span class="ot">&lt;-</span> <span class="cn">NA</span>                                     </span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>  plan.tr <span class="ot">&lt;-</span> plan_respostas[<span class="sc">-</span>fold,]</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>  lm_Fc1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Fc <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x1<span class="sc">*</span>x2 <span class="sc">+</span> x1<span class="sc">*</span>x3 <span class="sc">+</span> x2<span class="sc">*</span>x3 <span class="sc">+</span> <span class="fu">I</span>(x1<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x2<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x3<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> plan.tr)</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>  lm_Fc2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Fc <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> <span class="fu">I</span>(x2<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> plan.tr)</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"rsm_Fc1."</span>, i), lm_Fc1) </span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"rsm_Fc2."</span>, i), lm_Fc2) </span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>  res.teste.lm_Fc1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_Fc1, <span class="at">newdata =</span> plan_respostas[fold,])</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>  res.teste.lm_Fc2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_Fc2, <span class="at">newdata =</span> plan_respostas[fold,])</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>  testee.rsm1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Fc[fold], </span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>                            <span class="at">pred =</span> res.teste.lm_Fc1)</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>  testee.rsm2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Fc[fold], </span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>                            <span class="at">pred =</span> res.teste.lm_Fc2)</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>  res.teste.rsm1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">rsm.Fc =</span> <span class="fu">defaultSummary</span>(testee.rsm1))</span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>  res.teste.rsm2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">rsm.Fc =</span> <span class="fu">defaultSummary</span>(testee.rsm2))</span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"res.teste.rsm1"</span>, i), <span class="fu">t</span>(res.teste.rsm1))</span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"res.teste.rsm2"</span>, i), <span class="fu">t</span>(res.teste.rsm2))</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a>  j <span class="ot">&lt;-</span> (i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span></span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a>  res.teste_Fc[j<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">1</span>),<span class="dv">1</span>] <span class="ot">&lt;-</span> i</span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a>  res.teste_Fc[j<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">1</span>),<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"rsm1"</span>, <span class="st">"rsm2"</span>)</span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a>  res.teste_Fc[j,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>]   <span class="ot">&lt;-</span> <span class="fu">t</span>(res.teste.rsm1)</span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a>  res.teste_Fc[j<span class="sc">+</span><span class="dv">1</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">t</span>(res.teste.rsm2)</span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a>res.teste_Fc <span class="sc">%&gt;%</span></span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span></span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(RMSE, Rsquared, MAE), <span class="fu">list</span>(<span class="at">name =</span> mean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  model RMSE_name Rsquared_name MAE_name
  &lt;chr&gt;     &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;
1 rsm1       3.07         0.761     2.40
2 rsm2       2.95         0.705     2.53</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>res.teste_Fc <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(RMSE, Rsquared, MAE), <span class="fu">list</span>(<span class="at">name =</span> sd))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  model RMSE_name Rsquared_name MAE_name
  &lt;chr&gt;     &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;
1 rsm1       1.55         0.302    1.24 
2 rsm2       1.11         0.353    0.919</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(RMSE <span class="sc">~</span> model, res.teste_Fc)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum exact test

data:  RMSE by model
W = 55, p-value = 0.7394
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(MAE <span class="sc">~</span> model, res.teste_Fc)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>res2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum exact test

data:  MAE by model
W = 43, p-value = 0.6305
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<p>RSM model reduction through backward elimination for Ront:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>compRont <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ront <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x1<span class="sc">*</span>x2 <span class="sc">+</span> x1<span class="sc">*</span>x3 <span class="sc">+</span> x2<span class="sc">*</span>x3 <span class="sc">+</span> <span class="fu">I</span>(x1<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x2<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x3<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> plan_respostas)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(compRont)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Ront ~ x1 + x2 + x3 + x1 * x2 + x1 * x3 + x2 * x3 + 
    I(x1^2) + I(x2^2) + I(x3^2), data = plan_respostas)

Residuals:
    Min      1Q  Median      3Q     Max 
-56.912 -18.351   0.821  17.193  48.905 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 128.4473     9.5242  13.486 1.68e-11 ***
x1          -14.5739     8.3980  -1.735   0.0981 .  
x2           10.5112     8.3980   1.252   0.2251    
x3           -0.1647     8.3980  -0.020   0.9846    
I(x1^2)      -8.4242     8.1448  -1.034   0.3133    
I(x2^2)       4.1097     8.1448   0.505   0.6194    
I(x3^2)       6.8016     8.1448   0.835   0.4135    
x1:x2        13.4947    11.4764   1.176   0.2535    
x1:x3         5.8699    11.4764   0.511   0.6146    
x2:x3        15.9508    11.4764   1.390   0.1798    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 33.26 on 20 degrees of freedom
Multiple R-squared:  0.3392,    Adjusted R-squared:  0.04191 
F-statistic: 1.141 on 9 and 20 DF,  p-value: 0.3812</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>red_compRont <span class="ot">&lt;-</span> <span class="fu">step</span>(compRont)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=218.1
Ront ~ x1 + x2 + x3 + x1 * x2 + x1 * x3 + x2 * x3 + I(x1^2) + 
    I(x2^2) + I(x3^2)

          Df Sum of Sq   RSS    AIC
- I(x2^2)  1    281.63 22405 216.47
- x1:x3    1    289.38 22413 216.49
- I(x3^2)  1    771.39 22895 217.12
- I(x1^2)  1   1183.34 23307 217.66
&lt;none&gt;                 22123 218.10
- x1:x2    1   1529.44 23653 218.10
- x2:x3    1   2136.82 24260 218.86

Step:  AIC=216.48
Ront ~ x1 + x2 + x3 + I(x1^2) + I(x3^2) + x1:x2 + x1:x3 + x2:x3

          Df Sum of Sq   RSS    AIC
- x1:x3    1    304.41 22709 214.88
- I(x3^2)  1    781.37 23186 215.50
- I(x1^2)  1   1171.28 23576 216.00
- x1:x2    1   1504.92 23910 216.43
&lt;none&gt;                 22405 216.47
- x2:x3    1   2159.73 24565 217.24

Step:  AIC=214.88
Ront ~ x1 + x2 + x3 + I(x1^2) + I(x3^2) + x1:x2 + x2:x3

          Df Sum of Sq   RSS    AIC
- I(x3^2)  1    795.96 23505 213.91
- I(x1^2)  1   1194.41 23904 214.42
- x1:x2    1   1501.72 24211 214.80
&lt;none&gt;                 22709 214.88
- x2:x3    1   2157.30 24867 215.60

Step:  AIC=213.91
Ront ~ x1 + x2 + x3 + I(x1^2) + x1:x2 + x2:x3

          Df Sum of Sq   RSS    AIC
- I(x1^2)  1    1174.3 24680 213.38
- x1:x2    1    1558.8 25064 213.84
&lt;none&gt;                 23505 213.91
- x2:x3    1    2108.4 25614 214.49

Step:  AIC=213.38
Ront ~ x1 + x2 + x3 + x1:x2 + x2:x3

        Df Sum of Sq   RSS    AIC
- x1:x2  1    1520.0 26200 213.17
&lt;none&gt;               24680 213.38
- x2:x3  1    2029.8 26709 213.75

Step:  AIC=213.17
Ront ~ x1 + x2 + x3 + x2:x3

        Df Sum of Sq   RSS    AIC
&lt;none&gt;               26200 213.17
- x2:x3  1    2021.9 28222 213.40
- x1     1    3331.4 29531 214.76</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(red_compRont)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Ront ~ x1 + x2 + x3 + x2:x3, data = plan_respostas)

Residuals:
   Min     1Q Median     3Q    Max 
-62.17 -20.04   1.86  17.17  52.75 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 129.3602     5.9145  21.872   &lt;2e-16 ***
x1          -14.5739     8.1741  -1.783   0.0867 .  
x2           10.5112     8.1741   1.286   0.2103    
x3           -0.1647     8.1741  -0.020   0.9841    
x2:x3        15.5063    11.1636   1.389   0.1771    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 32.37 on 25 degrees of freedom
Multiple R-squared:  0.2175,    Adjusted R-squared:  0.0923 
F-statistic: 1.737 on 4 and 25 DF,  p-value: 0.1734</code></pre>
</div>
</div>
<p>RSM model comparison through k-fold for Ront:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>nr <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(plan_respostas)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>prop <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>nfolds <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">1</span><span class="sc">/</span>prop,<span class="dv">0</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>fr <span class="ot">&lt;-</span> <span class="fu">round</span>(prop<span class="sc">*</span><span class="fu">nrow</span>(plan_respostas))</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>res.teste_Ront <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fold =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">model =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">RMSE =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">Rsquared =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">MAE =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds))</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nfolds) {</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> <span class="fu">sample</span>(nr[<span class="sc">!</span><span class="fu">is.na</span>(nr)], fr, <span class="at">replace =</span> F)    </span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"fold"</span>, i),fold)                     </span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>  nr[fold] <span class="ot">&lt;-</span> <span class="cn">NA</span>                                     </span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>  plan.tr <span class="ot">&lt;-</span> plan_respostas[<span class="sc">-</span>fold,]</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>  lm_Ront1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ront <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x1<span class="sc">*</span>x2 <span class="sc">+</span> x1<span class="sc">*</span>x3 <span class="sc">+</span> x2<span class="sc">*</span>x3 <span class="sc">+</span> <span class="fu">I</span>(x1<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x2<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x3<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> plan.tr)</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>  lm_Ront2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ront <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> <span class="fu">I</span>(x2<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> plan.tr)</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"rsm_Ront1."</span>, i), lm_Ront1) </span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"rsm_Ront2."</span>, i), lm_Ront2) </span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>  res.teste.lm_Ront1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_Ront1, <span class="at">newdata =</span> plan_respostas[fold,])</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>  res.teste.lm_Ront2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_Ront2, <span class="at">newdata =</span> plan_respostas[fold,])</span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>  testee.rsm1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Ront[fold], </span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>                            <span class="at">pred =</span> res.teste.lm_Ront1)</span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>  testee.rsm2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Ront[fold], </span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>                            <span class="at">pred =</span> res.teste.lm_Ront2)</span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>  res.teste.rsm1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">rsm.Ront =</span> <span class="fu">defaultSummary</span>(testee.rsm1))</span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>  res.teste.rsm2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">rsm.Ront =</span> <span class="fu">defaultSummary</span>(testee.rsm2))</span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"res.teste.rsm1"</span>, i), <span class="fu">t</span>(res.teste.rsm1))</span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"res.teste.rsm2"</span>, i), <span class="fu">t</span>(res.teste.rsm2))</span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a>  j <span class="ot">&lt;-</span> (i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span></span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-52"><a href="#cb42-52" aria-hidden="true" tabindex="-1"></a>  res.teste_Ront[j<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">1</span>),<span class="dv">1</span>] <span class="ot">&lt;-</span> i</span>
<span id="cb42-53"><a href="#cb42-53" aria-hidden="true" tabindex="-1"></a>  res.teste_Ront[j<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">1</span>),<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"rsm1"</span>, <span class="st">"rsm2"</span>)</span>
<span id="cb42-54"><a href="#cb42-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-55"><a href="#cb42-55" aria-hidden="true" tabindex="-1"></a>  res.teste_Ront[j,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>]   <span class="ot">&lt;-</span> <span class="fu">t</span>(res.teste.rsm1)</span>
<span id="cb42-56"><a href="#cb42-56" aria-hidden="true" tabindex="-1"></a>  res.teste_Ront[j<span class="sc">+</span><span class="dv">1</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">t</span>(res.teste.rsm2)</span>
<span id="cb42-57"><a href="#cb42-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-58"><a href="#cb42-58" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-59"><a href="#cb42-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-60"><a href="#cb42-60" aria-hidden="true" tabindex="-1"></a>res.teste_Ront <span class="sc">%&gt;%</span></span>
<span id="cb42-61"><a href="#cb42-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span></span>
<span id="cb42-62"><a href="#cb42-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(RMSE, Rsquared, MAE), <span class="fu">list</span>(<span class="at">name =</span> mean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  model RMSE_name Rsquared_name MAE_name
  &lt;chr&gt;     &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;
1 rsm1       36.1         0.527     31.6
2 rsm2       30.9         0.512     28.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>res.teste_Ront <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(RMSE, Rsquared, MAE), <span class="fu">list</span>(<span class="at">name =</span> sd))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  model RMSE_name Rsquared_name MAE_name
  &lt;chr&gt;     &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;
1 rsm1       12.4         0.240     11.5
2 rsm2       15.6         0.322     15.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(RMSE <span class="sc">~</span> model, res.teste_Ront)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum exact test

data:  RMSE by model
W = 60, p-value = 0.4813
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(MAE <span class="sc">~</span> model, res.teste_Ront)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>res2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum exact test

data:  MAE by model
W = 59, p-value = 0.5288
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
</section>
<section id="gam-model-selection" class="level2">
<h2 class="anchored" data-anchor-id="gam-model-selection">GAM model selection</h2>
<p>GAM model reduction through backward elimination for Ra:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>comp1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ra <span class="sc">~</span> <span class="fu">ns</span>(x1,<span class="dv">3</span>) <span class="sc">+</span> <span class="fu">ns</span>(x2,<span class="dv">3</span>) <span class="sc">+</span> <span class="fu">ns</span>(x3,<span class="dv">3</span>),</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> plan_respostas)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(comp1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Ra ~ ns(x1, 3) + ns(x2, 3) + ns(x3, 3), data = plan_respostas)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.53275 -0.18663  0.02677  0.20672  0.57518 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.29018    0.44682   2.887 0.009105 ** 
ns(x1, 3)1   0.20903    0.27310   0.765 0.452962    
ns(x1, 3)2   1.03094    0.63320   1.628 0.119146    
ns(x1, 3)3   0.63206    0.29198   2.165 0.042676 *  
ns(x2, 3)1   1.81975    0.27310   6.663 1.74e-06 ***
ns(x2, 3)2   2.95561    0.63320   4.668 0.000148 ***
ns(x2, 3)3   4.08276    0.29198  13.983 8.72e-12 ***
ns(x3, 3)1   0.01231    0.27310   0.045 0.964492    
ns(x3, 3)2   0.29188    0.63320   0.461 0.649797    
ns(x3, 3)3   0.04800    0.29198   0.164 0.871076    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3159 on 20 degrees of freedom
Multiple R-squared:  0.9377,    Adjusted R-squared:  0.9097 
F-statistic: 33.44 on 9 and 20 DF,  p-value: 3.933e-10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>red_comp1 <span class="ot">&lt;-</span> <span class="fu">step</span>(comp1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=-61.3
Ra ~ ns(x1, 3) + ns(x2, 3) + ns(x3, 3)

            Df Sum of Sq     RSS     AIC
- ns(x3, 3)  3    0.0243  2.0205 -66.935
&lt;none&gt;                    1.9963 -61.298
- ns(x1, 3)  3    0.6009  2.5972 -59.403
- ns(x2, 3)  3   29.2660 31.2623  15.236

Step:  AIC=-66.94
Ra ~ ns(x1, 3) + ns(x2, 3)

            Df Sum of Sq     RSS     AIC
&lt;none&gt;                    2.0205 -66.935
- ns(x1, 3)  3     0.613  2.6335 -64.986
- ns(x2, 3)  3    29.277 31.2974   9.270</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(red_comp1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Ra ~ ns(x1, 3) + ns(x2, 3), data = plan_respostas)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.54310 -0.19935  0.03477  0.22069  0.58573 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   1.4076     0.3498   4.023 0.000531 ***
ns(x1, 3)1    0.2155     0.2556   0.843 0.407987    
ns(x1, 3)2    1.0419     0.5933   1.756 0.092373 .  
ns(x1, 3)3    0.6323     0.2732   2.314 0.029960 *  
ns(x2, 3)1    1.8197     0.2551   7.132 2.90e-07 ***
ns(x2, 3)2    2.9669     0.5930   5.003 4.63e-05 ***
ns(x2, 3)3    4.0801     0.2738  14.902 2.62e-13 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2964 on 23 degrees of freedom
Multiple R-squared:  0.9369,    Adjusted R-squared:  0.9205 
F-statistic: 56.95 on 6 and 23 DF,  p-value: 1.179e-12</code></pre>
</div>
</div>
<p>GAM model comparison through k-fold for Ra:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>nr <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(plan_respostas)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>prop <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>nfolds <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">1</span><span class="sc">/</span>prop,<span class="dv">0</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>fr <span class="ot">&lt;-</span> <span class="fu">round</span>(prop<span class="sc">*</span><span class="fu">nrow</span>(plan_respostas))</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>res.teste_Ra <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fold =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">model =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">RMSE =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">Rsquared =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">MAE =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds))</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nfolds) {</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> <span class="fu">sample</span>(nr[<span class="sc">!</span><span class="fu">is.na</span>(nr)], fr, <span class="at">replace =</span> F)    </span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"fold"</span>, i),fold)                     </span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>  nr[fold] <span class="ot">&lt;-</span> <span class="cn">NA</span>                                     </span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>  plan.tr <span class="ot">&lt;-</span> plan_respostas[<span class="sc">-</span>fold,]</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>  gam_Ra1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ra <span class="sc">~</span> <span class="fu">ns</span>(x1,<span class="dv">3</span>) <span class="sc">+</span> <span class="fu">ns</span>(x2,<span class="dv">3</span>) <span class="sc">+</span> <span class="fu">ns</span>(x3,<span class="dv">3</span>), plan.tr)</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(gam_Ra1)</span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>  gam_Ra2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ra <span class="sc">~</span>  <span class="fu">ns</span>(x1, <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">ns</span>(x2, <span class="dv">3</span>), plan.tr)</span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(gam_Ra2)</span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"gam_Ra1."</span>, i), gam_Ra1) </span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"gam_Ra2."</span>, i), gam_Ra2) </span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a>  res.teste.lm_Ra1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(gam_Ra1, <span class="at">newdata =</span> plan_respostas[fold,])</span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a>  res.teste.lm_Ra2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(gam_Ra2, <span class="at">newdata =</span> plan_respostas[fold,])</span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-37"><a href="#cb56-37" aria-hidden="true" tabindex="-1"></a>  testee.gam1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Ra[fold], </span>
<span id="cb56-38"><a href="#cb56-38" aria-hidden="true" tabindex="-1"></a>                            <span class="at">pred =</span> res.teste.lm_Ra1)</span>
<span id="cb56-39"><a href="#cb56-39" aria-hidden="true" tabindex="-1"></a>  testee.gam2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Ra[fold], </span>
<span id="cb56-40"><a href="#cb56-40" aria-hidden="true" tabindex="-1"></a>                            <span class="at">pred =</span> res.teste.lm_Ra2)</span>
<span id="cb56-41"><a href="#cb56-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-42"><a href="#cb56-42" aria-hidden="true" tabindex="-1"></a>  res.teste.gam1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb56-43"><a href="#cb56-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">gam.Ra =</span> <span class="fu">defaultSummary</span>(testee.gam1))</span>
<span id="cb56-44"><a href="#cb56-44" aria-hidden="true" tabindex="-1"></a>  res.teste.gam2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb56-45"><a href="#cb56-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">gam.Ra =</span> <span class="fu">defaultSummary</span>(testee.gam2))</span>
<span id="cb56-46"><a href="#cb56-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-47"><a href="#cb56-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"res.teste.gam1"</span>, i), <span class="fu">t</span>(res.teste.gam1))</span>
<span id="cb56-48"><a href="#cb56-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"res.teste.gam2"</span>, i), <span class="fu">t</span>(res.teste.gam2))</span>
<span id="cb56-49"><a href="#cb56-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-50"><a href="#cb56-50" aria-hidden="true" tabindex="-1"></a>  j <span class="ot">&lt;-</span> (i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span></span>
<span id="cb56-51"><a href="#cb56-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-52"><a href="#cb56-52" aria-hidden="true" tabindex="-1"></a>  res.teste_Ra[j<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">1</span>),<span class="dv">1</span>] <span class="ot">&lt;-</span> i</span>
<span id="cb56-53"><a href="#cb56-53" aria-hidden="true" tabindex="-1"></a>  res.teste_Ra[j<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">1</span>),<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"gam1"</span>, <span class="st">"gam2"</span>)</span>
<span id="cb56-54"><a href="#cb56-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-55"><a href="#cb56-55" aria-hidden="true" tabindex="-1"></a>  res.teste_Ra[j,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>]   <span class="ot">&lt;-</span> <span class="fu">t</span>(res.teste.gam1)</span>
<span id="cb56-56"><a href="#cb56-56" aria-hidden="true" tabindex="-1"></a>  res.teste_Ra[j<span class="sc">+</span><span class="dv">1</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">t</span>(res.teste.gam2)</span>
<span id="cb56-57"><a href="#cb56-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-58"><a href="#cb56-58" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-59"><a href="#cb56-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-60"><a href="#cb56-60" aria-hidden="true" tabindex="-1"></a>res.teste_Ra <span class="sc">%&gt;%</span></span>
<span id="cb56-61"><a href="#cb56-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span></span>
<span id="cb56-62"><a href="#cb56-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(RMSE, Rsquared, MAE), <span class="fu">list</span>(<span class="at">name =</span> mean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  model RMSE_name Rsquared_name MAE_name
  &lt;chr&gt;     &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;
1 gam1      0.408         0.931    0.359
2 gam2      0.377         0.919    0.333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>res.teste_Ra <span class="sc">%&gt;%</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(RMSE, Rsquared, MAE), <span class="fu">list</span>(<span class="at">name =</span> sd))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  model RMSE_name Rsquared_name MAE_name
  &lt;chr&gt;     &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;
1 gam1      0.238        0.0972    0.204
2 gam2      0.240        0.116     0.205</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(RMSE <span class="sc">~</span> model, res.teste_Ra)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum exact test

data:  RMSE by model
W = 60, p-value = 0.4813
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(MAE <span class="sc">~</span> model, res.teste_Ra)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>res2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum exact test

data:  MAE by model
W = 62, p-value = 0.393
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<p>GAM model reduction through backward elimination for Fc:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>comp1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Fc <span class="sc">~</span> <span class="fu">ns</span>(x1,<span class="dv">3</span>) <span class="sc">+</span> <span class="fu">ns</span>(x2,<span class="dv">3</span>) <span class="sc">+</span> <span class="fu">ns</span>(x3,<span class="dv">3</span>),</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> plan_respostas)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(comp1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Fc ~ ns(x1, 3) + ns(x2, 3) + ns(x3, 3), data = plan_respostas)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.1916 -1.9075 -0.2387  1.2635  7.0210 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 20.58819    4.54583   4.529 0.000204 ***
ns(x1, 3)1   3.31300    2.77842   1.192 0.247058    
ns(x1, 3)2   5.10524    6.44195   0.793 0.437369    
ns(x1, 3)3   2.41234    2.97047   0.812 0.426291    
ns(x2, 3)1  13.27012    2.77842   4.776 0.000115 ***
ns(x2, 3)2  27.71851    6.44195   4.303 0.000347 ***
ns(x2, 3)3  17.42074    2.97047   5.865 9.76e-06 ***
ns(x3, 3)1   2.70230    2.77842   0.973 0.342368    
ns(x3, 3)2   0.04413    6.44195   0.007 0.994602    
ns(x3, 3)3  -2.72611    2.97047  -0.918 0.369693    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.214 on 20 degrees of freedom
Multiple R-squared:  0.7831,    Adjusted R-squared:  0.6855 
F-statistic: 8.024 on 9 and 20 DF,  p-value: 5.856e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>red_comp1 <span class="ot">&lt;-</span> <span class="fu">step</span>(comp1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=77.89
Fc ~ ns(x1, 3) + ns(x2, 3) + ns(x3, 3)

            Df Sum of Sq    RSS     AIC
- ns(x3, 3)  3     22.19 228.81  74.951
- ns(x1, 3)  3     26.62 233.24  75.526
&lt;none&gt;                   206.62  77.891
- ns(x2, 3)  3    697.44 904.06 116.171

Step:  AIC=74.95
Fc ~ ns(x1, 3) + ns(x2, 3)

            Df Sum of Sq    RSS     AIC
- ns(x1, 3)  3     26.50 255.31  72.238
&lt;none&gt;                   228.81  74.951
- ns(x2, 3)  3    702.26 931.08 111.054

Step:  AIC=72.24
Fc ~ ns(x2, 3)

            Df Sum of Sq    RSS     AIC
&lt;none&gt;                   255.31  72.238
- ns(x2, 3)  3    697.35 952.65 105.742</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(red_comp1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Fc ~ ns(x2, 3), data = plan_respostas)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.4130 -2.0800 -0.0482  1.1191  7.7996 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   23.812      2.694   8.839 2.59e-09 ***
ns(x2, 3)1    13.365      2.691   4.966 3.68e-05 ***
ns(x2, 3)2    27.946      6.261   4.464 0.000138 ***
ns(x2, 3)3    17.103      2.887   5.924 3.00e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.134 on 26 degrees of freedom
Multiple R-squared:  0.732, Adjusted R-squared:  0.7011 
F-statistic: 23.67 on 3 and 26 DF,  p-value: 1.334e-07</code></pre>
</div>
</div>
<p>GAM model comparison through k-fold for Fc:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>nr <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(plan_respostas)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>prop <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>nfolds <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">1</span><span class="sc">/</span>prop,<span class="dv">0</span>)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>fr <span class="ot">&lt;-</span> <span class="fu">round</span>(prop<span class="sc">*</span><span class="fu">nrow</span>(plan_respostas))</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>res.teste_Fc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fold =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">model =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">RMSE =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">Rsquared =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">MAE =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds))</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nfolds) {</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> <span class="fu">sample</span>(nr[<span class="sc">!</span><span class="fu">is.na</span>(nr)], fr, <span class="at">replace =</span> F)    </span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"fold"</span>, i),fold)                     </span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>  nr[fold] <span class="ot">&lt;-</span> <span class="cn">NA</span>                                     </span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>  plan.tr <span class="ot">&lt;-</span> plan_respostas[<span class="sc">-</span>fold,]</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>  gam_Fc1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Fc <span class="sc">~</span> <span class="fu">ns</span>(x1,<span class="dv">3</span>) <span class="sc">+</span> <span class="fu">ns</span>(x2,<span class="dv">3</span>) <span class="sc">+</span> <span class="fu">ns</span>(x3,<span class="dv">3</span>), plan.tr)</span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(gam_Fc1)</span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a>  gam_Fc2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Fc <span class="sc">~</span>  <span class="fu">ns</span>(x1, <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">ns</span>(x2, <span class="dv">3</span>), plan.tr)</span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(gam_Fc2)</span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"gam_Fc1."</span>, i), gam_Fc1) </span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"gam_Fc2."</span>, i), gam_Fc2) </span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-34"><a href="#cb70-34" aria-hidden="true" tabindex="-1"></a>  res.teste.lm_Fc1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(gam_Fc1, <span class="at">newdata =</span> plan_respostas[fold,])</span>
<span id="cb70-35"><a href="#cb70-35" aria-hidden="true" tabindex="-1"></a>  res.teste.lm_Fc2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(gam_Fc2, <span class="at">newdata =</span> plan_respostas[fold,])</span>
<span id="cb70-36"><a href="#cb70-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-37"><a href="#cb70-37" aria-hidden="true" tabindex="-1"></a>  testee.gam1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Fc[fold], </span>
<span id="cb70-38"><a href="#cb70-38" aria-hidden="true" tabindex="-1"></a>                            <span class="at">pred =</span> res.teste.lm_Fc1)</span>
<span id="cb70-39"><a href="#cb70-39" aria-hidden="true" tabindex="-1"></a>  testee.gam2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Fc[fold], </span>
<span id="cb70-40"><a href="#cb70-40" aria-hidden="true" tabindex="-1"></a>                            <span class="at">pred =</span> res.teste.lm_Fc2)</span>
<span id="cb70-41"><a href="#cb70-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-42"><a href="#cb70-42" aria-hidden="true" tabindex="-1"></a>  res.teste.gam1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb70-43"><a href="#cb70-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">gam.Fc =</span> <span class="fu">defaultSummary</span>(testee.gam1))</span>
<span id="cb70-44"><a href="#cb70-44" aria-hidden="true" tabindex="-1"></a>  res.teste.gam2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb70-45"><a href="#cb70-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">gam.Fc =</span> <span class="fu">defaultSummary</span>(testee.gam2))</span>
<span id="cb70-46"><a href="#cb70-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-47"><a href="#cb70-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"res.teste.gam1"</span>, i), <span class="fu">t</span>(res.teste.gam1))</span>
<span id="cb70-48"><a href="#cb70-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"res.teste.gam2"</span>, i), <span class="fu">t</span>(res.teste.gam2))</span>
<span id="cb70-49"><a href="#cb70-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-50"><a href="#cb70-50" aria-hidden="true" tabindex="-1"></a>  j <span class="ot">&lt;-</span> (i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span></span>
<span id="cb70-51"><a href="#cb70-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-52"><a href="#cb70-52" aria-hidden="true" tabindex="-1"></a>  res.teste_Fc[j<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">1</span>),<span class="dv">1</span>] <span class="ot">&lt;-</span> i</span>
<span id="cb70-53"><a href="#cb70-53" aria-hidden="true" tabindex="-1"></a>  res.teste_Fc[j<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">1</span>),<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"gam1"</span>, <span class="st">"gam2"</span>)</span>
<span id="cb70-54"><a href="#cb70-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-55"><a href="#cb70-55" aria-hidden="true" tabindex="-1"></a>  res.teste_Fc[j,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>]   <span class="ot">&lt;-</span> <span class="fu">t</span>(res.teste.gam1)</span>
<span id="cb70-56"><a href="#cb70-56" aria-hidden="true" tabindex="-1"></a>  res.teste_Fc[j<span class="sc">+</span><span class="dv">1</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">t</span>(res.teste.gam2)</span>
<span id="cb70-57"><a href="#cb70-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-58"><a href="#cb70-58" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-59"><a href="#cb70-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-60"><a href="#cb70-60" aria-hidden="true" tabindex="-1"></a>res.teste_Fc <span class="sc">%&gt;%</span></span>
<span id="cb70-61"><a href="#cb70-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span></span>
<span id="cb70-62"><a href="#cb70-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(RMSE, Rsquared, MAE), <span class="fu">list</span>(<span class="at">name =</span> mean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  model RMSE_name Rsquared_name MAE_name
  &lt;chr&gt;     &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;
1 gam1       3.39         0.688     2.88
2 gam2       3.16         0.691     2.79</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>res.teste_Fc <span class="sc">%&gt;%</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(RMSE, Rsquared, MAE), <span class="fu">list</span>(<span class="at">name =</span> sd))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  model RMSE_name Rsquared_name MAE_name
  &lt;chr&gt;     &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;
1 gam1       1.23         0.303    1.09 
2 gam2       1.03         0.357    0.950</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(RMSE <span class="sc">~</span> model, res.teste_Fc)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum exact test

data:  RMSE by model
W = 56, p-value = 0.6842
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(MAE <span class="sc">~</span> model, res.teste_Fc)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>res2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum exact test

data:  MAE by model
W = 53, p-value = 0.8534
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<p>GAM model reduction through backward elimination for Ront:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>comp1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ront <span class="sc">~</span> <span class="fu">ns</span>(x1,<span class="dv">3</span>) <span class="sc">+</span> <span class="fu">ns</span>(x2,<span class="dv">3</span>) <span class="sc">+</span> <span class="fu">ns</span>(x3,<span class="dv">3</span>),</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> plan_respostas)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(comp1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Ront ~ ns(x1, 3) + ns(x2, 3) + ns(x3, 3), data = plan_respostas)

Residuals:
    Min      1Q  Median      3Q     Max 
-65.123 -10.560   1.104  21.649  47.933 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)  154.605     49.888   3.099  0.00566 **
ns(x1, 3)1    -7.747     30.491  -0.254  0.80203   
ns(x1, 3)2   -20.964     70.696  -0.297  0.76988   
ns(x1, 3)3   -53.188     32.599  -1.632  0.11842   
ns(x2, 3)1    13.345     30.491   0.438  0.66631   
ns(x2, 3)2    24.398     70.696   0.345  0.73362   
ns(x2, 3)3    34.332     32.599   1.053  0.30483   
ns(x3, 3)1     9.693     30.491   0.318  0.75386   
ns(x3, 3)2   -72.187     70.696  -1.021  0.31941   
ns(x3, 3)3    -7.048     32.599  -0.216  0.83102   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 35.27 on 20 degrees of freedom
Multiple R-squared:  0.2568,    Adjusted R-squared:  -0.07768 
F-statistic: 0.7677 on 9 and 20 DF,  p-value: 0.6468</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>red_comp1 <span class="ot">&lt;-</span> <span class="fu">step</span>(comp1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=221.62
Ront ~ ns(x1, 3) + ns(x2, 3) + ns(x3, 3)

            Df Sum of Sq   RSS    AIC
- ns(x3, 3)  3    1716.1 26601 217.62
- ns(x2, 3)  3    1978.5 26863 217.92
- ns(x1, 3)  3    4576.3 29461 220.69
&lt;none&gt;                   24885 221.62

Step:  AIC=217.63
Ront ~ ns(x1, 3) + ns(x2, 3)

            Df Sum of Sq   RSS    AIC
- ns(x2, 3)  3    2055.9 28657 213.86
- ns(x1, 3)  3    4740.7 31342 216.54
&lt;none&gt;                   26601 217.62

Step:  AIC=213.86
Ront ~ ns(x1, 3)

            Df Sum of Sq   RSS    AIC
- ns(x1, 3)  3    4825.1 33482 212.53
&lt;none&gt;                   28657 213.86

Step:  AIC=212.53
Ront ~ 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(red_comp1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Ront ~ 1, data = plan_respostas)

Residuals:
    Min      1Q  Median      3Q     Max 
-74.227 -16.076   0.214  26.518  47.388 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  129.054      6.204    20.8   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 33.98 on 29 degrees of freedom</code></pre>
</div>
</div>
<p>GAM model comparison through k-fold for Ront:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>nr <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(plan_respostas)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>prop <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>nfolds <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">1</span><span class="sc">/</span>prop,<span class="dv">0</span>)</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>fr <span class="ot">&lt;-</span> <span class="fu">round</span>(prop<span class="sc">*</span><span class="fu">nrow</span>(plan_respostas))</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>res.teste_Ront <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fold =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">model =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">RMSE =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">Rsquared =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">MAE =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds))</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nfolds) {</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> <span class="fu">sample</span>(nr[<span class="sc">!</span><span class="fu">is.na</span>(nr)], fr, <span class="at">replace =</span> F)    </span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"fold"</span>, i),fold)                     </span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>  nr[fold] <span class="ot">&lt;-</span> <span class="cn">NA</span>                                     </span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>  plan.tr <span class="ot">&lt;-</span> plan_respostas[<span class="sc">-</span>fold,]</span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a>  gam_Ront1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ront <span class="sc">~</span> <span class="fu">ns</span>(x1,<span class="dv">3</span>) <span class="sc">+</span> <span class="fu">ns</span>(x2,<span class="dv">3</span>) <span class="sc">+</span> <span class="fu">ns</span>(x3,<span class="dv">3</span>), plan.tr)</span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(gam_Ront1)</span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a>  gam_Ront2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ront <span class="sc">~</span>  <span class="fu">ns</span>(x1, <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">ns</span>(x2, <span class="dv">3</span>), plan.tr)</span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(gam_Ront2)</span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"gam_Ront1."</span>, i), gam_Ront1) </span>
<span id="cb84-32"><a href="#cb84-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"gam_Ront2."</span>, i), gam_Ront2) </span>
<span id="cb84-33"><a href="#cb84-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-34"><a href="#cb84-34" aria-hidden="true" tabindex="-1"></a>  res.teste.lm_Ront1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(gam_Ront1, <span class="at">newdata =</span> plan_respostas[fold,])</span>
<span id="cb84-35"><a href="#cb84-35" aria-hidden="true" tabindex="-1"></a>  res.teste.lm_Ront2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(gam_Ront2, <span class="at">newdata =</span> plan_respostas[fold,])</span>
<span id="cb84-36"><a href="#cb84-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-37"><a href="#cb84-37" aria-hidden="true" tabindex="-1"></a>  testee.gam1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Ront[fold], </span>
<span id="cb84-38"><a href="#cb84-38" aria-hidden="true" tabindex="-1"></a>                            <span class="at">pred =</span> res.teste.lm_Ront1)</span>
<span id="cb84-39"><a href="#cb84-39" aria-hidden="true" tabindex="-1"></a>  testee.gam2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Ront[fold], </span>
<span id="cb84-40"><a href="#cb84-40" aria-hidden="true" tabindex="-1"></a>                            <span class="at">pred =</span> res.teste.lm_Ront2)</span>
<span id="cb84-41"><a href="#cb84-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-42"><a href="#cb84-42" aria-hidden="true" tabindex="-1"></a>  res.teste.gam1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb84-43"><a href="#cb84-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">gam.Ront =</span> <span class="fu">defaultSummary</span>(testee.gam1))</span>
<span id="cb84-44"><a href="#cb84-44" aria-hidden="true" tabindex="-1"></a>  res.teste.gam2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb84-45"><a href="#cb84-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">gam.Ront =</span> <span class="fu">defaultSummary</span>(testee.gam2))</span>
<span id="cb84-46"><a href="#cb84-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-47"><a href="#cb84-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"res.teste.gam1"</span>, i), <span class="fu">t</span>(res.teste.gam1))</span>
<span id="cb84-48"><a href="#cb84-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"res.teste.gam2"</span>, i), <span class="fu">t</span>(res.teste.gam2))</span>
<span id="cb84-49"><a href="#cb84-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-50"><a href="#cb84-50" aria-hidden="true" tabindex="-1"></a>  j <span class="ot">&lt;-</span> (i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span></span>
<span id="cb84-51"><a href="#cb84-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-52"><a href="#cb84-52" aria-hidden="true" tabindex="-1"></a>  res.teste_Ront[j<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">1</span>),<span class="dv">1</span>] <span class="ot">&lt;-</span> i</span>
<span id="cb84-53"><a href="#cb84-53" aria-hidden="true" tabindex="-1"></a>  res.teste_Ront[j<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">1</span>),<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"gam1"</span>, <span class="st">"gam2"</span>)</span>
<span id="cb84-54"><a href="#cb84-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-55"><a href="#cb84-55" aria-hidden="true" tabindex="-1"></a>  res.teste_Ront[j,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>]   <span class="ot">&lt;-</span> <span class="fu">t</span>(res.teste.gam1)</span>
<span id="cb84-56"><a href="#cb84-56" aria-hidden="true" tabindex="-1"></a>  res.teste_Ront[j<span class="sc">+</span><span class="dv">1</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">t</span>(res.teste.gam2)</span>
<span id="cb84-57"><a href="#cb84-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-58"><a href="#cb84-58" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb84-59"><a href="#cb84-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-60"><a href="#cb84-60" aria-hidden="true" tabindex="-1"></a>res.teste_Ront <span class="sc">%&gt;%</span></span>
<span id="cb84-61"><a href="#cb84-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span></span>
<span id="cb84-62"><a href="#cb84-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(RMSE, Rsquared, MAE), <span class="fu">list</span>(<span class="at">name =</span> mean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  model RMSE_name Rsquared_name MAE_name
  &lt;chr&gt;     &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;
1 gam1       40.8         0.595     36.2
2 gam2       38.2         0.479     34.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>res.teste_Ront <span class="sc">%&gt;%</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(RMSE, Rsquared, MAE), <span class="fu">list</span>(<span class="at">name =</span> sd))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  model RMSE_name Rsquared_name MAE_name
  &lt;chr&gt;     &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;
1 gam1       20.5         0.357     18.6
2 gam2       19.2         0.347     18.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(RMSE <span class="sc">~</span> model, res.teste_Ront)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum exact test

data:  RMSE by model
W = 52, p-value = 0.9118
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(MAE <span class="sc">~</span> model, res.teste_Ront)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>res2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum exact test

data:  MAE by model
W = 54, p-value = 0.7959
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
</section>
<section id="random-forest-and-bag-tuning" class="level2">
<h2 class="anchored" data-anchor-id="random-forest-and-bag-tuning">Random forest and BAG tuning</h2>
<p>RF and BAG tuning for Ra:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>nr <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(plan_respostas)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>prop <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>nfolds <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">1</span><span class="sc">/</span>prop,<span class="dv">0</span>)</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>fr <span class="ot">&lt;-</span> <span class="fu">round</span>(prop<span class="sc">*</span><span class="fu">nrow</span>(plan_respostas))</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>res.teste_Ra <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fold =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">model =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">RMSE =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">Rsquared =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">MAE =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds))</span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nfolds) {</span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Definindo particao (fold)</span></span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> <span class="fu">sample</span>(nr[<span class="sc">!</span><span class="fu">is.na</span>(nr)], fr, <span class="at">replace =</span> F) </span>
<span id="cb92-21"><a href="#cb92-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"fold"</span>, i),fold)                  </span>
<span id="cb92-22"><a href="#cb92-22" aria-hidden="true" tabindex="-1"></a>  nr[fold] <span class="ot">&lt;-</span> <span class="cn">NA</span>                                  </span>
<span id="cb92-23"><a href="#cb92-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-24"><a href="#cb92-24" aria-hidden="true" tabindex="-1"></a>  plan.tr <span class="ot">&lt;-</span> plan_respostas[<span class="sc">-</span>fold,]</span>
<span id="cb92-25"><a href="#cb92-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-26"><a href="#cb92-26" aria-hidden="true" tabindex="-1"></a>  bag_Ra <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Ra<span class="sc">~</span>x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data =</span> plan.tr,</span>
<span id="cb92-27"><a href="#cb92-27" aria-hidden="true" tabindex="-1"></a>                         <span class="at">mtry =</span> <span class="dv">3</span>, <span class="at">importance =</span> <span class="cn">TRUE</span>, <span class="at">ntree =</span> <span class="dv">500</span>)</span>
<span id="cb92-28"><a href="#cb92-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-29"><a href="#cb92-29" aria-hidden="true" tabindex="-1"></a>  rf_Ra <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Ra<span class="sc">~</span>x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data =</span> plan.tr,</span>
<span id="cb92-30"><a href="#cb92-30" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mtry =</span> <span class="dv">2</span>, <span class="at">importance =</span> <span class="cn">TRUE</span>, <span class="at">ntree =</span> <span class="dv">500</span>)</span>
<span id="cb92-31"><a href="#cb92-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-32"><a href="#cb92-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"bag_Ra."</span>, i), bag_Ra) </span>
<span id="cb92-33"><a href="#cb92-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"rf_Ra."</span>, i), rf_Ra) </span>
<span id="cb92-34"><a href="#cb92-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-35"><a href="#cb92-35" aria-hidden="true" tabindex="-1"></a>  res.teste.bag_Ra <span class="ot">&lt;-</span> <span class="fu">predict</span>(bag_Ra, <span class="at">newdata =</span> plan_respostas[fold,])</span>
<span id="cb92-36"><a href="#cb92-36" aria-hidden="true" tabindex="-1"></a>  res.teste.rf_Ra <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_Ra, <span class="at">newdata =</span> plan_respostas[fold,])</span>
<span id="cb92-37"><a href="#cb92-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-38"><a href="#cb92-38" aria-hidden="true" tabindex="-1"></a>  testee.bag <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Ra[fold], </span>
<span id="cb92-39"><a href="#cb92-39" aria-hidden="true" tabindex="-1"></a>                            <span class="at">pred =</span> res.teste.bag_Ra)</span>
<span id="cb92-40"><a href="#cb92-40" aria-hidden="true" tabindex="-1"></a>  testee.rf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Ra[fold], </span>
<span id="cb92-41"><a href="#cb92-41" aria-hidden="true" tabindex="-1"></a>                            <span class="at">pred =</span> res.teste.rf_Ra)</span>
<span id="cb92-42"><a href="#cb92-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-43"><a href="#cb92-43" aria-hidden="true" tabindex="-1"></a>  res.teste.bag <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb92-44"><a href="#cb92-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">rsm.Ra =</span> <span class="fu">defaultSummary</span>(testee.bag))</span>
<span id="cb92-45"><a href="#cb92-45" aria-hidden="true" tabindex="-1"></a>  res.teste.rf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb92-46"><a href="#cb92-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">rsm.Ra =</span> <span class="fu">defaultSummary</span>(testee.rf))</span>
<span id="cb92-47"><a href="#cb92-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-48"><a href="#cb92-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"res.teste.bag"</span>, i), <span class="fu">t</span>(res.teste.bag))</span>
<span id="cb92-49"><a href="#cb92-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"res.teste.rf"</span>, i), <span class="fu">t</span>(res.teste.rf))</span>
<span id="cb92-50"><a href="#cb92-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-51"><a href="#cb92-51" aria-hidden="true" tabindex="-1"></a>  j <span class="ot">&lt;-</span> (i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span></span>
<span id="cb92-52"><a href="#cb92-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-53"><a href="#cb92-53" aria-hidden="true" tabindex="-1"></a>  res.teste_Ra[j<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">1</span>),<span class="dv">1</span>] <span class="ot">&lt;-</span> i</span>
<span id="cb92-54"><a href="#cb92-54" aria-hidden="true" tabindex="-1"></a>  res.teste_Ra[j<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">1</span>),<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"bag"</span>, <span class="st">"rf"</span>)</span>
<span id="cb92-55"><a href="#cb92-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-56"><a href="#cb92-56" aria-hidden="true" tabindex="-1"></a>  res.teste_Ra[j,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>]   <span class="ot">&lt;-</span> <span class="fu">t</span>(res.teste.bag)</span>
<span id="cb92-57"><a href="#cb92-57" aria-hidden="true" tabindex="-1"></a>  res.teste_Ra[j<span class="sc">+</span><span class="dv">1</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">t</span>(res.teste.rf)</span>
<span id="cb92-58"><a href="#cb92-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-59"><a href="#cb92-59" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb92-60"><a href="#cb92-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-61"><a href="#cb92-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-62"><a href="#cb92-62" aria-hidden="true" tabindex="-1"></a>res.teste_Ra <span class="sc">%&gt;%</span></span>
<span id="cb92-63"><a href="#cb92-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span></span>
<span id="cb92-64"><a href="#cb92-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(RMSE, Rsquared, MAE), <span class="fu">list</span>(<span class="at">name =</span> mean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  model RMSE_name Rsquared_name MAE_name
  &lt;chr&gt;     &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;
1 bag       0.418         0.917    0.346
2 rf        0.428         0.925    0.355</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>res.teste_Ra <span class="sc">%&gt;%</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(RMSE, Rsquared, MAE), <span class="fu">list</span>(<span class="at">name =</span> sd))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  model RMSE_name Rsquared_name MAE_name
  &lt;chr&gt;     &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;
1 bag       0.215         0.108    0.146
2 rf        0.261         0.129    0.189</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(RMSE <span class="sc">~</span> model, res.teste_Ra)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum exact test

data:  RMSE by model
W = 50, p-value = 1
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(MAE <span class="sc">~</span> model, res.teste_Ra)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>res2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum exact test

data:  MAE by model
W = 49, p-value = 0.9705
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<p>RF and BAG tuning for Fc:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>nr <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(plan_respostas)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>prop <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>nfolds <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">1</span><span class="sc">/</span>prop,<span class="dv">0</span>)</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>fr <span class="ot">&lt;-</span> <span class="fu">round</span>(prop<span class="sc">*</span><span class="fu">nrow</span>(plan_respostas))</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>res.teste_Fc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fold =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">model =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">RMSE =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">Rsquared =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">MAE =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds))</span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nfolds) {</span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Definindo particao (fold)</span></span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> <span class="fu">sample</span>(nr[<span class="sc">!</span><span class="fu">is.na</span>(nr)], fr, <span class="at">replace =</span> F) </span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"fold"</span>, i),fold)                  </span>
<span id="cb100-22"><a href="#cb100-22" aria-hidden="true" tabindex="-1"></a>  nr[fold] <span class="ot">&lt;-</span> <span class="cn">NA</span>                                  </span>
<span id="cb100-23"><a href="#cb100-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb100-24"><a href="#cb100-24" aria-hidden="true" tabindex="-1"></a>  plan.tr <span class="ot">&lt;-</span> plan_respostas[<span class="sc">-</span>fold,]</span>
<span id="cb100-25"><a href="#cb100-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb100-26"><a href="#cb100-26" aria-hidden="true" tabindex="-1"></a>  bag_Fc <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Fc<span class="sc">~</span>x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data =</span> plan.tr,</span>
<span id="cb100-27"><a href="#cb100-27" aria-hidden="true" tabindex="-1"></a>                         <span class="at">mtry =</span> <span class="dv">3</span>, <span class="at">importance =</span> <span class="cn">TRUE</span>, <span class="at">ntree =</span> <span class="dv">500</span>)</span>
<span id="cb100-28"><a href="#cb100-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-29"><a href="#cb100-29" aria-hidden="true" tabindex="-1"></a>  rf_Fc <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Fc<span class="sc">~</span>x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data =</span> plan.tr,</span>
<span id="cb100-30"><a href="#cb100-30" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mtry =</span> <span class="dv">2</span>, <span class="at">importance =</span> <span class="cn">TRUE</span>, <span class="at">ntree =</span> <span class="dv">500</span>)</span>
<span id="cb100-31"><a href="#cb100-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-32"><a href="#cb100-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"bag_Fc."</span>, i), bag_Fc) </span>
<span id="cb100-33"><a href="#cb100-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"rf_Fc."</span>, i), rf_Fc) </span>
<span id="cb100-34"><a href="#cb100-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-35"><a href="#cb100-35" aria-hidden="true" tabindex="-1"></a>  res.teste.bag_Fc <span class="ot">&lt;-</span> <span class="fu">predict</span>(bag_Fc, <span class="at">newdata =</span> plan_respostas[fold,])</span>
<span id="cb100-36"><a href="#cb100-36" aria-hidden="true" tabindex="-1"></a>  res.teste.rf_Fc <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_Fc, <span class="at">newdata =</span> plan_respostas[fold,])</span>
<span id="cb100-37"><a href="#cb100-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-38"><a href="#cb100-38" aria-hidden="true" tabindex="-1"></a>  testee.bag <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Fc[fold], </span>
<span id="cb100-39"><a href="#cb100-39" aria-hidden="true" tabindex="-1"></a>                            <span class="at">pred =</span> res.teste.bag_Fc)</span>
<span id="cb100-40"><a href="#cb100-40" aria-hidden="true" tabindex="-1"></a>  testee.rf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Fc[fold], </span>
<span id="cb100-41"><a href="#cb100-41" aria-hidden="true" tabindex="-1"></a>                            <span class="at">pred =</span> res.teste.rf_Fc)</span>
<span id="cb100-42"><a href="#cb100-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb100-43"><a href="#cb100-43" aria-hidden="true" tabindex="-1"></a>  res.teste.bag <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb100-44"><a href="#cb100-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">rsm.Fc =</span> <span class="fu">defaultSummary</span>(testee.bag))</span>
<span id="cb100-45"><a href="#cb100-45" aria-hidden="true" tabindex="-1"></a>  res.teste.rf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb100-46"><a href="#cb100-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">rsm.Fc =</span> <span class="fu">defaultSummary</span>(testee.rf))</span>
<span id="cb100-47"><a href="#cb100-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb100-48"><a href="#cb100-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"res.teste.bag"</span>, i), <span class="fu">t</span>(res.teste.bag))</span>
<span id="cb100-49"><a href="#cb100-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"res.teste.rf"</span>, i), <span class="fu">t</span>(res.teste.rf))</span>
<span id="cb100-50"><a href="#cb100-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb100-51"><a href="#cb100-51" aria-hidden="true" tabindex="-1"></a>  j <span class="ot">&lt;-</span> (i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span></span>
<span id="cb100-52"><a href="#cb100-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb100-53"><a href="#cb100-53" aria-hidden="true" tabindex="-1"></a>  res.teste_Fc[j<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">1</span>),<span class="dv">1</span>] <span class="ot">&lt;-</span> i</span>
<span id="cb100-54"><a href="#cb100-54" aria-hidden="true" tabindex="-1"></a>  res.teste_Fc[j<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">1</span>),<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"bag"</span>, <span class="st">"rf"</span>)</span>
<span id="cb100-55"><a href="#cb100-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb100-56"><a href="#cb100-56" aria-hidden="true" tabindex="-1"></a>  res.teste_Fc[j,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>]   <span class="ot">&lt;-</span> <span class="fu">t</span>(res.teste.bag)</span>
<span id="cb100-57"><a href="#cb100-57" aria-hidden="true" tabindex="-1"></a>  res.teste_Fc[j<span class="sc">+</span><span class="dv">1</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">t</span>(res.teste.rf)</span>
<span id="cb100-58"><a href="#cb100-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb100-59"><a href="#cb100-59" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb100-60"><a href="#cb100-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-61"><a href="#cb100-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-62"><a href="#cb100-62" aria-hidden="true" tabindex="-1"></a>res.teste_Fc <span class="sc">%&gt;%</span></span>
<span id="cb100-63"><a href="#cb100-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span></span>
<span id="cb100-64"><a href="#cb100-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(RMSE, Rsquared, MAE), <span class="fu">list</span>(<span class="at">name =</span> mean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  model RMSE_name Rsquared_name MAE_name
  &lt;chr&gt;     &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;
1 bag        3.72         0.661     3.20
2 rf         3.69         0.642     3.01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>res.teste_Fc <span class="sc">%&gt;%</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(RMSE, Rsquared, MAE), <span class="fu">list</span>(<span class="at">name =</span> sd))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  model RMSE_name Rsquared_name MAE_name
  &lt;chr&gt;     &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;
1 bag        1.11         0.244    0.919
2 rf         1.33         0.262    1.07 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(RMSE <span class="sc">~</span> model, res.teste_Fc)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum exact test

data:  RMSE by model
W = 51, p-value = 0.9705
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(MAE <span class="sc">~</span> model, res.teste_Fc)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>res2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum exact test

data:  MAE by model
W = 55, p-value = 0.7394
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<p>RF and BAG tuning for Fc:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>nr <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(plan_respostas)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>prop <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>nfolds <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">1</span><span class="sc">/</span>prop,<span class="dv">0</span>)</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>fr <span class="ot">&lt;-</span> <span class="fu">round</span>(prop<span class="sc">*</span><span class="fu">nrow</span>(plan_respostas))</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>res.teste_Ront <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fold =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">model =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">RMSE =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">Rsquared =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds),</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">MAE =</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span>nfolds))</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nfolds) {</span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Definindo particao (fold)</span></span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> <span class="fu">sample</span>(nr[<span class="sc">!</span><span class="fu">is.na</span>(nr)], fr, <span class="at">replace =</span> F) </span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"fold"</span>, i),fold)                  </span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a>  nr[fold] <span class="ot">&lt;-</span> <span class="cn">NA</span>                                  </span>
<span id="cb108-23"><a href="#cb108-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb108-24"><a href="#cb108-24" aria-hidden="true" tabindex="-1"></a>  plan.tr <span class="ot">&lt;-</span> plan_respostas[<span class="sc">-</span>fold,]</span>
<span id="cb108-25"><a href="#cb108-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb108-26"><a href="#cb108-26" aria-hidden="true" tabindex="-1"></a>  bag_Ront <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Ront<span class="sc">~</span>x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data =</span> plan.tr,</span>
<span id="cb108-27"><a href="#cb108-27" aria-hidden="true" tabindex="-1"></a>                         <span class="at">mtry =</span> <span class="dv">3</span>, <span class="at">importance =</span> <span class="cn">TRUE</span>, <span class="at">ntree =</span> <span class="dv">500</span>)</span>
<span id="cb108-28"><a href="#cb108-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-29"><a href="#cb108-29" aria-hidden="true" tabindex="-1"></a>  rf_Ront <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Ront<span class="sc">~</span>x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data =</span> plan.tr,</span>
<span id="cb108-30"><a href="#cb108-30" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mtry =</span> <span class="dv">2</span>, <span class="at">importance =</span> <span class="cn">TRUE</span>, <span class="at">ntree =</span> <span class="dv">500</span>)</span>
<span id="cb108-31"><a href="#cb108-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-32"><a href="#cb108-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"bag_Ront."</span>, i), bag_Ront) </span>
<span id="cb108-33"><a href="#cb108-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"rf_Ront."</span>, i), rf_Ront) </span>
<span id="cb108-34"><a href="#cb108-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-35"><a href="#cb108-35" aria-hidden="true" tabindex="-1"></a>  res.teste.bag_Ront <span class="ot">&lt;-</span> <span class="fu">predict</span>(bag_Ront, <span class="at">newdata =</span> plan_respostas[fold,])</span>
<span id="cb108-36"><a href="#cb108-36" aria-hidden="true" tabindex="-1"></a>  res.teste.rf_Ront <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_Ront, <span class="at">newdata =</span> plan_respostas[fold,])</span>
<span id="cb108-37"><a href="#cb108-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-38"><a href="#cb108-38" aria-hidden="true" tabindex="-1"></a>  testee.bag <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Ront[fold], </span>
<span id="cb108-39"><a href="#cb108-39" aria-hidden="true" tabindex="-1"></a>                            <span class="at">pred =</span> res.teste.bag_Ront)</span>
<span id="cb108-40"><a href="#cb108-40" aria-hidden="true" tabindex="-1"></a>  testee.rf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Ront[fold], </span>
<span id="cb108-41"><a href="#cb108-41" aria-hidden="true" tabindex="-1"></a>                            <span class="at">pred =</span> res.teste.rf_Ront)</span>
<span id="cb108-42"><a href="#cb108-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb108-43"><a href="#cb108-43" aria-hidden="true" tabindex="-1"></a>  res.teste.bag <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb108-44"><a href="#cb108-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">rsm.Ront =</span> <span class="fu">defaultSummary</span>(testee.bag))</span>
<span id="cb108-45"><a href="#cb108-45" aria-hidden="true" tabindex="-1"></a>  res.teste.rf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb108-46"><a href="#cb108-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">rsm.Ront =</span> <span class="fu">defaultSummary</span>(testee.rf))</span>
<span id="cb108-47"><a href="#cb108-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb108-48"><a href="#cb108-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"res.teste.bag"</span>, i), <span class="fu">t</span>(res.teste.bag))</span>
<span id="cb108-49"><a href="#cb108-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"res.teste.rf"</span>, i), <span class="fu">t</span>(res.teste.rf))</span>
<span id="cb108-50"><a href="#cb108-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb108-51"><a href="#cb108-51" aria-hidden="true" tabindex="-1"></a>  j <span class="ot">&lt;-</span> (i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span></span>
<span id="cb108-52"><a href="#cb108-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb108-53"><a href="#cb108-53" aria-hidden="true" tabindex="-1"></a>  res.teste_Ront[j<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">1</span>),<span class="dv">1</span>] <span class="ot">&lt;-</span> i</span>
<span id="cb108-54"><a href="#cb108-54" aria-hidden="true" tabindex="-1"></a>  res.teste_Ront[j<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">1</span>),<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"bag"</span>, <span class="st">"rf"</span>)</span>
<span id="cb108-55"><a href="#cb108-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb108-56"><a href="#cb108-56" aria-hidden="true" tabindex="-1"></a>  res.teste_Ront[j,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>]   <span class="ot">&lt;-</span> <span class="fu">t</span>(res.teste.bag)</span>
<span id="cb108-57"><a href="#cb108-57" aria-hidden="true" tabindex="-1"></a>  res.teste_Ront[j<span class="sc">+</span><span class="dv">1</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">t</span>(res.teste.rf)</span>
<span id="cb108-58"><a href="#cb108-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb108-59"><a href="#cb108-59" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb108-60"><a href="#cb108-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-61"><a href="#cb108-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-62"><a href="#cb108-62" aria-hidden="true" tabindex="-1"></a>res.teste_Ront <span class="sc">%&gt;%</span></span>
<span id="cb108-63"><a href="#cb108-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span></span>
<span id="cb108-64"><a href="#cb108-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(RMSE, Rsquared, MAE), <span class="fu">list</span>(<span class="at">name =</span> mean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  model RMSE_name Rsquared_name MAE_name
  &lt;chr&gt;     &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;
1 bag        36.1         0.495     31.1
2 rf         35.2         0.476     30.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>res.teste_Ront <span class="sc">%&gt;%</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(RMSE, Rsquared, MAE), <span class="fu">list</span>(<span class="at">name =</span> sd))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  model RMSE_name Rsquared_name MAE_name
  &lt;chr&gt;     &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;
1 bag        10.4         0.386     9.37
2 rf         10.4         0.358     9.48</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(RMSE <span class="sc">~</span> model, res.teste_Ront)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum exact test

data:  RMSE by model
W = 52, p-value = 0.9118
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(MAE <span class="sc">~</span> model, res.teste_Ront)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>res2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum exact test

data:  MAE by model
W = 52, p-value = 0.9118
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
</section>
<section id="svr-hyperparameters-selection" class="level2">
<h2 class="anchored" data-anchor-id="svr-hyperparameters-selection">SVR hyperparameters’ selection</h2>
<p>Cross-validation to define <code>kernel</code> for Ra:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>tune.out <span class="ot">&lt;-</span> <span class="fu">tune</span>(svm, Ra <span class="sc">~</span> x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data =</span> plan_respostas, </span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ranges =</span> <span class="fu">list</span>(<span class="at">cost=</span><span class="fu">c</span>(<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>),</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">gamma =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">kernel =</span> <span class="fu">c</span>(<span class="st">"linear"</span>, <span class="st">"radial"</span>, <span class="st">"polynomial"</span>)))</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(tune.out)</span></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>tune.out<span class="sc">$</span>best.parameters</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  cost gamma kernel
6   10     0 linear</code></pre>
</div>
</div>
<p>Cross validation to define <code>gamma</code> and <code>cost</code> for Ra:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>tune.out1 <span class="ot">&lt;-</span> <span class="fu">tune</span>(svm, Ra <span class="sc">~</span> x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data =</span> plan_respostas, <span class="at">kernel =</span> <span class="st">"linear"</span>,</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ranges =</span> <span class="fu">list</span>(<span class="at">cost=</span><span class="fu">c</span>(<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>),</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">gamma =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>)))</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(tune.out1)</span></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>tune.out1<span class="sc">$</span>best.parameters</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  cost gamma
6   10     0</code></pre>
</div>
</div>
<p>Cross-validation to define <code>kernel</code> for Fc:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>tune.out <span class="ot">&lt;-</span> <span class="fu">tune</span>(svm, Fc <span class="sc">~</span> x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data =</span> plan_respostas, </span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ranges =</span> <span class="fu">list</span>(<span class="at">cost=</span><span class="fu">c</span>(<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>),</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">gamma =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">kernel =</span> <span class="fu">c</span>(<span class="st">"linear"</span>, <span class="st">"radial"</span>, <span class="st">"polynomial"</span>)))</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(tune.out)</span></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>tune.out<span class="sc">$</span>best.parameters</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  cost gamma kernel
4    1     0 linear</code></pre>
</div>
</div>
<p>Cross validation to define <code>gamma</code> and <code>cost</code> for Fc:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>tune.out1 <span class="ot">&lt;-</span> <span class="fu">tune</span>(svm, Fc <span class="sc">~</span> x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data =</span> plan_respostas, <span class="at">kernel =</span> <span class="st">"linear"</span>,</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ranges =</span> <span class="fu">list</span>(<span class="at">cost=</span><span class="fu">c</span>(<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>),</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">gamma =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>)))</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(tune.out1)</span></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>tune.out1<span class="sc">$</span>best.parameters</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  cost gamma
4    1     0</code></pre>
</div>
</div>
<p>Cross-validation to define <code>kernel</code> for Ront:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>tune.out <span class="ot">&lt;-</span> <span class="fu">tune</span>(svm, Ront <span class="sc">~</span> x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data =</span> plan_respostas, </span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ranges =</span> <span class="fu">list</span>(<span class="at">cost=</span><span class="fu">c</span>(<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>),</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">gamma =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">kernel =</span> <span class="fu">c</span>(<span class="st">"linear"</span>, <span class="st">"radial"</span>, <span class="st">"polynomial"</span>)))</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(tune.out)</span></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>tune.out<span class="sc">$</span>best.parameters</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   cost gamma kernel
36   10   0.5 radial</code></pre>
</div>
</div>
<p>Cross validation to define <code>gamma</code> and <code>cost</code> for Ront:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>tune.out1 <span class="ot">&lt;-</span> <span class="fu">tune</span>(svm, Ront <span class="sc">~</span> x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data =</span> plan_respostas, <span class="at">kernel =</span> <span class="st">"radial"</span>,</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ranges =</span> <span class="fu">list</span>(<span class="at">cost=</span><span class="fu">c</span>(<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>),</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">gamma =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>)))</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(tune.out1)</span></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>tune.out1<span class="sc">$</span>best.parameters</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   cost gamma
12   10   0.5</code></pre>
</div>
</div>
</section>
<section id="xgb-hyperparameters-selection" class="level2">
<h2 class="anchored" data-anchor-id="xgb-hyperparameters-selection">XGB hyperparameters’ selection:</h2>
<p>XGB hyperparameters’ selection for Ra:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>fitControl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>, <span class="at">number =</span> <span class="dv">10</span>, <span class="at">repeats =</span> <span class="dv">2</span>, <span class="at">search =</span> <span class="st">"grid"</span>)</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>model_Ra <span class="ot">&lt;-</span> <span class="fu">train</span>(Ra<span class="sc">~</span>x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data =</span> plan_respostas, <span class="at">method =</span> <span class="st">"xgbTree"</span>, <span class="at">trControl =</span> fitControl, <span class="at">verbosity =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>model_Ra<span class="sc">$</span>bestTune</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   nrounds max_depth eta gamma colsample_bytree min_child_weight subsample
13      50         1 0.3     0              0.8                1      0.75</code></pre>
</div>
</div>
<p>XGB hyperparameters’ selection for Fc:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>fitControl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>, <span class="at">number =</span> <span class="dv">10</span>, <span class="at">repeats =</span> <span class="dv">2</span>, <span class="at">search =</span> <span class="st">"grid"</span>)</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>model_Fc <span class="ot">&lt;-</span> <span class="fu">train</span>(Fc<span class="sc">~</span>x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data =</span> plan_respostas, <span class="at">method =</span> <span class="st">"xgbTree"</span>, <span class="at">trControl =</span> fitControl, <span class="at">verbosity =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>model_Fc<span class="sc">$</span>bestTune</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   nrounds max_depth eta gamma colsample_bytree min_child_weight subsample
28      50         2 0.3     0              0.8                1       0.5</code></pre>
</div>
</div>
<p>XGB hyperparameters’ selection for Ront:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>fitControl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>, <span class="at">number =</span> <span class="dv">10</span>, <span class="at">repeats =</span> <span class="dv">2</span>, <span class="at">search =</span> <span class="st">"grid"</span>)</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>model_Ront <span class="ot">&lt;-</span> <span class="fu">train</span>(Ront<span class="sc">~</span>x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data =</span> plan_respostas, <span class="at">method =</span> <span class="st">"xgbTree"</span>, <span class="at">trControl =</span> fitControl, <span class="at">verbosity =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>model_Ront<span class="sc">$</span>bestTune</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  nrounds max_depth eta gamma colsample_bytree min_child_weight subsample
7      50         1 0.3     0              0.6                1         1</code></pre>
</div>
</div>
</section>
<section id="bootstrap-cross-validation-for-model-comparison" class="level2">
<h2 class="anchored" data-anchor-id="bootstrap-cross-validation-for-model-comparison">Bootstrap cross-validation for model comparison</h2>
<section id="comparing-models-for-ra" class="level3">
<h3 class="anchored" data-anchor-id="comparing-models-for-ra">Comparing models for Ra</h3>
<p>Models for Ra:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>lm_Ra <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ra <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> <span class="fu">I</span>(x2<span class="sc">^</span><span class="dv">2</span>), plan_respostas)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>gam_Ra <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ra <span class="sc">~</span> <span class="fu">ns</span>(x1,<span class="dv">3</span>) <span class="sc">+</span> <span class="fu">ns</span>(x2,<span class="dv">3</span>), plan_respostas)</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>bag_Ra <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Ra <span class="sc">~</span> x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data =</span> plan_respostas,</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mtry =</span> <span class="dv">3</span>, <span class="at">importance =</span> <span class="cn">TRUE</span>, <span class="at">ntree =</span> <span class="dv">500</span>)</span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>svm_Ra <span class="ot">&lt;-</span> <span class="fu">svm</span>(Ra <span class="sc">~</span> x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data =</span> plan_respostas, <span class="at">kernel =</span> <span class="st">"linear"</span>, </span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">cost =</span> <span class="dv">10</span>, <span class="at">gamma =</span> <span class="dv">0</span>)</span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>xgb_Ra <span class="ot">&lt;-</span> <span class="fu">xgboost</span>(<span class="at">data =</span> <span class="fu">as.matrix</span>(plan_respostas[,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>]), <span class="at">label =</span> plan_respostas<span class="sc">$</span>Ra,</span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nrounds =</span> <span class="dv">50</span>, <span class="at">max_depth =</span> <span class="dv">1</span>, <span class="at">eta =</span> <span class="fl">0.3</span>, <span class="at">gamma =</span> <span class="dv">0</span>, </span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">colsample_bytree =</span> <span class="fl">0.8</span>, <span class="at">min_child_weight =</span> <span class="dv">1</span>, <span class="at">subsample =</span> <span class="fl">0.75</span>, <span class="at">verbose =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Apparent Performance:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>perf_lm  <span class="ot">&lt;-</span> <span class="fu">metrics</span>(lm_Ra<span class="sc">$</span>fitted.values, plan_respostas<span class="sc">$</span>Ra)</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>perf_gam <span class="ot">&lt;-</span> <span class="fu">metrics</span>(gam_Ra<span class="sc">$</span>fitted.values, plan_respostas<span class="sc">$</span>Ra)</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>perf_bag <span class="ot">&lt;-</span> <span class="fu">metrics</span>(bag_Ra<span class="sc">$</span>predicted, plan_respostas<span class="sc">$</span>Ra)</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>perf_svm <span class="ot">&lt;-</span> <span class="fu">metrics</span>(svm_Ra<span class="sc">$</span>fitted, plan_respostas<span class="sc">$</span>Ra)</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>perf_xgb <span class="ot">&lt;-</span> <span class="fu">metrics</span>(<span class="fu">predict</span>(xgb_Ra, <span class="at">newdata =</span> <span class="fu">as.matrix</span>(plan_respostas[,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>])), plan_respostas<span class="sc">$</span>Ra)</span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"rsm"</span>,<span class="st">"gam"</span>, <span class="st">"bag"</span>, <span class="st">"svm"</span>, <span class="st">"xgb"</span>),</span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>           <span class="fu">rbind</span>(perf_lm,</span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a>                 perf_gam,</span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a>                 perf_bag,</span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a>                 perf_svm,</span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a>                 perf_xgb))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Model      RMSE        MSE        R2       MAE
1   rsm 0.2753407 0.07581248 0.9290152 0.2254220
2   gam 0.2595201 0.06735069 0.9369381 0.2195179
3   bag 0.4525622 0.20481252 0.8082297 0.3324089
4   svm 0.4188102 0.17540198 0.8357674 0.3275171
5   xgb 0.1717232 0.02948887 0.9723889 0.1348042</code></pre>
</div>
</div>
<p>Bootstrap cross-validation loop for Ra:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>nr <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(plan_respostas)</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>res.teste_Ra <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fold =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">method =</span> <span class="fu">character</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>                            <span class="at">RMSE =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>                            <span class="at">MSE =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a>                            <span class="at">Rsquared =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>                            <span class="at">MAE =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B))</span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a>optm_Ra <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fold =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method =</span> <span class="fu">character</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb140-14"><a href="#cb140-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">RMSE =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb140-15"><a href="#cb140-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">MSE =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb140-16"><a href="#cb140-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Rsquared =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb140-17"><a href="#cb140-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">MAE =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B))</span>
<span id="cb140-18"><a href="#cb140-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-19"><a href="#cb140-19" aria-hidden="true" tabindex="-1"></a>res.out_Ra <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fold =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb140-20"><a href="#cb140-20" aria-hidden="true" tabindex="-1"></a>                          <span class="at">method =</span> <span class="fu">character</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb140-21"><a href="#cb140-21" aria-hidden="true" tabindex="-1"></a>                          <span class="at">RMSE =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb140-22"><a href="#cb140-22" aria-hidden="true" tabindex="-1"></a>                          <span class="at">MSE =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb140-23"><a href="#cb140-23" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Rsquared =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb140-24"><a href="#cb140-24" aria-hidden="true" tabindex="-1"></a>                          <span class="at">MAE =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B))</span>
<span id="cb140-25"><a href="#cb140-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-26"><a href="#cb140-26" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb140-27"><a href="#cb140-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-28"><a href="#cb140-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb140-29"><a href="#cb140-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb140-30"><a href="#cb140-30" aria-hidden="true" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> <span class="fu">sample</span>(nr, <span class="fu">length</span>(nr), <span class="at">replace =</span> T)          </span>
<span id="cb140-31"><a href="#cb140-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb140-32"><a href="#cb140-32" aria-hidden="true" tabindex="-1"></a>  plan.tr <span class="ot">&lt;-</span> plan_respostas[fold,]</span>
<span id="cb140-33"><a href="#cb140-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb140-34"><a href="#cb140-34" aria-hidden="true" tabindex="-1"></a>  lm_Ra <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ra <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> <span class="fu">I</span>(x2<span class="sc">^</span><span class="dv">2</span>), plan.tr)</span>
<span id="cb140-35"><a href="#cb140-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb140-36"><a href="#cb140-36" aria-hidden="true" tabindex="-1"></a>  gam_Ra <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ra <span class="sc">~</span> <span class="fu">ns</span>(x1,<span class="dv">3</span>) <span class="sc">+</span> <span class="fu">ns</span>(x2,<span class="dv">3</span>), plan.tr)</span>
<span id="cb140-37"><a href="#cb140-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb140-38"><a href="#cb140-38" aria-hidden="true" tabindex="-1"></a>  bag_Ra <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Ra <span class="sc">~</span> x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data =</span> plan.tr,</span>
<span id="cb140-39"><a href="#cb140-39" aria-hidden="true" tabindex="-1"></a>                         <span class="at">mtry =</span> <span class="dv">3</span>, <span class="at">importance =</span> <span class="cn">TRUE</span>, <span class="at">ntree =</span> <span class="dv">500</span>)</span>
<span id="cb140-40"><a href="#cb140-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb140-41"><a href="#cb140-41" aria-hidden="true" tabindex="-1"></a>  svm_Ra <span class="ot">&lt;-</span> <span class="fu">svm</span>(Ra <span class="sc">~</span> x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data =</span> plan.tr, <span class="at">kernel =</span> <span class="st">"linear"</span>, </span>
<span id="cb140-42"><a href="#cb140-42" aria-hidden="true" tabindex="-1"></a>                <span class="at">cost =</span> <span class="dv">10</span>, <span class="at">gamma =</span> <span class="dv">0</span>)</span>
<span id="cb140-43"><a href="#cb140-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-44"><a href="#cb140-44" aria-hidden="true" tabindex="-1"></a>  xgb_Ra <span class="ot">&lt;-</span> <span class="fu">xgboost</span>(<span class="at">data =</span> <span class="fu">as.matrix</span>(plan.tr[,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>]), <span class="at">label =</span> plan.tr<span class="sc">$</span>Ra,</span>
<span id="cb140-45"><a href="#cb140-45" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nrounds =</span> <span class="dv">50</span>, <span class="at">max_depth =</span> <span class="dv">1</span>, <span class="at">eta =</span> <span class="fl">0.3</span>, <span class="at">gamma =</span> <span class="dv">0</span>, </span>
<span id="cb140-46"><a href="#cb140-46" aria-hidden="true" tabindex="-1"></a>                    <span class="at">colsample_bytree =</span> <span class="fl">0.8</span>, <span class="at">min_child_weight =</span> <span class="dv">1</span>, <span class="at">subsample =</span> <span class="fl">0.75</span>, <span class="at">verbose =</span> <span class="dv">0</span>)</span>
<span id="cb140-47"><a href="#cb140-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb140-48"><a href="#cb140-48" aria-hidden="true" tabindex="-1"></a>  perf_boot_lm  <span class="ot">&lt;-</span> <span class="fu">metrics</span>(lm_Ra<span class="sc">$</span>fitted.values, plan.tr<span class="sc">$</span>Ra)</span>
<span id="cb140-49"><a href="#cb140-49" aria-hidden="true" tabindex="-1"></a>  perf_boot_gam <span class="ot">&lt;-</span> <span class="fu">metrics</span>(gam_Ra<span class="sc">$</span>fitted.values, plan.tr<span class="sc">$</span>Ra)</span>
<span id="cb140-50"><a href="#cb140-50" aria-hidden="true" tabindex="-1"></a>  perf_boot_bag <span class="ot">&lt;-</span> <span class="fu">metrics</span>(bag_Ra<span class="sc">$</span>predicted, plan.tr<span class="sc">$</span>Ra)</span>
<span id="cb140-51"><a href="#cb140-51" aria-hidden="true" tabindex="-1"></a>  perf_boot_svm <span class="ot">&lt;-</span> <span class="fu">metrics</span>(svm_Ra<span class="sc">$</span>fitted, plan.tr<span class="sc">$</span>Ra)</span>
<span id="cb140-52"><a href="#cb140-52" aria-hidden="true" tabindex="-1"></a>  perf_boot_xgb <span class="ot">&lt;-</span> <span class="fu">metrics</span>(<span class="fu">predict</span>(xgb_Ra, <span class="at">newdata =</span> <span class="fu">as.matrix</span>(plan.tr[,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>])), plan.tr<span class="sc">$</span>Ra)</span>
<span id="cb140-53"><a href="#cb140-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb140-54"><a href="#cb140-54" aria-hidden="true" tabindex="-1"></a>  res.teste.lm_Ra <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_Ra, <span class="at">newdata =</span> plan_respostas)</span>
<span id="cb140-55"><a href="#cb140-55" aria-hidden="true" tabindex="-1"></a>  res.teste.gam_Ra <span class="ot">&lt;-</span> <span class="fu">predict</span>(gam_Ra, <span class="at">newdata =</span> plan_respostas)</span>
<span id="cb140-56"><a href="#cb140-56" aria-hidden="true" tabindex="-1"></a>  res.teste.bag_Ra <span class="ot">&lt;-</span> <span class="fu">predict</span>(bag_Ra, <span class="at">newdata =</span> plan_respostas)</span>
<span id="cb140-57"><a href="#cb140-57" aria-hidden="true" tabindex="-1"></a>  res.teste.svm_Ra <span class="ot">&lt;-</span> <span class="fu">predict</span>(svm_Ra, <span class="at">newdata =</span> plan_respostas)</span>
<span id="cb140-58"><a href="#cb140-58" aria-hidden="true" tabindex="-1"></a>  res.teste.xgb_Ra <span class="ot">&lt;-</span> <span class="fu">predict</span>(xgb_Ra, <span class="at">newdata =</span> <span class="fu">as.matrix</span>(plan_respostas[,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>]))</span>
<span id="cb140-59"><a href="#cb140-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb140-60"><a href="#cb140-60" aria-hidden="true" tabindex="-1"></a>  testee.rsm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Ra, </span>
<span id="cb140-61"><a href="#cb140-61" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pred =</span> res.teste.lm_Ra)</span>
<span id="cb140-62"><a href="#cb140-62" aria-hidden="true" tabindex="-1"></a>  testee.gam <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Ra, </span>
<span id="cb140-63"><a href="#cb140-63" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pred =</span> res.teste.gam_Ra)</span>
<span id="cb140-64"><a href="#cb140-64" aria-hidden="true" tabindex="-1"></a>  testee.bag <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Ra, </span>
<span id="cb140-65"><a href="#cb140-65" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pred =</span> res.teste.bag_Ra)</span>
<span id="cb140-66"><a href="#cb140-66" aria-hidden="true" tabindex="-1"></a>  testee.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Ra, </span>
<span id="cb140-67"><a href="#cb140-67" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pred =</span> res.teste.svm_Ra)</span>
<span id="cb140-68"><a href="#cb140-68" aria-hidden="true" tabindex="-1"></a>  testee.xgb <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Ra, </span>
<span id="cb140-69"><a href="#cb140-69" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pred =</span> res.teste.xgb_Ra)</span>
<span id="cb140-70"><a href="#cb140-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-71"><a href="#cb140-71" aria-hidden="true" tabindex="-1"></a>  res.teste.rsm <span class="ot">&lt;-</span> <span class="fu">metrics</span>(testee.rsm<span class="sc">$</span>pred, testee.rsm<span class="sc">$</span>obs)</span>
<span id="cb140-72"><a href="#cb140-72" aria-hidden="true" tabindex="-1"></a>  res.teste.gam <span class="ot">&lt;-</span> <span class="fu">metrics</span>(testee.gam<span class="sc">$</span>pred, testee.gam<span class="sc">$</span>obs)</span>
<span id="cb140-73"><a href="#cb140-73" aria-hidden="true" tabindex="-1"></a>  res.teste.bag <span class="ot">&lt;-</span> <span class="fu">metrics</span>(testee.bag<span class="sc">$</span>pred, testee.bag<span class="sc">$</span>obs)</span>
<span id="cb140-74"><a href="#cb140-74" aria-hidden="true" tabindex="-1"></a>  res.teste.svm <span class="ot">&lt;-</span> <span class="fu">metrics</span>(testee.svm<span class="sc">$</span>pred, testee.svm<span class="sc">$</span>obs)</span>
<span id="cb140-75"><a href="#cb140-75" aria-hidden="true" tabindex="-1"></a>  res.teste.xgb <span class="ot">&lt;-</span> <span class="fu">metrics</span>(testee.xgb<span class="sc">$</span>pred, testee.xgb<span class="sc">$</span>obs)</span>
<span id="cb140-76"><a href="#cb140-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-77"><a href="#cb140-77" aria-hidden="true" tabindex="-1"></a>  optm_lm  <span class="ot">&lt;-</span> perf_boot_lm  <span class="sc">-</span> res.teste.rsm</span>
<span id="cb140-78"><a href="#cb140-78" aria-hidden="true" tabindex="-1"></a>  optm_gam <span class="ot">&lt;-</span> perf_boot_lm  <span class="sc">-</span> res.teste.gam </span>
<span id="cb140-79"><a href="#cb140-79" aria-hidden="true" tabindex="-1"></a>  optm_bag <span class="ot">&lt;-</span> perf_boot_bag <span class="sc">-</span> res.teste.bag </span>
<span id="cb140-80"><a href="#cb140-80" aria-hidden="true" tabindex="-1"></a>  optm_svm <span class="ot">&lt;-</span> perf_boot_svm <span class="sc">-</span> res.teste.svm </span>
<span id="cb140-81"><a href="#cb140-81" aria-hidden="true" tabindex="-1"></a>  optm_xgb <span class="ot">&lt;-</span> perf_boot_bag <span class="sc">-</span> res.teste.xgb </span>
<span id="cb140-82"><a href="#cb140-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-83"><a href="#cb140-83" aria-hidden="true" tabindex="-1"></a>  j <span class="ot">&lt;-</span> (i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">5</span><span class="sc">+</span><span class="dv">1</span></span>
<span id="cb140-84"><a href="#cb140-84" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb140-85"><a href="#cb140-85" aria-hidden="true" tabindex="-1"></a>  res.teste_Ra[j<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">4</span>),<span class="dv">1</span>] <span class="ot">&lt;-</span> i</span>
<span id="cb140-86"><a href="#cb140-86" aria-hidden="true" tabindex="-1"></a>  res.teste_Ra[j<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">4</span>),<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"rsm"</span>,<span class="st">"gam"</span>, <span class="st">"bag"</span>, <span class="st">"svm"</span>, <span class="st">"xgb"</span>)</span>
<span id="cb140-87"><a href="#cb140-87" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb140-88"><a href="#cb140-88" aria-hidden="true" tabindex="-1"></a>  res.teste_Ra[j,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>]   <span class="ot">&lt;-</span> (res.teste.rsm)</span>
<span id="cb140-89"><a href="#cb140-89" aria-hidden="true" tabindex="-1"></a>  res.teste_Ra[j<span class="sc">+</span><span class="dv">1</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> (res.teste.gam)</span>
<span id="cb140-90"><a href="#cb140-90" aria-hidden="true" tabindex="-1"></a>  res.teste_Ra[j<span class="sc">+</span><span class="dv">2</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> (res.teste.bag)</span>
<span id="cb140-91"><a href="#cb140-91" aria-hidden="true" tabindex="-1"></a>  res.teste_Ra[j<span class="sc">+</span><span class="dv">3</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> (res.teste.svm)</span>
<span id="cb140-92"><a href="#cb140-92" aria-hidden="true" tabindex="-1"></a>  res.teste_Ra[j<span class="sc">+</span><span class="dv">4</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> (res.teste.xgb)</span>
<span id="cb140-93"><a href="#cb140-93" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb140-94"><a href="#cb140-94" aria-hidden="true" tabindex="-1"></a>  optm_Ra[j<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">4</span>),<span class="dv">1</span>] <span class="ot">&lt;-</span> i</span>
<span id="cb140-95"><a href="#cb140-95" aria-hidden="true" tabindex="-1"></a>  optm_Ra[j<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">4</span>),<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"rsm"</span>,<span class="st">"gam"</span>, <span class="st">"bag"</span>, <span class="st">"svm"</span>, <span class="st">"xgb"</span>)</span>
<span id="cb140-96"><a href="#cb140-96" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb140-97"><a href="#cb140-97" aria-hidden="true" tabindex="-1"></a>  optm_Ra[j,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>]   <span class="ot">&lt;-</span> (optm_lm)</span>
<span id="cb140-98"><a href="#cb140-98" aria-hidden="true" tabindex="-1"></a>  optm_Ra[j<span class="sc">+</span><span class="dv">1</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> (optm_gam)</span>
<span id="cb140-99"><a href="#cb140-99" aria-hidden="true" tabindex="-1"></a>  optm_Ra[j<span class="sc">+</span><span class="dv">2</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> (optm_bag)</span>
<span id="cb140-100"><a href="#cb140-100" aria-hidden="true" tabindex="-1"></a>  optm_Ra[j<span class="sc">+</span><span class="dv">3</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> (optm_svm)</span>
<span id="cb140-101"><a href="#cb140-101" aria-hidden="true" tabindex="-1"></a>  optm_Ra[j<span class="sc">+</span><span class="dv">4</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> (optm_xgb)</span>
<span id="cb140-102"><a href="#cb140-102" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb140-103"><a href="#cb140-103" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in predict.lm(gam_Ra, newdata = plan_respostas): prediction from
rank-deficient fit; attr(*, "non-estim") has doubtful cases</code></pre>
</div>
</div>
<p>Bootstrap performance for Ra models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>boot_mean <span class="ot">&lt;-</span> res.teste_Ra <span class="sc">%&gt;%</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(RMSE, MSE, Rsquared, MAE), <span class="fu">list</span>(<span class="at">name =</span> mean))</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>boot_mean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(boot_mean)</span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>boot_mean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  method RMSE_name   MSE_name Rsquared_name  MAE_name
1    bag 0.3311855 0.11481500     0.8924963 0.2221018
2    gam 0.4603819 5.17587221    -3.8462799 0.3040638
3    rsm 0.2992057 0.09041431     0.9153431 0.2408321
4    svm 0.4794193 0.23318846     0.7816607 0.3660932
5    xgb 0.3075982 0.10131743     0.9051343 0.2027992</code></pre>
</div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>boot_median <span class="ot">&lt;-</span> res.teste_Ra <span class="sc">%&gt;%</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(RMSE, MSE, Rsquared, MAE), <span class="fu">list</span>(<span class="at">name =</span> median))</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>boot_median <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(boot_median)</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>boot_median</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  method RMSE_name   MSE_name Rsquared_name  MAE_name
1    bag 0.3237199 0.10479497     0.9018782 0.2200188
2    gam 0.3076614 0.09465554     0.9113720 0.2424018
3    rsm 0.2907777 0.08455166     0.9208325 0.2358812
4    svm 0.4599131 0.21152003     0.8019493 0.3564470
5    xgb 0.2875351 0.08267647     0.9225882 0.2014139</code></pre>
</div>
</div>
<p>Average optimism for Ra models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>optm_mean <span class="ot">&lt;-</span> optm_Ra <span class="sc">%&gt;%</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(RMSE, MSE, Rsquared, MAE), <span class="fu">list</span>(<span class="at">name =</span> mean))</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>optm_mean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(optm_mean)</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>optm_median <span class="ot">&lt;-</span> optm_Ra <span class="sc">%&gt;%</span></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(RMSE, MSE, Rsquared, MAE), <span class="fu">list</span>(<span class="at">name =</span> median))</span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a>optm_median <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(optm_median)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Optimism corrected performance for Ra models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>opt_corr_mean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"rsm"</span>,<span class="st">"gam"</span>, <span class="st">"bag"</span>, <span class="st">"svm"</span>, <span class="st">"xgb"</span>),</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">rbind</span>(perf_lm <span class="sc">-</span> optm_mean[<span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>          perf_gam <span class="sc">-</span> optm_mean[<span class="dv">2</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>          perf_bag <span class="sc">-</span> optm_mean[<span class="dv">3</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>          perf_svm <span class="sc">-</span> optm_mean[<span class="dv">4</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>          perf_xgb <span class="sc">-</span> optm_mean[<span class="dv">5</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]))</span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>opt_corr_mean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Model      RMSE        MSE         R2       MAE
1   rsm 0.2667288 0.07003846  0.9471568 0.2226055
2   gam 0.4626908 5.17583470 -3.8392514 0.3151452
3   bag 0.4945566 0.22783864  0.7936632 0.3648045
4   svm 0.4998613 0.24682749  0.7815792 0.3968730
5   xgb 0.1395240 0.01021728  1.0031687 0.1126851</code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>opt_corr_median <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"rsm"</span>,<span class="st">"gam"</span>, <span class="st">"bag"</span>, <span class="st">"svm"</span>, <span class="st">"xgb"</span>),</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(perf_lm <span class="sc">-</span> optm_median[<span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>          perf_gam <span class="sc">-</span> optm_median[<span class="dv">2</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>          perf_bag <span class="sc">-</span> optm_median[<span class="dv">3</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>          perf_svm <span class="sc">-</span> optm_median[<span class="dv">4</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>          perf_xgb <span class="sc">-</span> optm_median[<span class="dv">5</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]))</span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>opt_corr_median</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Model      RMSE          MSE        R2       MAE
1   rsm 0.2443788  0.056971853 0.9457423 0.2179451
2   gam 0.3230396  0.101844985 0.9088521 0.2577160
3   bag 0.4894031  0.224953677 0.7932013 0.3633699
4   svm 0.4899929  0.236155238 0.7930587 0.3944558
5   xgb 0.1098669 -0.007541081 1.0036657 0.1035233</code></pre>
</div>
</div>
<p>Plotting test results for Ra models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(res.teste_Ra, <span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> RMSE, <span class="at">color =</span> method)) <span class="sc">+</span> </span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">geom =</span> <span class="st">"errorbar"</span>,</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span> </span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>)<span class="sc">+</span>  </span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MOEA_XGB_Internal_turning_PEEK_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="768"></p>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(res.teste_Ra, <span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> Rsquared, <span class="at">color =</span> method)) <span class="sc">+</span> </span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">geom =</span> <span class="st">"errorbar"</span>,</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span> </span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fl">0.25</span>,<span class="dv">1</span>) <span class="sc">+</span>  </span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MOEA_XGB_Internal_turning_PEEK_files/figure-html/unnamed-chunk-38-2.png" class="img-fluid" width="768"></p>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(res.teste_Ra, <span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> MAE, <span class="at">color =</span> method)) <span class="sc">+</span> </span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">geom =</span> <span class="st">"errorbar"</span>,</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span> </span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="fl">0.6</span>) <span class="sc">+</span>  </span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MOEA_XGB_Internal_turning_PEEK_files/figure-html/unnamed-chunk-38-3.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Kruskal-Wallis test to compare Ra models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(RMSE <span class="sc">~</span> method, res.teste_Ra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  RMSE by method
Kruskal-Wallis chi-squared = 1010.5, df = 4, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.wilcox.test</span>(res.teste_Ra<span class="sc">$</span>RMSE, res.teste_Ra<span class="sc">$</span>method,</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">p.adjust.method =</span> <span class="st">"BH"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using Wilcoxon rank sum test with continuity correction 

data:  res.teste_Ra$RMSE and res.teste_Ra$method 

    bag     gam     rsm     svm    
gam 0.30    -       -       -      
rsm 2.9e-12 2.4e-09 -       -      
svm &lt; 2e-16 &lt; 2e-16 &lt; 2e-16 -      
xgb 9.5e-08 1.8e-12 0.14    &lt; 2e-16

P value adjustment method: BH </code></pre>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(MAE <span class="sc">~</span> method, res.teste_Ra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  MAE by method
Kruskal-Wallis chi-squared = 1531.2, df = 4, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.wilcox.test</span>(res.teste_Ra<span class="sc">$</span>MAE, res.teste_Ra<span class="sc">$</span>method,</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">p.adjust.method =</span> <span class="st">"BH"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using Wilcoxon rank sum test with continuity correction 

data:  res.teste_Ra$MAE and res.teste_Ra$method 

    bag     gam     rsm     svm    
gam &lt; 2e-16 -       -       -      
rsm &lt; 2e-16 9.3e-07 -       -      
svm &lt; 2e-16 &lt; 2e-16 &lt; 2e-16 -      
xgb &lt; 2e-16 &lt; 2e-16 &lt; 2e-16 &lt; 2e-16

P value adjustment method: BH </code></pre>
</div>
</div>
</section>
<section id="comparing-models-for-fc" class="level3">
<h3 class="anchored" data-anchor-id="comparing-models-for-fc">Comparing models for Fc</h3>
<p>Models for Fc:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>lm_Fc <span class="ot">&lt;-</span> <span class="fu">lm</span>(Fc <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> <span class="fu">I</span>(x2<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x3<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> x1<span class="sc">:</span>x3, plan_respostas)</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>gam_Fc <span class="ot">&lt;-</span> <span class="fu">lm</span>(Fc <span class="sc">~</span> <span class="fu">ns</span>(x2,<span class="dv">3</span>) , plan_respostas)</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>bag_Fc <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Fc <span class="sc">~</span> x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data =</span> plan_respostas,</span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mtry =</span> <span class="dv">3</span>, <span class="at">importance =</span> <span class="cn">TRUE</span>, <span class="at">ntree =</span> <span class="dv">500</span>)</span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>svm_Fc <span class="ot">&lt;-</span> <span class="fu">svm</span>(Fc <span class="sc">~</span> x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data =</span> plan_respostas, <span class="at">kernel =</span> <span class="st">"linear"</span>, </span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">cost =</span> <span class="dv">10</span>, <span class="at">gamma =</span> <span class="dv">0</span>)</span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a>xgb_Fc <span class="ot">&lt;-</span> <span class="fu">xgboost</span>(<span class="at">data =</span> <span class="fu">as.matrix</span>(plan_respostas[,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>]), <span class="at">label =</span> plan_respostas<span class="sc">$</span>Fc,</span>
<span id="cb162-12"><a href="#cb162-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nrounds =</span> <span class="dv">50</span>, <span class="at">max_depth =</span> <span class="dv">2</span>, <span class="at">eta =</span> <span class="fl">0.3</span>, <span class="at">gamma =</span> <span class="dv">0</span>, </span>
<span id="cb162-13"><a href="#cb162-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">colsample_bytree =</span> <span class="fl">0.8</span>, <span class="at">min_child_weight =</span> <span class="dv">1</span>, <span class="at">subsample =</span> <span class="fl">0.5</span>, <span class="at">verbose =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Apparent performance:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>perf_lm  <span class="ot">&lt;-</span> <span class="fu">metrics</span>(lm_Fc<span class="sc">$</span>fitted.values, plan_respostas<span class="sc">$</span>Fc)</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>perf_gam <span class="ot">&lt;-</span> <span class="fu">metrics</span>(gam_Fc<span class="sc">$</span>fitted.values, plan_respostas<span class="sc">$</span>Fc)</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>perf_bag <span class="ot">&lt;-</span> <span class="fu">metrics</span>(bag_Fc<span class="sc">$</span>predicted, plan_respostas<span class="sc">$</span>Fc)</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>perf_svm <span class="ot">&lt;-</span> <span class="fu">metrics</span>(svm_Fc<span class="sc">$</span>fitted, plan_respostas<span class="sc">$</span>Fc)</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>perf_xgb <span class="ot">&lt;-</span> <span class="fu">metrics</span>(<span class="fu">predict</span>(xgb_Fc, <span class="at">newdata =</span> <span class="fu">as.matrix</span>(plan_respostas[,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>])), plan_respostas<span class="sc">$</span>Fc)</span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"rsm"</span>,<span class="st">"gam"</span>, <span class="st">"bag"</span>, <span class="st">"svm"</span>, <span class="st">"xgb"</span>),</span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a>           <span class="fu">rbind</span>(perf_lm,</span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a>                 perf_gam,</span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a>                 perf_bag,</span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a>                 perf_svm,</span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a>                 perf_xgb))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Model     RMSE       MSE        R2      MAE
1   rsm 2.566265  6.585715 0.7926093 1.890015
2   gam 2.917236  8.510263 0.7320033 2.296185
3   bag 3.871774 14.990636 0.5279299 3.207964
4   svm 2.951126  8.709144 0.7257404 2.205008
5   xgb 2.005523  4.022121 0.8733394 1.297976</code></pre>
</div>
</div>
<p>Botstrap loop for Fc:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>nr <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(plan_respostas)</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>res.teste_Fc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fold =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">method =</span> <span class="fu">character</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a>                            <span class="at">RMSE =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a>                            <span class="at">MSE =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a>                            <span class="at">Rsquared =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a>                            <span class="at">MAE =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B))</span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-12"><a href="#cb165-12" aria-hidden="true" tabindex="-1"></a>optm_Fc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fold =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb165-13"><a href="#cb165-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method =</span> <span class="fu">character</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb165-14"><a href="#cb165-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">RMSE =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb165-15"><a href="#cb165-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">MSE =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb165-16"><a href="#cb165-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Rsquared =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb165-17"><a href="#cb165-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">MAE =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B))</span>
<span id="cb165-18"><a href="#cb165-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-19"><a href="#cb165-19" aria-hidden="true" tabindex="-1"></a>res.out_Fc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fold =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb165-20"><a href="#cb165-20" aria-hidden="true" tabindex="-1"></a>                          <span class="at">method =</span> <span class="fu">character</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb165-21"><a href="#cb165-21" aria-hidden="true" tabindex="-1"></a>                          <span class="at">RMSE =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb165-22"><a href="#cb165-22" aria-hidden="true" tabindex="-1"></a>                          <span class="at">MSE =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb165-23"><a href="#cb165-23" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Rsquared =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb165-24"><a href="#cb165-24" aria-hidden="true" tabindex="-1"></a>                          <span class="at">MAE =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B))</span>
<span id="cb165-25"><a href="#cb165-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-26"><a href="#cb165-26" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb165-27"><a href="#cb165-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-28"><a href="#cb165-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb165-29"><a href="#cb165-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb165-30"><a href="#cb165-30" aria-hidden="true" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> <span class="fu">sample</span>(nr, <span class="fu">length</span>(nr), <span class="at">replace =</span> T)          </span>
<span id="cb165-31"><a href="#cb165-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-32"><a href="#cb165-32" aria-hidden="true" tabindex="-1"></a>  plan.tr <span class="ot">&lt;-</span> plan_respostas[fold,]</span>
<span id="cb165-33"><a href="#cb165-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb165-34"><a href="#cb165-34" aria-hidden="true" tabindex="-1"></a>  lm_Fc <span class="ot">&lt;-</span> <span class="fu">lm</span>(Fc <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> <span class="fu">I</span>(x2<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x3<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> x1<span class="sc">:</span>x3, plan.tr)</span>
<span id="cb165-35"><a href="#cb165-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb165-36"><a href="#cb165-36" aria-hidden="true" tabindex="-1"></a>  gam_Fc <span class="ot">&lt;-</span> <span class="fu">lm</span>(Fc <span class="sc">~</span> <span class="fu">ns</span>(x2,<span class="dv">3</span>), plan.tr)</span>
<span id="cb165-37"><a href="#cb165-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb165-38"><a href="#cb165-38" aria-hidden="true" tabindex="-1"></a>  bag_Fc <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Fc <span class="sc">~</span> x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data =</span> plan.tr,</span>
<span id="cb165-39"><a href="#cb165-39" aria-hidden="true" tabindex="-1"></a>                         <span class="at">mtry =</span> <span class="dv">3</span>, <span class="at">importance =</span> <span class="cn">TRUE</span>, <span class="at">ntree =</span> <span class="dv">500</span>)</span>
<span id="cb165-40"><a href="#cb165-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb165-41"><a href="#cb165-41" aria-hidden="true" tabindex="-1"></a>  svm_Fc <span class="ot">&lt;-</span> <span class="fu">svm</span>(Fc <span class="sc">~</span> x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data =</span> plan.tr, <span class="at">kernel =</span> <span class="st">"linear"</span>, </span>
<span id="cb165-42"><a href="#cb165-42" aria-hidden="true" tabindex="-1"></a>                <span class="at">cost =</span> <span class="dv">10</span>, <span class="at">gamma =</span> <span class="dv">0</span>)</span>
<span id="cb165-43"><a href="#cb165-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb165-44"><a href="#cb165-44" aria-hidden="true" tabindex="-1"></a>  xgb_Fc <span class="ot">&lt;-</span> <span class="fu">xgboost</span>(<span class="at">data =</span> <span class="fu">as.matrix</span>(plan.tr[,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>]), <span class="at">label =</span> plan.tr<span class="sc">$</span>Fc,</span>
<span id="cb165-45"><a href="#cb165-45" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nrounds =</span> <span class="dv">50</span>, <span class="at">max_depth =</span> <span class="dv">2</span>, <span class="at">eta =</span> <span class="fl">0.3</span>, <span class="at">gamma =</span> <span class="dv">0</span>, </span>
<span id="cb165-46"><a href="#cb165-46" aria-hidden="true" tabindex="-1"></a>                    <span class="at">colsample_bytree =</span> <span class="fl">0.8</span>, <span class="at">min_child_weight =</span> <span class="dv">1</span>, <span class="at">subsample =</span> <span class="fl">0.5</span>, <span class="at">verbose =</span> <span class="dv">0</span>)</span>
<span id="cb165-47"><a href="#cb165-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb165-48"><a href="#cb165-48" aria-hidden="true" tabindex="-1"></a>  perf_boot_lm  <span class="ot">&lt;-</span> <span class="fu">metrics</span>(lm_Fc<span class="sc">$</span>fitted.values, plan.tr<span class="sc">$</span>Fc)</span>
<span id="cb165-49"><a href="#cb165-49" aria-hidden="true" tabindex="-1"></a>  perf_boot_gam <span class="ot">&lt;-</span> <span class="fu">metrics</span>(gam_Fc<span class="sc">$</span>fitted.values, plan.tr<span class="sc">$</span>Fc)</span>
<span id="cb165-50"><a href="#cb165-50" aria-hidden="true" tabindex="-1"></a>  perf_boot_bag <span class="ot">&lt;-</span> <span class="fu">metrics</span>(bag_Fc<span class="sc">$</span>predicted, plan.tr<span class="sc">$</span>Fc)</span>
<span id="cb165-51"><a href="#cb165-51" aria-hidden="true" tabindex="-1"></a>  perf_boot_svm <span class="ot">&lt;-</span> <span class="fu">metrics</span>(svm_Fc<span class="sc">$</span>fitted, plan.tr<span class="sc">$</span>Fc)</span>
<span id="cb165-52"><a href="#cb165-52" aria-hidden="true" tabindex="-1"></a>  perf_boot_xgb <span class="ot">&lt;-</span> <span class="fu">metrics</span>(<span class="fu">predict</span>(xgb_Fc, <span class="at">newdata =</span> <span class="fu">as.matrix</span>(plan.tr[,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>])), plan.tr<span class="sc">$</span>Fc)</span>
<span id="cb165-53"><a href="#cb165-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb165-54"><a href="#cb165-54" aria-hidden="true" tabindex="-1"></a>  res.teste.lm_Fc <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_Fc, <span class="at">newdata =</span> plan_respostas)</span>
<span id="cb165-55"><a href="#cb165-55" aria-hidden="true" tabindex="-1"></a>  res.teste.gam_Fc <span class="ot">&lt;-</span> <span class="fu">predict</span>(gam_Fc, <span class="at">newdata =</span> plan_respostas)</span>
<span id="cb165-56"><a href="#cb165-56" aria-hidden="true" tabindex="-1"></a>  res.teste.bag_Fc <span class="ot">&lt;-</span> <span class="fu">predict</span>(bag_Fc, <span class="at">newdata =</span> plan_respostas)</span>
<span id="cb165-57"><a href="#cb165-57" aria-hidden="true" tabindex="-1"></a>  res.teste.svm_Fc <span class="ot">&lt;-</span> <span class="fu">predict</span>(svm_Fc, <span class="at">newdata =</span> plan_respostas)</span>
<span id="cb165-58"><a href="#cb165-58" aria-hidden="true" tabindex="-1"></a>  res.teste.xgb_Fc <span class="ot">&lt;-</span> <span class="fu">predict</span>(xgb_Fc, <span class="at">newdata =</span> <span class="fu">as.matrix</span>(plan_respostas[,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>]))</span>
<span id="cb165-59"><a href="#cb165-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb165-60"><a href="#cb165-60" aria-hidden="true" tabindex="-1"></a>  testee.rsm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Fc, </span>
<span id="cb165-61"><a href="#cb165-61" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pred =</span> res.teste.lm_Fc)</span>
<span id="cb165-62"><a href="#cb165-62" aria-hidden="true" tabindex="-1"></a>  testee.gam <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Fc, </span>
<span id="cb165-63"><a href="#cb165-63" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pred =</span> res.teste.gam_Fc)</span>
<span id="cb165-64"><a href="#cb165-64" aria-hidden="true" tabindex="-1"></a>  testee.bag <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Fc, </span>
<span id="cb165-65"><a href="#cb165-65" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pred =</span> res.teste.bag_Fc)</span>
<span id="cb165-66"><a href="#cb165-66" aria-hidden="true" tabindex="-1"></a>  testee.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Fc, </span>
<span id="cb165-67"><a href="#cb165-67" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pred =</span> res.teste.svm_Fc)</span>
<span id="cb165-68"><a href="#cb165-68" aria-hidden="true" tabindex="-1"></a>  testee.xgb <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Fc, </span>
<span id="cb165-69"><a href="#cb165-69" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pred =</span> res.teste.xgb_Fc)</span>
<span id="cb165-70"><a href="#cb165-70" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb165-71"><a href="#cb165-71" aria-hidden="true" tabindex="-1"></a>  res.teste.rsm <span class="ot">&lt;-</span> <span class="fu">metrics</span>(testee.rsm<span class="sc">$</span>pred, testee.rsm<span class="sc">$</span>obs)</span>
<span id="cb165-72"><a href="#cb165-72" aria-hidden="true" tabindex="-1"></a>  res.teste.gam <span class="ot">&lt;-</span> <span class="fu">metrics</span>(testee.gam<span class="sc">$</span>pred, testee.gam<span class="sc">$</span>obs)</span>
<span id="cb165-73"><a href="#cb165-73" aria-hidden="true" tabindex="-1"></a>  res.teste.bag <span class="ot">&lt;-</span> <span class="fu">metrics</span>(testee.bag<span class="sc">$</span>pred, testee.bag<span class="sc">$</span>obs)</span>
<span id="cb165-74"><a href="#cb165-74" aria-hidden="true" tabindex="-1"></a>  res.teste.svm <span class="ot">&lt;-</span> <span class="fu">metrics</span>(testee.svm<span class="sc">$</span>pred, testee.svm<span class="sc">$</span>obs)</span>
<span id="cb165-75"><a href="#cb165-75" aria-hidden="true" tabindex="-1"></a>  res.teste.xgb <span class="ot">&lt;-</span> <span class="fu">metrics</span>(testee.xgb<span class="sc">$</span>pred, testee.xgb<span class="sc">$</span>obs)</span>
<span id="cb165-76"><a href="#cb165-76" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb165-77"><a href="#cb165-77" aria-hidden="true" tabindex="-1"></a>  optm_lm  <span class="ot">&lt;-</span> perf_boot_lm  <span class="sc">-</span> res.teste.rsm</span>
<span id="cb165-78"><a href="#cb165-78" aria-hidden="true" tabindex="-1"></a>  optm_gam <span class="ot">&lt;-</span> perf_boot_lm  <span class="sc">-</span> res.teste.gam </span>
<span id="cb165-79"><a href="#cb165-79" aria-hidden="true" tabindex="-1"></a>  optm_bag <span class="ot">&lt;-</span> perf_boot_bag <span class="sc">-</span> res.teste.bag </span>
<span id="cb165-80"><a href="#cb165-80" aria-hidden="true" tabindex="-1"></a>  optm_svm <span class="ot">&lt;-</span> perf_boot_svm <span class="sc">-</span> res.teste.svm </span>
<span id="cb165-81"><a href="#cb165-81" aria-hidden="true" tabindex="-1"></a>  optm_xgb <span class="ot">&lt;-</span> perf_boot_bag <span class="sc">-</span> res.teste.xgb </span>
<span id="cb165-82"><a href="#cb165-82" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb165-83"><a href="#cb165-83" aria-hidden="true" tabindex="-1"></a>  j <span class="ot">&lt;-</span> (i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">5</span><span class="sc">+</span><span class="dv">1</span></span>
<span id="cb165-84"><a href="#cb165-84" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb165-85"><a href="#cb165-85" aria-hidden="true" tabindex="-1"></a>  res.teste_Fc[j<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">4</span>),<span class="dv">1</span>] <span class="ot">&lt;-</span> i</span>
<span id="cb165-86"><a href="#cb165-86" aria-hidden="true" tabindex="-1"></a>  res.teste_Fc[j<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">4</span>),<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"rsm"</span>,<span class="st">"gam"</span>, <span class="st">"bag"</span>, <span class="st">"svm"</span>, <span class="st">"xgb"</span>)</span>
<span id="cb165-87"><a href="#cb165-87" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb165-88"><a href="#cb165-88" aria-hidden="true" tabindex="-1"></a>  res.teste_Fc[j,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>]   <span class="ot">&lt;-</span> (res.teste.rsm)</span>
<span id="cb165-89"><a href="#cb165-89" aria-hidden="true" tabindex="-1"></a>  res.teste_Fc[j<span class="sc">+</span><span class="dv">1</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> (res.teste.gam)</span>
<span id="cb165-90"><a href="#cb165-90" aria-hidden="true" tabindex="-1"></a>  res.teste_Fc[j<span class="sc">+</span><span class="dv">2</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> (res.teste.bag)</span>
<span id="cb165-91"><a href="#cb165-91" aria-hidden="true" tabindex="-1"></a>  res.teste_Fc[j<span class="sc">+</span><span class="dv">3</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> (res.teste.svm)</span>
<span id="cb165-92"><a href="#cb165-92" aria-hidden="true" tabindex="-1"></a>  res.teste_Fc[j<span class="sc">+</span><span class="dv">4</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> (res.teste.xgb)</span>
<span id="cb165-93"><a href="#cb165-93" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb165-94"><a href="#cb165-94" aria-hidden="true" tabindex="-1"></a>  optm_Fc[j<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">4</span>),<span class="dv">1</span>] <span class="ot">&lt;-</span> i</span>
<span id="cb165-95"><a href="#cb165-95" aria-hidden="true" tabindex="-1"></a>  optm_Fc[j<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">4</span>),<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"rsm"</span>,<span class="st">"gam"</span>, <span class="st">"bag"</span>, <span class="st">"svm"</span>, <span class="st">"xgb"</span>)</span>
<span id="cb165-96"><a href="#cb165-96" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb165-97"><a href="#cb165-97" aria-hidden="true" tabindex="-1"></a>  optm_Fc[j,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>]   <span class="ot">&lt;-</span> (optm_lm)</span>
<span id="cb165-98"><a href="#cb165-98" aria-hidden="true" tabindex="-1"></a>  optm_Fc[j<span class="sc">+</span><span class="dv">1</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> (optm_gam)</span>
<span id="cb165-99"><a href="#cb165-99" aria-hidden="true" tabindex="-1"></a>  optm_Fc[j<span class="sc">+</span><span class="dv">2</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> (optm_bag)</span>
<span id="cb165-100"><a href="#cb165-100" aria-hidden="true" tabindex="-1"></a>  optm_Fc[j<span class="sc">+</span><span class="dv">3</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> (optm_svm)</span>
<span id="cb165-101"><a href="#cb165-101" aria-hidden="true" tabindex="-1"></a>  optm_Fc[j<span class="sc">+</span><span class="dv">4</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> (optm_xgb)</span>
<span id="cb165-102"><a href="#cb165-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-103"><a href="#cb165-103" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ns(x2, 3): shoving 'interior' knots matching boundary knots to
inside

Warning in ns(x2, 3): shoving 'interior' knots matching boundary knots to
inside</code></pre>
</div>
</div>
<p>Bootstrap performance for Fc models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>boot_mean <span class="ot">&lt;-</span> res.teste_Fc <span class="sc">%&gt;%</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(RMSE, MSE, Rsquared, MAE), <span class="fu">list</span>(<span class="at">name =</span> mean))</span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>boot_mean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(boot_mean)</span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>boot_mean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  method RMSE_name  MSE_name Rsquared_name MAE_name
1    bag  3.049360  9.384274     0.7044799 2.256966
2    gam  3.156017 10.018991     0.6844920 2.476462
3    rsm  2.996359  9.408255     0.7037247 2.252014
4    svm  3.212828 10.367559     0.6735152 2.408414
5    xgb  2.925768  8.719924     0.7254009 1.911708</code></pre>
</div>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>boot_median <span class="ot">&lt;-</span> res.teste_Fc <span class="sc">%&gt;%</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(RMSE, MSE, Rsquared, MAE), <span class="fu">list</span>(<span class="at">name =</span> median))</span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>boot_median <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(boot_median)</span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>boot_median</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  method RMSE_name  MSE_name Rsquared_name MAE_name
1    bag  3.018004  9.108347     0.7131691 2.226520
2    gam  3.076098  9.462376     0.7020203 2.440096
3    rsm  2.818473  7.943792     0.7498421 2.146376
4    svm  3.179085 10.106585     0.6817336 2.372637
5    xgb  2.906414  8.447240     0.7339880 1.903027</code></pre>
</div>
</div>
<p>Average optimism for Fc models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>optm_mean <span class="ot">&lt;-</span> optm_Fc <span class="sc">%&gt;%</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(RMSE, MSE, Rsquared, MAE), <span class="fu">list</span>(<span class="at">name =</span> mean))</span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>optm_mean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(optm_mean)</span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>optm_median <span class="ot">&lt;-</span> optm_Fc <span class="sc">%&gt;%</span></span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(RMSE, MSE, Rsquared, MAE), <span class="fu">list</span>(<span class="at">name =</span> median))</span>
<span id="cb171-10"><a href="#cb171-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-11"><a href="#cb171-11" aria-hidden="true" tabindex="-1"></a>optm_median <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(optm_median)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Optimism corrected performance for Fc models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>opt_corr_mean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"rsm"</span>,<span class="st">"gam"</span>, <span class="st">"bag"</span>, <span class="st">"svm"</span>, <span class="st">"xgb"</span>),</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">rbind</span>(perf_lm <span class="sc">-</span> optm_mean[<span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>                perf_gam <span class="sc">-</span> optm_mean[<span class="dv">2</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>                perf_bag <span class="sc">-</span> optm_mean[<span class="dv">3</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>                perf_svm <span class="sc">-</span> optm_mean[<span class="dv">4</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a>                perf_xgb <span class="sc">-</span> optm_mean[<span class="dv">5</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]))</span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a>opt_corr_mean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Model     RMSE       MSE        R2       MAE
1   rsm 2.545257  6.300430 0.8263852 1.8684808
2   gam 3.746384 12.943822 0.6074824 3.0558948
3   bag 4.541265 18.813460 0.4226417 3.7432266
4   svm 3.348233 10.942093 0.6764597 2.6012062
5   xgb 1.860924  3.072487 0.9280364 0.9311836</code></pre>
</div>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>opt_corr_median <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"rsm"</span>,<span class="st">"gam"</span>, <span class="st">"bag"</span>, <span class="st">"svm"</span>, <span class="st">"xgb"</span>),</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">rbind</span>(perf_lm <span class="sc">-</span> optm_median[<span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>                perf_gam <span class="sc">-</span> optm_median[<span class="dv">2</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>                perf_bag <span class="sc">-</span> optm_median[<span class="dv">3</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>                perf_svm <span class="sc">-</span> optm_median[<span class="dv">4</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>                perf_xgb <span class="sc">-</span> optm_median[<span class="dv">5</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]))</span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a>opt_corr_median</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Model     RMSE       MSE        R2       MAE
1   rsm 2.528654  6.360324 0.8179890 1.8596947
2   gam 3.726286 12.896201 0.6057248 3.0668379
3   bag 4.424114 17.789154 0.4492564 3.7044699
4   svm 3.342747 11.010499 0.6718181 2.6021793
5   xgb 1.819657  2.940625 0.9219636 0.9276791</code></pre>
</div>
</div>
<p>Plotting test results for Fc models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(res.teste_Fc, <span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> RMSE, <span class="at">color =</span> method)) <span class="sc">+</span> </span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">geom =</span> <span class="st">"errorbar"</span>,</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span> </span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">10</span>) <span class="sc">+</span>  </span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MOEA_XGB_Internal_turning_PEEK_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="768"></p>
</div>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(res.teste_Fc, <span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> Rsquared, <span class="at">color =</span> method)) <span class="sc">+</span> </span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">geom =</span> <span class="st">"errorbar"</span>,</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span> </span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span>  </span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MOEA_XGB_Internal_turning_PEEK_files/figure-html/unnamed-chunk-46-2.png" class="img-fluid" width="768"></p>
</div>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(res.teste_Fc, <span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> MAE, <span class="at">color =</span> method)) <span class="sc">+</span> </span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">geom =</span> <span class="st">"errorbar"</span>,</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span> </span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fl">0.5</span>,<span class="dv">7</span>) <span class="sc">+</span>  </span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MOEA_XGB_Internal_turning_PEEK_files/figure-html/unnamed-chunk-46-3.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Kruskal-Wallis test to compare Fc models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(MSE <span class="sc">~</span> method, res.teste_Fc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  MSE by method
Kruskal-Wallis chi-squared = 439.8, df = 4, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.wilcox.test</span>(res.teste_Fc<span class="sc">$</span>MSE, res.teste_Fc<span class="sc">$</span>method,</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">p.adjust.method =</span> <span class="st">"BH"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using Wilcoxon rank sum test with continuity correction 

data:  res.teste_Fc$MSE and res.teste_Fc$method 

    bag     gam     rsm     svm    
gam 7.4e-11 -       -       -      
rsm 2.6e-16 &lt; 2e-16 -       -      
svm &lt; 2e-16 6.0e-10 &lt; 2e-16 -      
xgb 4.4e-09 &lt; 2e-16 0.79    &lt; 2e-16

P value adjustment method: BH </code></pre>
</div>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(MAE <span class="sc">~</span> method, res.teste_Fc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  MAE by method
Kruskal-Wallis chi-squared = 1048.9, df = 4, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.wilcox.test</span>(res.teste_Fc<span class="sc">$</span>MAE, res.teste_Fc<span class="sc">$</span>method,</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">p.adjust.method =</span> <span class="st">"BH"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using Wilcoxon rank sum test with continuity correction 

data:  res.teste_Fc$MAE and res.teste_Fc$method 

    bag     gam     rsm     svm    
gam &lt; 2e-16 -       -       -      
rsm 0.00023 &lt; 2e-16 -       -      
svm &lt; 2e-16 4.4e-13 &lt; 2e-16 -      
xgb &lt; 2e-16 &lt; 2e-16 &lt; 2e-16 &lt; 2e-16

P value adjustment method: BH </code></pre>
</div>
</div>
</section>
<section id="comparing-models-for-ront" class="level3">
<h3 class="anchored" data-anchor-id="comparing-models-for-ront">Comparing models for Ront</h3>
<p>Models for Ront:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>lm_Ront <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ront <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x2<span class="sc">:</span>x3, plan_respostas)</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>gam_Ront <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ront <span class="sc">~</span> <span class="dv">1</span>, plan_respostas)</span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>bag_Ront <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Ront <span class="sc">~</span> x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data =</span> plan_respostas,</span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mtry =</span> <span class="dv">3</span>, <span class="at">importance =</span> <span class="cn">TRUE</span>, <span class="at">ntree =</span> <span class="dv">500</span>)</span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a>svm_Ront <span class="ot">&lt;-</span> <span class="fu">svm</span>(Ront <span class="sc">~</span> x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data =</span> plan_respostas, <span class="at">kernel =</span> <span class="st">"linear"</span>, </span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">cost =</span> <span class="fl">0.1</span>, <span class="at">gamma =</span> <span class="dv">0</span>)</span>
<span id="cb187-10"><a href="#cb187-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-11"><a href="#cb187-11" aria-hidden="true" tabindex="-1"></a>xgb_Ront <span class="ot">&lt;-</span> <span class="fu">xgboost</span>(<span class="at">data =</span> <span class="fu">as.matrix</span>(plan_respostas[,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>]), <span class="at">label =</span> plan_respostas<span class="sc">$</span>Ront, <span class="at">nrounds =</span> <span class="dv">50</span>, <span class="at">max_depth =</span> <span class="dv">1</span>, <span class="at">eta =</span> <span class="fl">0.3</span>, <span class="at">gamma =</span> <span class="dv">0</span>, </span>
<span id="cb187-12"><a href="#cb187-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">colsample_bytree =</span> <span class="fl">0.6</span>, <span class="at">min_child_weight =</span> <span class="dv">1</span>, <span class="at">subsample =</span> <span class="dv">1</span>, <span class="at">verbose =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Apparent performance of the models for Ront:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>perf_lm  <span class="ot">&lt;-</span> <span class="fu">metrics</span>(lm_Ront<span class="sc">$</span>fitted.values, plan_respostas<span class="sc">$</span>Ront)</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>perf_gam <span class="ot">&lt;-</span> <span class="fu">metrics</span>(gam_Ront<span class="sc">$</span>fitted.values, plan_respostas<span class="sc">$</span>Ront)</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>perf_bag <span class="ot">&lt;-</span> <span class="fu">metrics</span>(bag_Ront<span class="sc">$</span>predicted, plan_respostas<span class="sc">$</span>Ront)</span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>perf_svm <span class="ot">&lt;-</span> <span class="fu">metrics</span>(svm_Ront<span class="sc">$</span>fitted, plan_respostas<span class="sc">$</span>Ront)</span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>perf_xgb <span class="ot">&lt;-</span> <span class="fu">metrics</span>(<span class="fu">predict</span>(xgb_Ront, <span class="at">newdata =</span> <span class="fu">as.matrix</span>(plan_respostas[,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>])), plan_respostas<span class="sc">$</span>Ront)</span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"rsm"</span>,<span class="st">"gam"</span>, <span class="st">"bag"</span>, <span class="st">"svm"</span>, <span class="st">"xgb"</span>),</span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a>           <span class="fu">rbind</span>(perf_lm,</span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a>                 perf_gam,</span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a>                 perf_bag,</span>
<span id="cb188-11"><a href="#cb188-11" aria-hidden="true" tabindex="-1"></a>                 perf_svm,</span>
<span id="cb188-12"><a href="#cb188-12" aria-hidden="true" tabindex="-1"></a>                 perf_xgb))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Model     RMSE       MSE            R2      MAE
1   rsm 29.55196  873.3186  2.175013e-01 23.74495
2   gam 33.40754 1116.0640  8.881784e-16 26.73775
3   bag 36.44021 1327.8887 -1.897962e-01 29.61888
4   svm 31.31873  980.8627  1.211412e-01 24.74157
5   xgb 21.09633  445.0552  6.012278e-01 17.43026</code></pre>
</div>
</div>
<p>Bootstrap loop for Ront:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>nr <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(plan_respostas)</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>res.teste_Ront <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fold =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">method =</span> <span class="fu">character</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>                            <span class="at">RMSE =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a>                            <span class="at">MSE =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a>                            <span class="at">Rsquared =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a>                            <span class="at">MAE =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B))</span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a>optm_Ront <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fold =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method =</span> <span class="fu">character</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb190-14"><a href="#cb190-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">RMSE =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb190-15"><a href="#cb190-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">MSE =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb190-16"><a href="#cb190-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Rsquared =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb190-17"><a href="#cb190-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">MAE =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B))</span>
<span id="cb190-18"><a href="#cb190-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-19"><a href="#cb190-19" aria-hidden="true" tabindex="-1"></a>res.out_Ront <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fold =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb190-20"><a href="#cb190-20" aria-hidden="true" tabindex="-1"></a>                          <span class="at">method =</span> <span class="fu">character</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb190-21"><a href="#cb190-21" aria-hidden="true" tabindex="-1"></a>                          <span class="at">RMSE =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb190-22"><a href="#cb190-22" aria-hidden="true" tabindex="-1"></a>                          <span class="at">MSE =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb190-23"><a href="#cb190-23" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Rsquared =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B),</span>
<span id="cb190-24"><a href="#cb190-24" aria-hidden="true" tabindex="-1"></a>                          <span class="at">MAE =</span> <span class="fu">numeric</span>(<span class="dv">5</span><span class="sc">*</span>B))</span>
<span id="cb190-25"><a href="#cb190-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-26"><a href="#cb190-26" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb190-27"><a href="#cb190-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-28"><a href="#cb190-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb190-29"><a href="#cb190-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb190-30"><a href="#cb190-30" aria-hidden="true" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> <span class="fu">sample</span>(nr, <span class="fu">length</span>(nr), <span class="at">replace =</span> T)  </span>
<span id="cb190-31"><a href="#cb190-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-32"><a href="#cb190-32" aria-hidden="true" tabindex="-1"></a>  plan.tr <span class="ot">&lt;-</span> plan_respostas[fold,]</span>
<span id="cb190-33"><a href="#cb190-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb190-34"><a href="#cb190-34" aria-hidden="true" tabindex="-1"></a>  lm_Ront <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ront <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x2<span class="sc">:</span>x3, plan.tr)</span>
<span id="cb190-35"><a href="#cb190-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb190-36"><a href="#cb190-36" aria-hidden="true" tabindex="-1"></a>  gam_Ront <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ront <span class="sc">~</span> <span class="dv">1</span>, plan.tr)</span>
<span id="cb190-37"><a href="#cb190-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb190-38"><a href="#cb190-38" aria-hidden="true" tabindex="-1"></a>  bag_Ront <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Ront <span class="sc">~</span> x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data =</span> plan.tr,</span>
<span id="cb190-39"><a href="#cb190-39" aria-hidden="true" tabindex="-1"></a>                           <span class="at">mtry =</span> <span class="dv">3</span>, <span class="at">importance =</span> <span class="cn">TRUE</span>, <span class="at">ntree =</span> <span class="dv">500</span>)</span>
<span id="cb190-40"><a href="#cb190-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb190-41"><a href="#cb190-41" aria-hidden="true" tabindex="-1"></a>  svm_Ront <span class="ot">&lt;-</span> <span class="fu">svm</span>(Ront <span class="sc">~</span> x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data =</span> plan.tr, <span class="at">kernel =</span> <span class="st">"linear"</span>, </span>
<span id="cb190-42"><a href="#cb190-42" aria-hidden="true" tabindex="-1"></a>                <span class="at">cost =</span> <span class="fl">0.1</span>, <span class="at">gamma =</span> <span class="dv">0</span>)</span>
<span id="cb190-43"><a href="#cb190-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb190-44"><a href="#cb190-44" aria-hidden="true" tabindex="-1"></a>  xgb_Ront <span class="ot">&lt;-</span> <span class="fu">xgboost</span>(<span class="at">data =</span> <span class="fu">as.matrix</span>(plan.tr[,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>]), <span class="at">label =</span> plan.tr<span class="sc">$</span>Ront,</span>
<span id="cb190-45"><a href="#cb190-45" aria-hidden="true" tabindex="-1"></a>                      <span class="at">nrounds =</span> <span class="dv">50</span>, <span class="at">max_depth =</span> <span class="dv">1</span>, <span class="at">eta =</span> <span class="fl">0.3</span>, <span class="at">gamma =</span> <span class="dv">0</span>, </span>
<span id="cb190-46"><a href="#cb190-46" aria-hidden="true" tabindex="-1"></a>                      <span class="at">colsample_bytree =</span> <span class="fl">0.6</span>, <span class="at">min_child_weight =</span> <span class="dv">1</span>, <span class="at">subsample =</span> <span class="dv">1</span>, <span class="at">verbose =</span> <span class="dv">0</span>)</span>
<span id="cb190-47"><a href="#cb190-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb190-48"><a href="#cb190-48" aria-hidden="true" tabindex="-1"></a>  perf_boot_lm  <span class="ot">&lt;-</span> <span class="fu">metrics</span>(lm_Ront<span class="sc">$</span>fitted.values, plan.tr<span class="sc">$</span>Ront)</span>
<span id="cb190-49"><a href="#cb190-49" aria-hidden="true" tabindex="-1"></a>  perf_boot_gam <span class="ot">&lt;-</span> <span class="fu">metrics</span>(gam_Ront<span class="sc">$</span>fitted.values, plan.tr<span class="sc">$</span>Ront)</span>
<span id="cb190-50"><a href="#cb190-50" aria-hidden="true" tabindex="-1"></a>  perf_boot_bag <span class="ot">&lt;-</span> <span class="fu">metrics</span>(bag_Ront<span class="sc">$</span>predicted, plan.tr<span class="sc">$</span>Ront)</span>
<span id="cb190-51"><a href="#cb190-51" aria-hidden="true" tabindex="-1"></a>  perf_boot_svm <span class="ot">&lt;-</span> <span class="fu">metrics</span>(svm_Ront<span class="sc">$</span>fitted, plan.tr<span class="sc">$</span>Ront)</span>
<span id="cb190-52"><a href="#cb190-52" aria-hidden="true" tabindex="-1"></a>  perf_boot_xgb <span class="ot">&lt;-</span> <span class="fu">metrics</span>(<span class="fu">predict</span>(xgb_Ront, <span class="at">newdata =</span> <span class="fu">as.matrix</span>(plan.tr[,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>])), plan.tr<span class="sc">$</span>Ront)</span>
<span id="cb190-53"><a href="#cb190-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb190-54"><a href="#cb190-54" aria-hidden="true" tabindex="-1"></a>  res.teste.lm_Ront <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_Ront, <span class="at">newdata =</span> plan_respostas)</span>
<span id="cb190-55"><a href="#cb190-55" aria-hidden="true" tabindex="-1"></a>  res.teste.gam_Ront <span class="ot">&lt;-</span> <span class="fu">predict</span>(gam_Ront, <span class="at">newdata =</span> plan_respostas)</span>
<span id="cb190-56"><a href="#cb190-56" aria-hidden="true" tabindex="-1"></a>  res.teste.bag_Ront <span class="ot">&lt;-</span> <span class="fu">predict</span>(bag_Ront, <span class="at">newdata =</span> plan_respostas)</span>
<span id="cb190-57"><a href="#cb190-57" aria-hidden="true" tabindex="-1"></a>  res.teste.svm_Ront <span class="ot">&lt;-</span> <span class="fu">predict</span>(svm_Ront, <span class="at">newdata =</span> plan_respostas)</span>
<span id="cb190-58"><a href="#cb190-58" aria-hidden="true" tabindex="-1"></a>  res.teste.xgb_Ront <span class="ot">&lt;-</span> <span class="fu">predict</span>(xgb_Ront, <span class="at">newdata =</span> <span class="fu">as.matrix</span>(plan_respostas[,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>]))</span>
<span id="cb190-59"><a href="#cb190-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb190-60"><a href="#cb190-60" aria-hidden="true" tabindex="-1"></a>  testee.rsm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Ront, </span>
<span id="cb190-61"><a href="#cb190-61" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pred =</span> res.teste.lm_Ront)</span>
<span id="cb190-62"><a href="#cb190-62" aria-hidden="true" tabindex="-1"></a>  testee.gam <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Ront, </span>
<span id="cb190-63"><a href="#cb190-63" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pred =</span> res.teste.gam_Ront)</span>
<span id="cb190-64"><a href="#cb190-64" aria-hidden="true" tabindex="-1"></a>  testee.bag <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Ront, </span>
<span id="cb190-65"><a href="#cb190-65" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pred =</span> res.teste.bag_Ront)</span>
<span id="cb190-66"><a href="#cb190-66" aria-hidden="true" tabindex="-1"></a>  testee.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Ront, </span>
<span id="cb190-67"><a href="#cb190-67" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pred =</span> res.teste.svm_Ront)</span>
<span id="cb190-68"><a href="#cb190-68" aria-hidden="true" tabindex="-1"></a>  testee.xgb <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">obs =</span> plan_respostas<span class="sc">$</span>Ront, </span>
<span id="cb190-69"><a href="#cb190-69" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pred =</span> res.teste.xgb_Ront)</span>
<span id="cb190-70"><a href="#cb190-70" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb190-71"><a href="#cb190-71" aria-hidden="true" tabindex="-1"></a>  res.teste.rsm <span class="ot">&lt;-</span> <span class="fu">metrics</span>(testee.rsm<span class="sc">$</span>pred, testee.rsm<span class="sc">$</span>obs)</span>
<span id="cb190-72"><a href="#cb190-72" aria-hidden="true" tabindex="-1"></a>  res.teste.gam <span class="ot">&lt;-</span> <span class="fu">metrics</span>(testee.gam<span class="sc">$</span>pred, testee.gam<span class="sc">$</span>obs)</span>
<span id="cb190-73"><a href="#cb190-73" aria-hidden="true" tabindex="-1"></a>  res.teste.bag <span class="ot">&lt;-</span> <span class="fu">metrics</span>(testee.bag<span class="sc">$</span>pred, testee.bag<span class="sc">$</span>obs)</span>
<span id="cb190-74"><a href="#cb190-74" aria-hidden="true" tabindex="-1"></a>  res.teste.svm <span class="ot">&lt;-</span> <span class="fu">metrics</span>(testee.svm<span class="sc">$</span>pred, testee.svm<span class="sc">$</span>obs)</span>
<span id="cb190-75"><a href="#cb190-75" aria-hidden="true" tabindex="-1"></a>  res.teste.xgb <span class="ot">&lt;-</span> <span class="fu">metrics</span>(testee.xgb<span class="sc">$</span>pred, testee.xgb<span class="sc">$</span>obs)</span>
<span id="cb190-76"><a href="#cb190-76" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb190-77"><a href="#cb190-77" aria-hidden="true" tabindex="-1"></a>  optm_lm  <span class="ot">&lt;-</span> perf_boot_lm  <span class="sc">-</span> res.teste.rsm</span>
<span id="cb190-78"><a href="#cb190-78" aria-hidden="true" tabindex="-1"></a>  optm_gam <span class="ot">&lt;-</span> perf_boot_lm  <span class="sc">-</span> res.teste.gam </span>
<span id="cb190-79"><a href="#cb190-79" aria-hidden="true" tabindex="-1"></a>  optm_bag <span class="ot">&lt;-</span> perf_boot_bag <span class="sc">-</span> res.teste.bag </span>
<span id="cb190-80"><a href="#cb190-80" aria-hidden="true" tabindex="-1"></a>  optm_svm <span class="ot">&lt;-</span> perf_boot_svm <span class="sc">-</span> res.teste.svm </span>
<span id="cb190-81"><a href="#cb190-81" aria-hidden="true" tabindex="-1"></a>  optm_xgb <span class="ot">&lt;-</span> perf_boot_bag <span class="sc">-</span> res.teste.xgb </span>
<span id="cb190-82"><a href="#cb190-82" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb190-83"><a href="#cb190-83" aria-hidden="true" tabindex="-1"></a>  j <span class="ot">&lt;-</span> (i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">5</span><span class="sc">+</span><span class="dv">1</span></span>
<span id="cb190-84"><a href="#cb190-84" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb190-85"><a href="#cb190-85" aria-hidden="true" tabindex="-1"></a>  res.teste_Ront[j<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">4</span>),<span class="dv">1</span>] <span class="ot">&lt;-</span> i</span>
<span id="cb190-86"><a href="#cb190-86" aria-hidden="true" tabindex="-1"></a>  res.teste_Ront[j<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">4</span>),<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"rsm"</span>,<span class="st">"gam"</span>, <span class="st">"bag"</span>, <span class="st">"svm"</span>, <span class="st">"xgb"</span>)</span>
<span id="cb190-87"><a href="#cb190-87" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb190-88"><a href="#cb190-88" aria-hidden="true" tabindex="-1"></a>  res.teste_Ront[j,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>]   <span class="ot">&lt;-</span> (res.teste.rsm)</span>
<span id="cb190-89"><a href="#cb190-89" aria-hidden="true" tabindex="-1"></a>  res.teste_Ront[j<span class="sc">+</span><span class="dv">1</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> (res.teste.gam)</span>
<span id="cb190-90"><a href="#cb190-90" aria-hidden="true" tabindex="-1"></a>  res.teste_Ront[j<span class="sc">+</span><span class="dv">2</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> (res.teste.bag)</span>
<span id="cb190-91"><a href="#cb190-91" aria-hidden="true" tabindex="-1"></a>  res.teste_Ront[j<span class="sc">+</span><span class="dv">3</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> (res.teste.svm)</span>
<span id="cb190-92"><a href="#cb190-92" aria-hidden="true" tabindex="-1"></a>  res.teste_Ront[j<span class="sc">+</span><span class="dv">4</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> (res.teste.xgb)</span>
<span id="cb190-93"><a href="#cb190-93" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb190-94"><a href="#cb190-94" aria-hidden="true" tabindex="-1"></a>  optm_Ront[j<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">4</span>),<span class="dv">1</span>] <span class="ot">&lt;-</span> i</span>
<span id="cb190-95"><a href="#cb190-95" aria-hidden="true" tabindex="-1"></a>  optm_Ront[j<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">4</span>),<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"rsm"</span>,<span class="st">"gam"</span>, <span class="st">"bag"</span>, <span class="st">"svm"</span>, <span class="st">"xgb"</span>)</span>
<span id="cb190-96"><a href="#cb190-96" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb190-97"><a href="#cb190-97" aria-hidden="true" tabindex="-1"></a>  optm_Ront[j,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>]   <span class="ot">&lt;-</span> (optm_lm)</span>
<span id="cb190-98"><a href="#cb190-98" aria-hidden="true" tabindex="-1"></a>  optm_Ront[j<span class="sc">+</span><span class="dv">1</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> (optm_gam)</span>
<span id="cb190-99"><a href="#cb190-99" aria-hidden="true" tabindex="-1"></a>  optm_Ront[j<span class="sc">+</span><span class="dv">2</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> (optm_bag)</span>
<span id="cb190-100"><a href="#cb190-100" aria-hidden="true" tabindex="-1"></a>  optm_Ront[j<span class="sc">+</span><span class="dv">3</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> (optm_svm)</span>
<span id="cb190-101"><a href="#cb190-101" aria-hidden="true" tabindex="-1"></a>  optm_Ront[j<span class="sc">+</span><span class="dv">4</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> (optm_xgb)</span>
<span id="cb190-102"><a href="#cb190-102" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb190-103"><a href="#cb190-103" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Bootstrap performance for Ront models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>boot_mean <span class="ot">&lt;-</span> res.teste_Ront <span class="sc">%&gt;%</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(RMSE, MSE, Rsquared, MAE), <span class="fu">list</span>(<span class="at">name =</span> mean))</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>boot_mean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(boot_mean)</span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>boot_mean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  method RMSE_name  MSE_name Rsquared_name MAE_name
1    bag  26.84153  729.2446  0.3465924454 20.20172
2    gam  33.94246 1152.7905 -0.0329072010 27.27345
3    rsm  32.10742 1037.9739  0.0699691530 25.64881
4    svm  33.34629 1116.2464 -0.0001634387 26.25842
5    xgb  27.17033  748.0396  0.3297520634 20.73386</code></pre>
</div>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>boot_median <span class="ot">&lt;-</span> res.teste_Ront <span class="sc">%&gt;%</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(RMSE, MSE, Rsquared, MAE), <span class="fu">list</span>(<span class="at">name =</span> median))</span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>boot_median <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(boot_median)</span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a>boot_median</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  method RMSE_name  MSE_name Rsquared_name MAE_name
1    bag  26.58743  706.8916    0.36662092 19.95661
2    gam  33.64768 1132.1666   -0.01442811 26.99587
3    rsm  31.30703  980.1299    0.12179775 25.04739
4    svm  32.93348 1084.6139    0.02817944 25.87669
5    xgb  26.86761  721.8686    0.35320137 20.51237</code></pre>
</div>
</div>
<p>Average optimism for Ront models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>optm_mean <span class="ot">&lt;-</span> optm_Ront <span class="sc">%&gt;%</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(RMSE, MSE, Rsquared, MAE), <span class="fu">list</span>(<span class="at">name =</span> mean))</span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a>optm_mean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(optm_mean)</span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-7"><a href="#cb195-7" aria-hidden="true" tabindex="-1"></a>optm_median <span class="ot">&lt;-</span> optm_Ront <span class="sc">%&gt;%</span></span>
<span id="cb195-8"><a href="#cb195-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb195-9"><a href="#cb195-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(RMSE, MSE, Rsquared, MAE), <span class="fu">list</span>(<span class="at">name =</span> median))</span>
<span id="cb195-10"><a href="#cb195-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-11"><a href="#cb195-11" aria-hidden="true" tabindex="-1"></a>optm_median <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(optm_median)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Optimism corrected performance for Ront models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>opt_corr_mean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"rsm"</span>,<span class="st">"gam"</span>, <span class="st">"bag"</span>, <span class="st">"svm"</span>, <span class="st">"xgb"</span>),</span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">rbind</span>(perf_lm <span class="sc">-</span> optm_mean[<span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>                perf_gam <span class="sc">-</span> optm_mean[<span class="dv">2</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>                perf_bag <span class="sc">-</span> optm_mean[<span class="dv">3</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a>                perf_svm <span class="sc">-</span> optm_mean[<span class="dv">4</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a>                perf_xgb <span class="sc">-</span> optm_mean[<span class="dv">5</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]))</span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a>opt_corr_mean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Model     RMSE       MSE          R2      MAE
1   rsm 29.43525  861.7548  0.28941199 23.58790
2   gam 40.16522 1517.1877 -0.31464834 32.52795
3   bag 41.36283 1614.1959 -0.40156824 33.78444
4   svm 35.01258 1205.2333 -0.02825223 28.62770
5   xgb 21.30842  452.2863  0.65629818 17.80535</code></pre>
</div>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>opt_corr_median <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"rsm"</span>,<span class="st">"gam"</span>, <span class="st">"bag"</span>, <span class="st">"svm"</span>, <span class="st">"xgb"</span>),</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">rbind</span>(perf_lm <span class="sc">-</span> optm_median[<span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>                perf_gam <span class="sc">-</span> optm_median[<span class="dv">2</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>                perf_bag <span class="sc">-</span> optm_median[<span class="dv">3</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>                perf_svm <span class="sc">-</span> optm_median[<span class="dv">4</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>                perf_xgb <span class="sc">-</span> optm_median[<span class="dv">5</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]))</span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a>opt_corr_median</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Model     RMSE       MSE           R2      MAE
1   rsm 29.43979  867.6229  0.296684493 23.64547
2   gam 39.90902 1512.9871 -0.294494935 32.49728
3   bag 41.02846 1597.3797 -0.358760245 33.74859
4   svm 34.65374 1189.4607  0.001691154 28.53548
5   xgb 21.10006  445.2701  0.657933156 17.84495</code></pre>
</div>
</div>
<p>Plotting the test results for Ront models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(res.teste_Ront, <span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> RMSE, <span class="at">color =</span> method)) <span class="sc">+</span> </span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">geom =</span> <span class="st">"errorbar"</span>,</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span> </span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">10</span>,<span class="dv">60</span>) <span class="sc">+</span>  </span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MOEA_XGB_Internal_turning_PEEK_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid" width="768"></p>
</div>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(res.teste_Ront, <span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> Rsquared, <span class="at">color =</span> method)) <span class="sc">+</span> </span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">geom =</span> <span class="st">"errorbar"</span>,</span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span> </span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">+</span>  </span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing non-finite values (`stat_boxplot()`).
Removed 4 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="MOEA_XGB_Internal_turning_PEEK_files/figure-html/unnamed-chunk-54-2.png" class="img-fluid" width="768"></p>
</div>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(res.teste_Ront, <span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> MAE, <span class="at">color =</span> method)) <span class="sc">+</span> </span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">geom =</span> <span class="st">"errorbar"</span>,</span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span> </span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">10</span>,<span class="dv">60</span>) <span class="sc">+</span>  </span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MOEA_XGB_Internal_turning_PEEK_files/figure-html/unnamed-chunk-54-3.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Kruskal-Wallis test to compare Ront models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(MSE <span class="sc">~</span> method, res.teste_Ront)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  MSE by method
Kruskal-Wallis chi-squared = 1653.2, df = 4, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.wilcox.test</span>(res.teste_Ront<span class="sc">$</span>MSE, res.teste_Ront<span class="sc">$</span>method,</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">p.adjust.method =</span> <span class="st">"BH"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using Wilcoxon rank sum test with continuity correction 

data:  res.teste_Ront$MSE and res.teste_Ront$method 

    bag    gam    rsm    svm   
gam &lt;2e-16 -      -      -     
rsm &lt;2e-16 &lt;2e-16 -      -     
svm &lt;2e-16 &lt;2e-16 &lt;2e-16 -     
xgb 0.19   &lt;2e-16 &lt;2e-16 &lt;2e-16

P value adjustment method: BH </code></pre>
</div>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(MAE <span class="sc">~</span> method, res.teste_Ront)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  MAE by method
Kruskal-Wallis chi-squared = 1901.4, df = 4, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.wilcox.test</span>(res.teste_Ront<span class="sc">$</span>MAE, res.teste_Ront<span class="sc">$</span>method,</span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">p.adjust.method =</span> <span class="st">"BH"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using Wilcoxon rank sum test with continuity correction 

data:  res.teste_Ront$MAE and res.teste_Ront$method 

    bag     gam     rsm     svm    
gam &lt; 2e-16 -       -       -      
rsm &lt; 2e-16 &lt; 2e-16 -       -      
svm &lt; 2e-16 &lt; 2e-16 &lt; 2e-16 -      
xgb 4.3e-05 &lt; 2e-16 &lt; 2e-16 &lt; 2e-16

P value adjustment method: BH </code></pre>
</div>
</div>
</section>
</section>
<section id="model-interpretation" class="level2">
<h2 class="anchored" data-anchor-id="model-interpretation">Model interpretation</h2>
<section id="ra-xgb-model-plots" class="level3">
<h3 class="anchored" data-anchor-id="ra-xgb-model-plots">Ra XGB model plots</h3>
<p>Main effects plots:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>x1_grid_Ra <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(plan_respostas<span class="sc">$</span>x1), <span class="fu">max</span>(plan_respostas<span class="sc">$</span>x1), <span class="fl">0.1</span>)</span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>p1_Ra <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span>        </span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Ra, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Ra, </span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(x1_grid_Ra, </span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ra)), </span>
<span id="cb213-7"><a href="#cb213-7" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ra))),</span>
<span id="cb213-8"><a href="#cb213-8" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Ra), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb213-9"><a href="#cb213-9" aria-hidden="true" tabindex="-1"></a>                                                               )))),</span>
<span id="cb213-10"><a href="#cb213-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">'cadetblue4'</span>) <span class="sc">+</span></span>
<span id="cb213-11"><a href="#cb213-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Ra vs vc'</span>) <span class="sc">+</span></span>
<span id="cb213-12"><a href="#cb213-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'vc'</span>) <span class="sc">+</span></span>
<span id="cb213-13"><a href="#cb213-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Ra'</span>) <span class="sc">+</span> </span>
<span id="cb213-14"><a href="#cb213-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">1</span>,<span class="dv">7</span>) <span class="sc">+</span> </span>
<span id="cb213-15"><a href="#cb213-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.68</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">1.68</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="dv">107</span>, <span class="dv">165</span>, <span class="dv">250</span>, <span class="dv">335</span>, <span class="dv">393</span>)) <span class="sc">+</span> </span>
<span id="cb213-16"><a href="#cb213-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb213-17"><a href="#cb213-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-18"><a href="#cb213-18" aria-hidden="true" tabindex="-1"></a>p2_Ra <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span>        </span>
<span id="cb213-19"><a href="#cb213-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Ra, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Ra, </span>
<span id="cb213-20"><a href="#cb213-20" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ra)), </span>
<span id="cb213-21"><a href="#cb213-21" aria-hidden="true" tabindex="-1"></a>                                                                 x1_grid_Ra, </span>
<span id="cb213-22"><a href="#cb213-22" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ra))),</span>
<span id="cb213-23"><a href="#cb213-23" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Ra), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb213-24"><a href="#cb213-24" aria-hidden="true" tabindex="-1"></a>                                                               )))),</span>
<span id="cb213-25"><a href="#cb213-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">'cadetblue4'</span>) <span class="sc">+</span></span>
<span id="cb213-26"><a href="#cb213-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Ra vs f'</span>) <span class="sc">+</span></span>
<span id="cb213-27"><a href="#cb213-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'f'</span>) <span class="sc">+</span></span>
<span id="cb213-28"><a href="#cb213-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Ra'</span>) <span class="sc">+</span> </span>
<span id="cb213-29"><a href="#cb213-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">1</span>,<span class="dv">7</span>) <span class="sc">+</span> </span>
<span id="cb213-30"><a href="#cb213-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.68</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">1.68</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="fl">0.058</span>, <span class="fl">0.085</span>, <span class="fl">0.125</span>, <span class="fl">0.165</span>, <span class="fl">0.192</span>)) <span class="sc">+</span> </span>
<span id="cb213-31"><a href="#cb213-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb213-32"><a href="#cb213-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-33"><a href="#cb213-33" aria-hidden="true" tabindex="-1"></a>p3_Ra <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span>        </span>
<span id="cb213-34"><a href="#cb213-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Ra, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Ra, </span>
<span id="cb213-35"><a href="#cb213-35" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ra)), </span>
<span id="cb213-36"><a href="#cb213-36" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ra)),</span>
<span id="cb213-37"><a href="#cb213-37" aria-hidden="true" tabindex="-1"></a>                                                                 x1_grid_Ra),</span>
<span id="cb213-38"><a href="#cb213-38" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Ra), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb213-39"><a href="#cb213-39" aria-hidden="true" tabindex="-1"></a>                                              )))),</span>
<span id="cb213-40"><a href="#cb213-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">'cadetblue4'</span>) <span class="sc">+</span></span>
<span id="cb213-41"><a href="#cb213-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Ra vs fp'</span>) <span class="sc">+</span></span>
<span id="cb213-42"><a href="#cb213-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'fp'</span>) <span class="sc">+</span></span>
<span id="cb213-43"><a href="#cb213-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Ra'</span>) <span class="sc">+</span> </span>
<span id="cb213-44"><a href="#cb213-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">1</span>,<span class="dv">7</span>) <span class="sc">+</span> </span>
<span id="cb213-45"><a href="#cb213-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.68</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">1.68</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="dv">7</span>, <span class="dv">15</span>, <span class="dv">23</span>, <span class="fl">28.5</span>)) <span class="sc">+</span> </span>
<span id="cb213-46"><a href="#cb213-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb213-47"><a href="#cb213-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-48"><a href="#cb213-48" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(p1_Ra, p2_Ra, p3_Ra, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MOEA_XGB_Internal_turning_PEEK_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Interaction plots:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>pp_12a_Ra <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span>        </span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Ra, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Ra, <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(x1_grid_Ra, </span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a>                                                                          <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ra)), </span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a>                                                                          <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ra))),</span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Ra), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb214-6"><a href="#cb214-6" aria-hidden="true" tabindex="-1"></a>  ))),</span>
<span id="cb214-7"><a href="#cb214-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">'0.125'</span>, <span class="at">linetype =</span> <span class="st">'0.125'</span>)) <span class="sc">+</span></span>
<span id="cb214-8"><a href="#cb214-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Ra vs vc,f'</span>) <span class="sc">+</span></span>
<span id="cb214-9"><a href="#cb214-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'vc'</span>) <span class="sc">+</span></span>
<span id="cb214-10"><a href="#cb214-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Ra'</span>) <span class="sc">+</span> </span>
<span id="cb214-11"><a href="#cb214-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">1</span>,<span class="dv">7</span>) <span class="sc">+</span> </span>
<span id="cb214-12"><a href="#cb214-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.68</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">1.68</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="dv">107</span>, <span class="dv">165</span>, <span class="dv">250</span>, <span class="dv">335</span>, <span class="dv">393</span>)) <span class="sc">+</span> </span>
<span id="cb214-13"><a href="#cb214-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb214-14"><a href="#cb214-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-15"><a href="#cb214-15" aria-hidden="true" tabindex="-1"></a>pp_12_Ra <span class="ot">&lt;-</span> pp_12a_Ra <span class="sc">+</span> </span>
<span id="cb214-16"><a href="#cb214-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Ra, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Ra, <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(x1_grid_Ra, </span>
<span id="cb214-17"><a href="#cb214-17" aria-hidden="true" tabindex="-1"></a>                                                                          <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fu">length</span>(x1_grid_Ra)), </span>
<span id="cb214-18"><a href="#cb214-18" aria-hidden="true" tabindex="-1"></a>                                                                          <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ra))),</span>
<span id="cb214-19"><a href="#cb214-19" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Ra), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb214-20"><a href="#cb214-20" aria-hidden="true" tabindex="-1"></a>  ))),</span>
<span id="cb214-21"><a href="#cb214-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">'0.085'</span>, <span class="at">linetype =</span> <span class="st">'0.085'</span>)) <span class="sc">+</span></span>
<span id="cb214-22"><a href="#cb214-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Ra, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Ra, <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(x1_grid_Ra, </span>
<span id="cb214-23"><a href="#cb214-23" aria-hidden="true" tabindex="-1"></a>                                                                          <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(x1_grid_Ra)), </span>
<span id="cb214-24"><a href="#cb214-24" aria-hidden="true" tabindex="-1"></a>                                                                          <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ra))),</span>
<span id="cb214-25"><a href="#cb214-25" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Ra), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb214-26"><a href="#cb214-26" aria-hidden="true" tabindex="-1"></a>  ))),</span>
<span id="cb214-27"><a href="#cb214-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">'0.165'</span>, <span class="at">linetype =</span> <span class="st">'0.165'</span>)) <span class="sc">+</span> </span>
<span id="cb214-28"><a href="#cb214-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"f"</span>, </span>
<span id="cb214-29"><a href="#cb214-29" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"0.085"</span> <span class="ot">=</span> <span class="st">"orange2"</span>, </span>
<span id="cb214-30"><a href="#cb214-30" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"0.125"</span> <span class="ot">=</span> <span class="st">"olivedrab3"</span>, </span>
<span id="cb214-31"><a href="#cb214-31" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"0.165"</span> <span class="ot">=</span> <span class="st">"mediumvioletred"</span>)) <span class="sc">+</span> </span>
<span id="cb214-32"><a href="#cb214-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">name =</span> <span class="st">"f"</span>, </span>
<span id="cb214-33"><a href="#cb214-33" aria-hidden="true" tabindex="-1"></a>                        <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"0.085"</span> <span class="ot">=</span> <span class="st">"dashed"</span>, </span>
<span id="cb214-34"><a href="#cb214-34" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"0.125"</span> <span class="ot">=</span> <span class="st">"longdash"</span>, </span>
<span id="cb214-35"><a href="#cb214-35" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"0.165"</span> <span class="ot">=</span> <span class="st">"solid"</span>))</span>
<span id="cb214-36"><a href="#cb214-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-37"><a href="#cb214-37" aria-hidden="true" tabindex="-1"></a>pp_13a_Ra <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span>        </span>
<span id="cb214-38"><a href="#cb214-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Ra, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Ra, <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(x1_grid_Ra, </span>
<span id="cb214-39"><a href="#cb214-39" aria-hidden="true" tabindex="-1"></a>                                                                          <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ra)), </span>
<span id="cb214-40"><a href="#cb214-40" aria-hidden="true" tabindex="-1"></a>                                                                          <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ra))),</span>
<span id="cb214-41"><a href="#cb214-41" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Ra), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb214-42"><a href="#cb214-42" aria-hidden="true" tabindex="-1"></a>  ))),</span>
<span id="cb214-43"><a href="#cb214-43" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">'15'</span>, <span class="at">linetype =</span> <span class="st">'15'</span>)) <span class="sc">+</span></span>
<span id="cb214-44"><a href="#cb214-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Ra vs vc,fp'</span>) <span class="sc">+</span></span>
<span id="cb214-45"><a href="#cb214-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'vc'</span>) <span class="sc">+</span></span>
<span id="cb214-46"><a href="#cb214-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Ra'</span>) <span class="sc">+</span> </span>
<span id="cb214-47"><a href="#cb214-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">1</span>,<span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb214-48"><a href="#cb214-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.68</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">1.68</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="dv">107</span>, <span class="dv">165</span>, <span class="dv">250</span>, <span class="dv">335</span>, <span class="dv">393</span>)) <span class="sc">+</span> </span>
<span id="cb214-49"><a href="#cb214-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb214-50"><a href="#cb214-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-51"><a href="#cb214-51" aria-hidden="true" tabindex="-1"></a>pp_13_Ra <span class="ot">&lt;-</span> pp_13a_Ra <span class="sc">+</span> </span>
<span id="cb214-52"><a href="#cb214-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Ra, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Ra, </span>
<span id="cb214-53"><a href="#cb214-53" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(x1_grid_Ra, </span>
<span id="cb214-54"><a href="#cb214-54" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ra)), </span>
<span id="cb214-55"><a href="#cb214-55" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fu">length</span>(x1_grid_Ra))),</span>
<span id="cb214-56"><a href="#cb214-56" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Ra), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb214-57"><a href="#cb214-57" aria-hidden="true" tabindex="-1"></a>                                              ))),</span>
<span id="cb214-58"><a href="#cb214-58" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">'7'</span>, <span class="at">linetype =</span> <span class="st">'7'</span>)) <span class="sc">+</span></span>
<span id="cb214-59"><a href="#cb214-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Ra, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Ra, </span>
<span id="cb214-60"><a href="#cb214-60" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(x1_grid_Ra, </span>
<span id="cb214-61"><a href="#cb214-61" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ra)), </span>
<span id="cb214-62"><a href="#cb214-62" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(x1_grid_Ra))),</span>
<span id="cb214-63"><a href="#cb214-63" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Ra), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb214-64"><a href="#cb214-64" aria-hidden="true" tabindex="-1"></a>                                              ))),</span>
<span id="cb214-65"><a href="#cb214-65" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">'23'</span>, <span class="at">linetype =</span> <span class="st">'23'</span>)) <span class="sc">+</span> </span>
<span id="cb214-66"><a href="#cb214-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"fp"</span>, </span>
<span id="cb214-67"><a href="#cb214-67" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"7"</span> <span class="ot">=</span> <span class="st">"orange2"</span>, </span>
<span id="cb214-68"><a href="#cb214-68" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"15"</span> <span class="ot">=</span> <span class="st">"olivedrab3"</span>, </span>
<span id="cb214-69"><a href="#cb214-69" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"23"</span> <span class="ot">=</span> <span class="st">"mediumvioletred"</span>)) <span class="sc">+</span> </span>
<span id="cb214-70"><a href="#cb214-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">name =</span> <span class="st">"fp"</span>, </span>
<span id="cb214-71"><a href="#cb214-71" aria-hidden="true" tabindex="-1"></a>                        <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"7"</span> <span class="ot">=</span> <span class="st">"dashed"</span>, </span>
<span id="cb214-72"><a href="#cb214-72" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"15"</span> <span class="ot">=</span> <span class="st">"longdash"</span>, </span>
<span id="cb214-73"><a href="#cb214-73" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"23"</span> <span class="ot">=</span> <span class="st">"solid"</span>))</span>
<span id="cb214-74"><a href="#cb214-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-75"><a href="#cb214-75" aria-hidden="true" tabindex="-1"></a>pp_23a_Ra <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span>        </span>
<span id="cb214-76"><a href="#cb214-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Ra, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Ra, <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ra)),</span>
<span id="cb214-77"><a href="#cb214-77" aria-hidden="true" tabindex="-1"></a>                                                                          x1_grid_Ra, </span>
<span id="cb214-78"><a href="#cb214-78" aria-hidden="true" tabindex="-1"></a>                                                                          <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ra))),</span>
<span id="cb214-79"><a href="#cb214-79" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Ra), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb214-80"><a href="#cb214-80" aria-hidden="true" tabindex="-1"></a>  ))),</span>
<span id="cb214-81"><a href="#cb214-81" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">'15'</span>, <span class="at">linetype =</span> <span class="st">'15'</span>)) <span class="sc">+</span></span>
<span id="cb214-82"><a href="#cb214-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Ra vs f,fp'</span>) <span class="sc">+</span></span>
<span id="cb214-83"><a href="#cb214-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'f'</span>) <span class="sc">+</span></span>
<span id="cb214-84"><a href="#cb214-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Ra'</span>) <span class="sc">+</span> </span>
<span id="cb214-85"><a href="#cb214-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">1</span>,<span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb214-86"><a href="#cb214-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.68</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">1.68</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="fl">0.058</span>, <span class="fl">0.085</span>, <span class="fl">0.125</span>, <span class="fl">0.165</span>, <span class="fl">0.192</span>)) <span class="sc">+</span> </span>
<span id="cb214-87"><a href="#cb214-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb214-88"><a href="#cb214-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-89"><a href="#cb214-89" aria-hidden="true" tabindex="-1"></a>pp_23_Ra <span class="ot">&lt;-</span> pp_23a_Ra <span class="sc">+</span> </span>
<span id="cb214-90"><a href="#cb214-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Ra, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Ra, </span>
<span id="cb214-91"><a href="#cb214-91" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ra)),</span>
<span id="cb214-92"><a href="#cb214-92" aria-hidden="true" tabindex="-1"></a>                                                                 x1_grid_Ra, </span>
<span id="cb214-93"><a href="#cb214-93" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fu">length</span>(x1_grid_Ra))),</span>
<span id="cb214-94"><a href="#cb214-94" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Ra), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb214-95"><a href="#cb214-95" aria-hidden="true" tabindex="-1"></a>                                              ))),</span>
<span id="cb214-96"><a href="#cb214-96" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">'7'</span>, <span class="at">linetype =</span> <span class="st">'7'</span>)) <span class="sc">+</span></span>
<span id="cb214-97"><a href="#cb214-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Ra, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Ra, </span>
<span id="cb214-98"><a href="#cb214-98" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ra)),</span>
<span id="cb214-99"><a href="#cb214-99" aria-hidden="true" tabindex="-1"></a>                                                                 x1_grid_Ra, </span>
<span id="cb214-100"><a href="#cb214-100" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(x1_grid_Ra))),</span>
<span id="cb214-101"><a href="#cb214-101" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Ra), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb214-102"><a href="#cb214-102" aria-hidden="true" tabindex="-1"></a>                                              ))),</span>
<span id="cb214-103"><a href="#cb214-103" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">'23'</span>, <span class="at">linetype =</span> <span class="st">'23'</span>)) <span class="sc">+</span> </span>
<span id="cb214-104"><a href="#cb214-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"fp"</span>, </span>
<span id="cb214-105"><a href="#cb214-105" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"7"</span> <span class="ot">=</span> <span class="st">"orange2"</span>, </span>
<span id="cb214-106"><a href="#cb214-106" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"15"</span> <span class="ot">=</span> <span class="st">"olivedrab3"</span>, </span>
<span id="cb214-107"><a href="#cb214-107" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"23"</span> <span class="ot">=</span> <span class="st">"mediumvioletred"</span>)) <span class="sc">+</span> </span>
<span id="cb214-108"><a href="#cb214-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">name =</span> <span class="st">"fp"</span>, </span>
<span id="cb214-109"><a href="#cb214-109" aria-hidden="true" tabindex="-1"></a>                        <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"7"</span> <span class="ot">=</span> <span class="st">"dashed"</span>, </span>
<span id="cb214-110"><a href="#cb214-110" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"15"</span> <span class="ot">=</span> <span class="st">"longdash"</span>, </span>
<span id="cb214-111"><a href="#cb214-111" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"23"</span> <span class="ot">=</span> <span class="st">"solid"</span>))</span>
<span id="cb214-112"><a href="#cb214-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-113"><a href="#cb214-113" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(pp_12_Ra, pp_13_Ra, pp_23_Ra, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MOEA_XGB_Internal_turning_PEEK_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Contour plots:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>x1grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(plan_respostas<span class="sc">$</span>x1), <span class="fu">max</span>(plan_respostas<span class="sc">$</span>x1), <span class="fl">0.05</span>)</span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">x1 =</span> x1grid,</span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x2 =</span> x1grid,</span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x3 =</span> <span class="dv">0</span>)</span>
<span id="cb215-6"><a href="#cb215-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-7"><a href="#cb215-7" aria-hidden="true" tabindex="-1"></a>y_hat_xgb <span class="ot">&lt;-</span> <span class="fu">predict</span>(xgb_Ra, <span class="at">newdata =</span> <span class="fu">as.matrix</span>(grid))</span>
<span id="cb215-8"><a href="#cb215-8" aria-hidden="true" tabindex="-1"></a>grid<span class="sc">$</span>Ra <span class="ot">&lt;-</span> y_hat_xgb</span>
<span id="cb215-9"><a href="#cb215-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-10"><a href="#cb215-10" aria-hidden="true" tabindex="-1"></a>cp1_xgb <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> grid,</span>
<span id="cb215-11"><a href="#cb215-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">z =</span> Ra, <span class="at">fill =</span> Ra)) <span class="sc">+</span></span>
<span id="cb215-12"><a href="#cb215-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb215-13"><a href="#cb215-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"Spectral"</span>,</span>
<span id="cb215-14"><a href="#cb215-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb215-15"><a href="#cb215-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">color =</span> <span class="st">"gray50"</span> , <span class="at">bins =</span> <span class="dv">10</span>) <span class="sc">+</span> </span>
<span id="cb215-16"><a href="#cb215-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="dv">165</span>, <span class="dv">250</span>, <span class="dv">335</span>)) <span class="sc">+</span> </span>
<span id="cb215-17"><a href="#cb215-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="fl">0.085</span>, <span class="fl">0.125</span>, <span class="fl">0.165</span>)) <span class="sc">+</span> </span>
<span id="cb215-18"><a href="#cb215-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"vc"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"f"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb215-19"><a href="#cb215-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-20"><a href="#cb215-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-21"><a href="#cb215-21" aria-hidden="true" tabindex="-1"></a>grid2 <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">x1 =</span> x1grid,</span>
<span id="cb215-22"><a href="#cb215-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x2 =</span> <span class="dv">0</span>,</span>
<span id="cb215-23"><a href="#cb215-23" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x3 =</span> x1grid)</span>
<span id="cb215-24"><a href="#cb215-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-25"><a href="#cb215-25" aria-hidden="true" tabindex="-1"></a>y_hat_xgb2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(xgb_Ra, <span class="at">newdata =</span> <span class="fu">as.matrix</span>(grid2))</span>
<span id="cb215-26"><a href="#cb215-26" aria-hidden="true" tabindex="-1"></a>grid2<span class="sc">$</span>Ra <span class="ot">&lt;-</span> y_hat_xgb2</span>
<span id="cb215-27"><a href="#cb215-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-28"><a href="#cb215-28" aria-hidden="true" tabindex="-1"></a>cp2_xgb <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> grid2,</span>
<span id="cb215-29"><a href="#cb215-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x3, <span class="at">z =</span> Ra, <span class="at">fill =</span> Ra)) <span class="sc">+</span></span>
<span id="cb215-30"><a href="#cb215-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb215-31"><a href="#cb215-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"Spectral"</span>,</span>
<span id="cb215-32"><a href="#cb215-32" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb215-33"><a href="#cb215-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">bins =</span> <span class="dv">10</span>) <span class="sc">+</span> </span>
<span id="cb215-34"><a href="#cb215-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="dv">165</span>, <span class="dv">250</span>, <span class="dv">335</span>)) <span class="sc">+</span> </span>
<span id="cb215-35"><a href="#cb215-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">15</span>, <span class="dv">23</span>)) <span class="sc">+</span> </span>
<span id="cb215-36"><a href="#cb215-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"vc"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"fp"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb215-37"><a href="#cb215-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-38"><a href="#cb215-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-39"><a href="#cb215-39" aria-hidden="true" tabindex="-1"></a>grid3 <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">x1 =</span> <span class="dv">0</span>,</span>
<span id="cb215-40"><a href="#cb215-40" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x2 =</span> x1grid,</span>
<span id="cb215-41"><a href="#cb215-41" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x3 =</span> x1grid)</span>
<span id="cb215-42"><a href="#cb215-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-43"><a href="#cb215-43" aria-hidden="true" tabindex="-1"></a>y_hat_xgb3 <span class="ot">&lt;-</span> <span class="fu">predict</span>(xgb_Ra, <span class="at">newdata =</span> <span class="fu">as.matrix</span>(grid3))</span>
<span id="cb215-44"><a href="#cb215-44" aria-hidden="true" tabindex="-1"></a>grid3<span class="sc">$</span>Ra <span class="ot">&lt;-</span> y_hat_xgb3</span>
<span id="cb215-45"><a href="#cb215-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-46"><a href="#cb215-46" aria-hidden="true" tabindex="-1"></a>cp3_xgb <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> grid3,</span>
<span id="cb215-47"><a href="#cb215-47" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x2, <span class="at">y =</span> x3, <span class="at">z =</span> Ra, <span class="at">fill =</span> Ra)) <span class="sc">+</span></span>
<span id="cb215-48"><a href="#cb215-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb215-49"><a href="#cb215-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"Spectral"</span>,</span>
<span id="cb215-50"><a href="#cb215-50" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb215-51"><a href="#cb215-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">bins =</span> <span class="dv">10</span>) <span class="sc">+</span> </span>
<span id="cb215-52"><a href="#cb215-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="fl">0.085</span>, <span class="fl">0.125</span>, <span class="fl">0.165</span>)) <span class="sc">+</span> </span>
<span id="cb215-53"><a href="#cb215-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">15</span>, <span class="dv">23</span>)) <span class="sc">+</span> </span>
<span id="cb215-54"><a href="#cb215-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"f"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"fp"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb215-55"><a href="#cb215-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-56"><a href="#cb215-56" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(cp1_xgb, cp2_xgb, cp3_xgb, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MOEA_XGB_Internal_turning_PEEK_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Feature importance plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>importance_matrix_Ra <span class="ot">&lt;-</span> <span class="fu">xgb.importance</span>(<span class="fu">colnames</span>(plan_respostas[,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>]), <span class="at">model =</span> xgb_Ra)</span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(importance_matrix_Ra, <span class="fu">aes</span>(<span class="at">x=</span> <span class="fu">reorder</span>(Feature, Gain), <span class="at">y =</span> Gain)) <span class="sc">+</span></span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"pink4"</span>, <span class="at">fill =</span> <span class="st">"pink"</span>) <span class="sc">+</span> </span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Importance"</span>, <span class="at">x =</span> <span class="st">"Feature"</span>) <span class="sc">+</span> </span>
<span id="cb216-6"><a href="#cb216-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"fp"</span>, <span class="st">"vc"</span>, <span class="st">"f"</span>)) <span class="sc">+</span></span>
<span id="cb216-7"><a href="#cb216-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb216-8"><a href="#cb216-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MOEA_XGB_Internal_turning_PEEK_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
<section id="fc-xgb-model-plots" class="level3">
<h3 class="anchored" data-anchor-id="fc-xgb-model-plots">Fc XGB model plots</h3>
<p>Main effects plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>x1_grid_Fc <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(plan_respostas<span class="sc">$</span>x1), <span class="fu">max</span>(plan_respostas<span class="sc">$</span>x1), <span class="fl">0.1</span>)</span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>p1_Fc <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span>        </span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Fc, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Fc, </span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(x1_grid_Fc, </span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Fc)), </span>
<span id="cb217-7"><a href="#cb217-7" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Fc))),</span>
<span id="cb217-8"><a href="#cb217-8" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Fc), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb217-9"><a href="#cb217-9" aria-hidden="true" tabindex="-1"></a>                                                               )))),</span>
<span id="cb217-10"><a href="#cb217-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">'cadetblue4'</span>) <span class="sc">+</span></span>
<span id="cb217-11"><a href="#cb217-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Fc vs vc'</span>) <span class="sc">+</span></span>
<span id="cb217-12"><a href="#cb217-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'vc'</span>) <span class="sc">+</span></span>
<span id="cb217-13"><a href="#cb217-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Fc'</span>) <span class="sc">+</span> </span>
<span id="cb217-14"><a href="#cb217-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">24</span>,<span class="dv">48</span>) <span class="sc">+</span> </span>
<span id="cb217-15"><a href="#cb217-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.68</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">1.68</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="dv">107</span>, <span class="dv">165</span>, <span class="dv">250</span>, <span class="dv">335</span>, <span class="dv">393</span>)) <span class="sc">+</span> </span>
<span id="cb217-16"><a href="#cb217-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb217-17"><a href="#cb217-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-18"><a href="#cb217-18" aria-hidden="true" tabindex="-1"></a>p2_Fc <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span>        </span>
<span id="cb217-19"><a href="#cb217-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Fc, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Fc, </span>
<span id="cb217-20"><a href="#cb217-20" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Fc)), </span>
<span id="cb217-21"><a href="#cb217-21" aria-hidden="true" tabindex="-1"></a>                                                                 x1_grid_Fc, </span>
<span id="cb217-22"><a href="#cb217-22" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Fc))),</span>
<span id="cb217-23"><a href="#cb217-23" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Fc), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb217-24"><a href="#cb217-24" aria-hidden="true" tabindex="-1"></a>                                                               )))),</span>
<span id="cb217-25"><a href="#cb217-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">'cadetblue4'</span>) <span class="sc">+</span></span>
<span id="cb217-26"><a href="#cb217-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Fc vs f'</span>) <span class="sc">+</span></span>
<span id="cb217-27"><a href="#cb217-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'f'</span>) <span class="sc">+</span></span>
<span id="cb217-28"><a href="#cb217-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Fc'</span>) <span class="sc">+</span> </span>
<span id="cb217-29"><a href="#cb217-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">24</span>,<span class="dv">48</span>) <span class="sc">+</span> </span>
<span id="cb217-30"><a href="#cb217-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.68</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">1.68</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="fl">0.058</span>, <span class="fl">0.085</span>, <span class="fl">0.125</span>, <span class="fl">0.165</span>, <span class="fl">0.192</span>)) <span class="sc">+</span> </span>
<span id="cb217-31"><a href="#cb217-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb217-32"><a href="#cb217-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-33"><a href="#cb217-33" aria-hidden="true" tabindex="-1"></a>p3_Fc <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span>        </span>
<span id="cb217-34"><a href="#cb217-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Fc, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Fc, </span>
<span id="cb217-35"><a href="#cb217-35" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Fc)), </span>
<span id="cb217-36"><a href="#cb217-36" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Fc)),</span>
<span id="cb217-37"><a href="#cb217-37" aria-hidden="true" tabindex="-1"></a>                                                                 x1_grid_Fc),</span>
<span id="cb217-38"><a href="#cb217-38" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Fc), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb217-39"><a href="#cb217-39" aria-hidden="true" tabindex="-1"></a>                                              )))),</span>
<span id="cb217-40"><a href="#cb217-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">'cadetblue4'</span>) <span class="sc">+</span></span>
<span id="cb217-41"><a href="#cb217-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Fc vs fp'</span>) <span class="sc">+</span></span>
<span id="cb217-42"><a href="#cb217-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'fp'</span>) <span class="sc">+</span></span>
<span id="cb217-43"><a href="#cb217-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Fc'</span>) <span class="sc">+</span> </span>
<span id="cb217-44"><a href="#cb217-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">24</span>,<span class="dv">48</span>) <span class="sc">+</span> </span>
<span id="cb217-45"><a href="#cb217-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.68</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">1.68</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="dv">7</span>, <span class="dv">15</span>, <span class="dv">23</span>, <span class="fl">28.5</span>)) <span class="sc">+</span> </span>
<span id="cb217-46"><a href="#cb217-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb217-47"><a href="#cb217-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-48"><a href="#cb217-48" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(p1_Fc, p2_Fc, p3_Fc, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MOEA_XGB_Internal_turning_PEEK_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Interaction plots:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>pp_12a_Fc <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span>        </span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Fc, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Fc, <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(x1_grid_Fc, </span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>                                                                          <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Fc)), </span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a>                                                                          <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Fc))),</span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Fc), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true" tabindex="-1"></a>  ))),</span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">'0.125'</span>, <span class="at">linetype =</span> <span class="st">'0.125'</span>)) <span class="sc">+</span></span>
<span id="cb218-8"><a href="#cb218-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Fc vs vc,f'</span>) <span class="sc">+</span></span>
<span id="cb218-9"><a href="#cb218-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'vc'</span>) <span class="sc">+</span></span>
<span id="cb218-10"><a href="#cb218-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Fc'</span>) <span class="sc">+</span> </span>
<span id="cb218-11"><a href="#cb218-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">24</span>,<span class="dv">48</span>) <span class="sc">+</span> </span>
<span id="cb218-12"><a href="#cb218-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.68</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">1.68</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="dv">107</span>, <span class="dv">165</span>, <span class="dv">250</span>, <span class="dv">335</span>, <span class="dv">393</span>)) <span class="sc">+</span> </span>
<span id="cb218-13"><a href="#cb218-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb218-14"><a href="#cb218-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-15"><a href="#cb218-15" aria-hidden="true" tabindex="-1"></a>pp_12_Fc <span class="ot">&lt;-</span> pp_12a_Fc <span class="sc">+</span> </span>
<span id="cb218-16"><a href="#cb218-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Fc, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Fc, <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(x1_grid_Fc, </span>
<span id="cb218-17"><a href="#cb218-17" aria-hidden="true" tabindex="-1"></a>                                                                          <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fu">length</span>(x1_grid_Fc)), </span>
<span id="cb218-18"><a href="#cb218-18" aria-hidden="true" tabindex="-1"></a>                                                                          <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Fc))),</span>
<span id="cb218-19"><a href="#cb218-19" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Fc), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb218-20"><a href="#cb218-20" aria-hidden="true" tabindex="-1"></a>  ))),</span>
<span id="cb218-21"><a href="#cb218-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">'0.085'</span>, <span class="at">linetype =</span> <span class="st">'0.085'</span>)) <span class="sc">+</span></span>
<span id="cb218-22"><a href="#cb218-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Fc, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Fc, <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(x1_grid_Fc, </span>
<span id="cb218-23"><a href="#cb218-23" aria-hidden="true" tabindex="-1"></a>                                                                          <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(x1_grid_Fc)), </span>
<span id="cb218-24"><a href="#cb218-24" aria-hidden="true" tabindex="-1"></a>                                                                          <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Fc))),</span>
<span id="cb218-25"><a href="#cb218-25" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Fc), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb218-26"><a href="#cb218-26" aria-hidden="true" tabindex="-1"></a>  ))),</span>
<span id="cb218-27"><a href="#cb218-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">'0.165'</span>, <span class="at">linetype =</span> <span class="st">'0.165'</span>)) <span class="sc">+</span> </span>
<span id="cb218-28"><a href="#cb218-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"f"</span>, </span>
<span id="cb218-29"><a href="#cb218-29" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"0.085"</span> <span class="ot">=</span> <span class="st">"orange2"</span>, </span>
<span id="cb218-30"><a href="#cb218-30" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"0.125"</span> <span class="ot">=</span> <span class="st">"olivedrab3"</span>, </span>
<span id="cb218-31"><a href="#cb218-31" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"0.165"</span> <span class="ot">=</span> <span class="st">"mediumvioletred"</span>)) <span class="sc">+</span> </span>
<span id="cb218-32"><a href="#cb218-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">name =</span> <span class="st">"f"</span>, </span>
<span id="cb218-33"><a href="#cb218-33" aria-hidden="true" tabindex="-1"></a>                        <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"0.085"</span> <span class="ot">=</span> <span class="st">"dashed"</span>, </span>
<span id="cb218-34"><a href="#cb218-34" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"0.125"</span> <span class="ot">=</span> <span class="st">"longdash"</span>, </span>
<span id="cb218-35"><a href="#cb218-35" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"0.165"</span> <span class="ot">=</span> <span class="st">"solid"</span>))</span>
<span id="cb218-36"><a href="#cb218-36" aria-hidden="true" tabindex="-1"></a><span class="co"># vc vs fp</span></span>
<span id="cb218-37"><a href="#cb218-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-38"><a href="#cb218-38" aria-hidden="true" tabindex="-1"></a>pp_13a_Fc <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span>        </span>
<span id="cb218-39"><a href="#cb218-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Fc, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Fc, <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(x1_grid_Fc, </span>
<span id="cb218-40"><a href="#cb218-40" aria-hidden="true" tabindex="-1"></a>                                                                          <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Fc)), </span>
<span id="cb218-41"><a href="#cb218-41" aria-hidden="true" tabindex="-1"></a>                                                                          <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Fc))),</span>
<span id="cb218-42"><a href="#cb218-42" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Fc), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb218-43"><a href="#cb218-43" aria-hidden="true" tabindex="-1"></a>  ))),</span>
<span id="cb218-44"><a href="#cb218-44" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">'15'</span>, <span class="at">linetype =</span> <span class="st">'15'</span>)) <span class="sc">+</span></span>
<span id="cb218-45"><a href="#cb218-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Fc vs vc,fp'</span>) <span class="sc">+</span></span>
<span id="cb218-46"><a href="#cb218-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'vc'</span>) <span class="sc">+</span></span>
<span id="cb218-47"><a href="#cb218-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Fc'</span>) <span class="sc">+</span> </span>
<span id="cb218-48"><a href="#cb218-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">24</span>,<span class="dv">48</span>) <span class="sc">+</span></span>
<span id="cb218-49"><a href="#cb218-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.68</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">1.68</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="dv">107</span>, <span class="dv">165</span>, <span class="dv">250</span>, <span class="dv">335</span>, <span class="dv">393</span>)) <span class="sc">+</span> </span>
<span id="cb218-50"><a href="#cb218-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb218-51"><a href="#cb218-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-52"><a href="#cb218-52" aria-hidden="true" tabindex="-1"></a>pp_13_Fc <span class="ot">&lt;-</span> pp_13a_Fc <span class="sc">+</span> </span>
<span id="cb218-53"><a href="#cb218-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Fc, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Fc, </span>
<span id="cb218-54"><a href="#cb218-54" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(x1_grid_Fc, </span>
<span id="cb218-55"><a href="#cb218-55" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Fc)), </span>
<span id="cb218-56"><a href="#cb218-56" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fu">length</span>(x1_grid_Fc))),</span>
<span id="cb218-57"><a href="#cb218-57" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Fc), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb218-58"><a href="#cb218-58" aria-hidden="true" tabindex="-1"></a>                                              ))),</span>
<span id="cb218-59"><a href="#cb218-59" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">'7'</span>, <span class="at">linetype =</span> <span class="st">'7'</span>)) <span class="sc">+</span></span>
<span id="cb218-60"><a href="#cb218-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Fc, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Fc, </span>
<span id="cb218-61"><a href="#cb218-61" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(x1_grid_Fc, </span>
<span id="cb218-62"><a href="#cb218-62" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Fc)), </span>
<span id="cb218-63"><a href="#cb218-63" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(x1_grid_Fc))),</span>
<span id="cb218-64"><a href="#cb218-64" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Fc), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb218-65"><a href="#cb218-65" aria-hidden="true" tabindex="-1"></a>                                              ))),</span>
<span id="cb218-66"><a href="#cb218-66" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">'23'</span>, <span class="at">linetype =</span> <span class="st">'23'</span>)) <span class="sc">+</span> </span>
<span id="cb218-67"><a href="#cb218-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"fp"</span>, </span>
<span id="cb218-68"><a href="#cb218-68" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"7"</span> <span class="ot">=</span> <span class="st">"orange2"</span>, </span>
<span id="cb218-69"><a href="#cb218-69" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"15"</span> <span class="ot">=</span> <span class="st">"olivedrab3"</span>, </span>
<span id="cb218-70"><a href="#cb218-70" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"23"</span> <span class="ot">=</span> <span class="st">"mediumvioletred"</span>)) <span class="sc">+</span> </span>
<span id="cb218-71"><a href="#cb218-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">name =</span> <span class="st">"fp"</span>, </span>
<span id="cb218-72"><a href="#cb218-72" aria-hidden="true" tabindex="-1"></a>                        <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"7"</span> <span class="ot">=</span> <span class="st">"dashed"</span>, </span>
<span id="cb218-73"><a href="#cb218-73" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"15"</span> <span class="ot">=</span> <span class="st">"longdash"</span>, </span>
<span id="cb218-74"><a href="#cb218-74" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"23"</span> <span class="ot">=</span> <span class="st">"solid"</span>))</span>
<span id="cb218-75"><a href="#cb218-75" aria-hidden="true" tabindex="-1"></a><span class="co"># f vs fp</span></span>
<span id="cb218-76"><a href="#cb218-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-77"><a href="#cb218-77" aria-hidden="true" tabindex="-1"></a>pp_23a_Fc <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span>        </span>
<span id="cb218-78"><a href="#cb218-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Fc, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Fc, <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Fc)),</span>
<span id="cb218-79"><a href="#cb218-79" aria-hidden="true" tabindex="-1"></a>                                                                          x1_grid_Fc, </span>
<span id="cb218-80"><a href="#cb218-80" aria-hidden="true" tabindex="-1"></a>                                                                          <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Fc))),</span>
<span id="cb218-81"><a href="#cb218-81" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Fc), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb218-82"><a href="#cb218-82" aria-hidden="true" tabindex="-1"></a>  ))),</span>
<span id="cb218-83"><a href="#cb218-83" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">'15'</span>, <span class="at">linetype =</span> <span class="st">'15'</span>)) <span class="sc">+</span></span>
<span id="cb218-84"><a href="#cb218-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Fc vs f,fp'</span>) <span class="sc">+</span></span>
<span id="cb218-85"><a href="#cb218-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'f'</span>) <span class="sc">+</span></span>
<span id="cb218-86"><a href="#cb218-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Fc'</span>) <span class="sc">+</span> </span>
<span id="cb218-87"><a href="#cb218-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">24</span>,<span class="dv">48</span>) <span class="sc">+</span></span>
<span id="cb218-88"><a href="#cb218-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.68</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">1.68</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="fl">0.058</span>, <span class="fl">0.085</span>, <span class="fl">0.125</span>, <span class="fl">0.165</span>, <span class="fl">0.192</span>)) <span class="sc">+</span> </span>
<span id="cb218-89"><a href="#cb218-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb218-90"><a href="#cb218-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-91"><a href="#cb218-91" aria-hidden="true" tabindex="-1"></a>pp_23_Fc <span class="ot">&lt;-</span> pp_23a_Fc <span class="sc">+</span> </span>
<span id="cb218-92"><a href="#cb218-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Fc, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Fc, </span>
<span id="cb218-93"><a href="#cb218-93" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Fc)),</span>
<span id="cb218-94"><a href="#cb218-94" aria-hidden="true" tabindex="-1"></a>                                                                 x1_grid_Fc, </span>
<span id="cb218-95"><a href="#cb218-95" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fu">length</span>(x1_grid_Fc))),</span>
<span id="cb218-96"><a href="#cb218-96" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Fc), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb218-97"><a href="#cb218-97" aria-hidden="true" tabindex="-1"></a>                                              ))),</span>
<span id="cb218-98"><a href="#cb218-98" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">'7'</span>, <span class="at">linetype =</span> <span class="st">'7'</span>)) <span class="sc">+</span></span>
<span id="cb218-99"><a href="#cb218-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Fc, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Fc, </span>
<span id="cb218-100"><a href="#cb218-100" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Fc)),</span>
<span id="cb218-101"><a href="#cb218-101" aria-hidden="true" tabindex="-1"></a>                                                                 x1_grid_Fc, </span>
<span id="cb218-102"><a href="#cb218-102" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(x1_grid_Fc))),</span>
<span id="cb218-103"><a href="#cb218-103" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Fc), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb218-104"><a href="#cb218-104" aria-hidden="true" tabindex="-1"></a>                                              ))),</span>
<span id="cb218-105"><a href="#cb218-105" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">'23'</span>, <span class="at">linetype =</span> <span class="st">'23'</span>)) <span class="sc">+</span> </span>
<span id="cb218-106"><a href="#cb218-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"fp"</span>, </span>
<span id="cb218-107"><a href="#cb218-107" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"7"</span> <span class="ot">=</span> <span class="st">"orange2"</span>, </span>
<span id="cb218-108"><a href="#cb218-108" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"15"</span> <span class="ot">=</span> <span class="st">"olivedrab3"</span>, </span>
<span id="cb218-109"><a href="#cb218-109" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"23"</span> <span class="ot">=</span> <span class="st">"mediumvioletred"</span>)) <span class="sc">+</span> </span>
<span id="cb218-110"><a href="#cb218-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">name =</span> <span class="st">"fp"</span>, </span>
<span id="cb218-111"><a href="#cb218-111" aria-hidden="true" tabindex="-1"></a>                        <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"7"</span> <span class="ot">=</span> <span class="st">"dashed"</span>, </span>
<span id="cb218-112"><a href="#cb218-112" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"15"</span> <span class="ot">=</span> <span class="st">"longdash"</span>, </span>
<span id="cb218-113"><a href="#cb218-113" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"23"</span> <span class="ot">=</span> <span class="st">"solid"</span>))</span>
<span id="cb218-114"><a href="#cb218-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-115"><a href="#cb218-115" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(pp_12_Fc, pp_13_Fc, pp_23_Fc, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MOEA_XGB_Internal_turning_PEEK_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Contour plots:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>x1grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(plan_respostas<span class="sc">$</span>x1), <span class="fu">max</span>(plan_respostas<span class="sc">$</span>x1), <span class="fl">0.05</span>)</span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">x1 =</span> x1grid,</span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x2 =</span> x1grid,</span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x3 =</span> <span class="dv">0</span>)</span>
<span id="cb219-6"><a href="#cb219-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-7"><a href="#cb219-7" aria-hidden="true" tabindex="-1"></a>y_hat_xgb <span class="ot">&lt;-</span> <span class="fu">predict</span>(xgb_Fc, <span class="at">newdata =</span> <span class="fu">as.matrix</span>(grid))</span>
<span id="cb219-8"><a href="#cb219-8" aria-hidden="true" tabindex="-1"></a>grid<span class="sc">$</span>Fc <span class="ot">&lt;-</span> y_hat_xgb</span>
<span id="cb219-9"><a href="#cb219-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-10"><a href="#cb219-10" aria-hidden="true" tabindex="-1"></a>cp1_xgb <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> grid,</span>
<span id="cb219-11"><a href="#cb219-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">z =</span> Fc, <span class="at">fill =</span> Fc)) <span class="sc">+</span></span>
<span id="cb219-12"><a href="#cb219-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb219-13"><a href="#cb219-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"Spectral"</span>,</span>
<span id="cb219-14"><a href="#cb219-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">50</span>)) <span class="sc">+</span></span>
<span id="cb219-15"><a href="#cb219-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">bins =</span> <span class="dv">10</span>) <span class="sc">+</span> </span>
<span id="cb219-16"><a href="#cb219-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="dv">165</span>, <span class="dv">250</span>, <span class="dv">335</span>)) <span class="sc">+</span> </span>
<span id="cb219-17"><a href="#cb219-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="fl">0.085</span>, <span class="fl">0.125</span>, <span class="fl">0.165</span>)) <span class="sc">+</span> </span>
<span id="cb219-18"><a href="#cb219-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"vc"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"f"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb219-19"><a href="#cb219-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-20"><a href="#cb219-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-21"><a href="#cb219-21" aria-hidden="true" tabindex="-1"></a>grid2 <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">x1 =</span> x1grid,</span>
<span id="cb219-22"><a href="#cb219-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x2 =</span> <span class="dv">0</span>,</span>
<span id="cb219-23"><a href="#cb219-23" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x3 =</span> x1grid)</span>
<span id="cb219-24"><a href="#cb219-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-25"><a href="#cb219-25" aria-hidden="true" tabindex="-1"></a>y_hat_xgb2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(xgb_Fc, <span class="at">newdata =</span> <span class="fu">as.matrix</span>(grid2))</span>
<span id="cb219-26"><a href="#cb219-26" aria-hidden="true" tabindex="-1"></a>grid2<span class="sc">$</span>Fc <span class="ot">&lt;-</span> y_hat_xgb2</span>
<span id="cb219-27"><a href="#cb219-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-28"><a href="#cb219-28" aria-hidden="true" tabindex="-1"></a>cp2_xgb <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> grid2,</span>
<span id="cb219-29"><a href="#cb219-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x3, <span class="at">z =</span> Fc, <span class="at">fill =</span> Fc)) <span class="sc">+</span></span>
<span id="cb219-30"><a href="#cb219-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb219-31"><a href="#cb219-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"Spectral"</span>,</span>
<span id="cb219-32"><a href="#cb219-32" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">50</span>)) <span class="sc">+</span></span>
<span id="cb219-33"><a href="#cb219-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">bins =</span> <span class="dv">10</span>) <span class="sc">+</span> </span>
<span id="cb219-34"><a href="#cb219-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="dv">165</span>, <span class="dv">250</span>, <span class="dv">335</span>)) <span class="sc">+</span> </span>
<span id="cb219-35"><a href="#cb219-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">15</span>, <span class="dv">23</span>)) <span class="sc">+</span> </span>
<span id="cb219-36"><a href="#cb219-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"vc"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"fp"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb219-37"><a href="#cb219-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-38"><a href="#cb219-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-39"><a href="#cb219-39" aria-hidden="true" tabindex="-1"></a>grid3 <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">x1 =</span> <span class="dv">0</span>,</span>
<span id="cb219-40"><a href="#cb219-40" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x2 =</span> x1grid,</span>
<span id="cb219-41"><a href="#cb219-41" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x3 =</span> x1grid)</span>
<span id="cb219-42"><a href="#cb219-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-43"><a href="#cb219-43" aria-hidden="true" tabindex="-1"></a>y_hat_xgb3 <span class="ot">&lt;-</span> <span class="fu">predict</span>(xgb_Fc, <span class="at">newdata =</span> <span class="fu">as.matrix</span>(grid3))</span>
<span id="cb219-44"><a href="#cb219-44" aria-hidden="true" tabindex="-1"></a>grid3<span class="sc">$</span>Fc <span class="ot">&lt;-</span> y_hat_xgb3</span>
<span id="cb219-45"><a href="#cb219-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-46"><a href="#cb219-46" aria-hidden="true" tabindex="-1"></a>cp3_xgb <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> grid3,</span>
<span id="cb219-47"><a href="#cb219-47" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x2, <span class="at">y =</span> x3, <span class="at">z =</span> Fc, <span class="at">fill =</span> Fc)) <span class="sc">+</span></span>
<span id="cb219-48"><a href="#cb219-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb219-49"><a href="#cb219-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"Spectral"</span>,</span>
<span id="cb219-50"><a href="#cb219-50" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">50</span>)) <span class="sc">+</span></span>
<span id="cb219-51"><a href="#cb219-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">bins =</span> <span class="dv">10</span>) <span class="sc">+</span> </span>
<span id="cb219-52"><a href="#cb219-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="fl">0.085</span>, <span class="fl">0.125</span>, <span class="fl">0.165</span>)) <span class="sc">+</span> </span>
<span id="cb219-53"><a href="#cb219-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">15</span>, <span class="dv">23</span>)) <span class="sc">+</span> </span>
<span id="cb219-54"><a href="#cb219-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"f"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"fp"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb219-55"><a href="#cb219-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-56"><a href="#cb219-56" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(cp1_xgb, cp2_xgb, cp3_xgb, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MOEA_XGB_Internal_turning_PEEK_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Feature importance plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>importance_matrix_Fc <span class="ot">&lt;-</span> <span class="fu">xgb.importance</span>(<span class="fu">colnames</span>(plan_respostas[,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>]), <span class="at">model =</span> xgb_Fc)</span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(importance_matrix_Fc, <span class="fu">aes</span>(<span class="at">x=</span> <span class="fu">reorder</span>(Feature, Gain), <span class="at">y =</span> Gain)) <span class="sc">+</span></span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"pink4"</span>, <span class="at">fill =</span> <span class="st">"pink"</span>) <span class="sc">+</span> </span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Importance"</span>, <span class="at">x =</span> <span class="st">"Feature"</span>) <span class="sc">+</span> </span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"vc"</span>, <span class="st">"fp"</span>, <span class="st">"f"</span>)) <span class="sc">+</span></span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MOEA_XGB_Internal_turning_PEEK_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
<section id="ront-xgb-model-plots" class="level3">
<h3 class="anchored" data-anchor-id="ront-xgb-model-plots">Ront XGB model plots</h3>
<p>Main effects plots:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>x1_grid_Ront <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(plan_respostas<span class="sc">$</span>x1), <span class="fu">max</span>(plan_respostas<span class="sc">$</span>x1), <span class="fl">0.1</span>)</span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a>p1_Ront <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span>        </span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Ront, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Ront, </span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(x1_grid_Ront, </span>
<span id="cb221-6"><a href="#cb221-6" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ront)), </span>
<span id="cb221-7"><a href="#cb221-7" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ront))),</span>
<span id="cb221-8"><a href="#cb221-8" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Ront), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb221-9"><a href="#cb221-9" aria-hidden="true" tabindex="-1"></a>                                                               )))),</span>
<span id="cb221-10"><a href="#cb221-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">'cadetblue4'</span>) <span class="sc">+</span></span>
<span id="cb221-11"><a href="#cb221-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Ront vs vc'</span>) <span class="sc">+</span></span>
<span id="cb221-12"><a href="#cb221-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'vc'</span>) <span class="sc">+</span></span>
<span id="cb221-13"><a href="#cb221-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Ront'</span>) <span class="sc">+</span> </span>
<span id="cb221-14"><a href="#cb221-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">40</span>,<span class="dv">200</span>) <span class="sc">+</span> </span>
<span id="cb221-15"><a href="#cb221-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.68</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">1.68</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="dv">107</span>, <span class="dv">165</span>, <span class="dv">250</span>, <span class="dv">335</span>, <span class="dv">393</span>)) <span class="sc">+</span> </span>
<span id="cb221-16"><a href="#cb221-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb221-17"><a href="#cb221-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-18"><a href="#cb221-18" aria-hidden="true" tabindex="-1"></a>p2_Ront <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span>        </span>
<span id="cb221-19"><a href="#cb221-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Ront, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Ront, </span>
<span id="cb221-20"><a href="#cb221-20" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ront)), </span>
<span id="cb221-21"><a href="#cb221-21" aria-hidden="true" tabindex="-1"></a>                                                                 x1_grid_Ront, </span>
<span id="cb221-22"><a href="#cb221-22" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ront))),</span>
<span id="cb221-23"><a href="#cb221-23" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Ront), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb221-24"><a href="#cb221-24" aria-hidden="true" tabindex="-1"></a>                                                               )))),</span>
<span id="cb221-25"><a href="#cb221-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">'cadetblue4'</span>) <span class="sc">+</span></span>
<span id="cb221-26"><a href="#cb221-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Ront vs f'</span>) <span class="sc">+</span></span>
<span id="cb221-27"><a href="#cb221-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'f'</span>) <span class="sc">+</span></span>
<span id="cb221-28"><a href="#cb221-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Ront'</span>) <span class="sc">+</span> </span>
<span id="cb221-29"><a href="#cb221-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">40</span>,<span class="dv">200</span>) <span class="sc">+</span> </span>
<span id="cb221-30"><a href="#cb221-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.68</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">1.68</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="fl">0.058</span>, <span class="fl">0.085</span>, <span class="fl">0.125</span>, <span class="fl">0.165</span>, <span class="fl">0.192</span>)) <span class="sc">+</span> </span>
<span id="cb221-31"><a href="#cb221-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb221-32"><a href="#cb221-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-33"><a href="#cb221-33" aria-hidden="true" tabindex="-1"></a>p3_Ront <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span>        </span>
<span id="cb221-34"><a href="#cb221-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Ront, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Ront, </span>
<span id="cb221-35"><a href="#cb221-35" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ront)), </span>
<span id="cb221-36"><a href="#cb221-36" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ront)),</span>
<span id="cb221-37"><a href="#cb221-37" aria-hidden="true" tabindex="-1"></a>                                                                 x1_grid_Ront),</span>
<span id="cb221-38"><a href="#cb221-38" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Ront), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb221-39"><a href="#cb221-39" aria-hidden="true" tabindex="-1"></a>                                              )))),</span>
<span id="cb221-40"><a href="#cb221-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">'cadetblue4'</span>) <span class="sc">+</span></span>
<span id="cb221-41"><a href="#cb221-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Ront vs fp'</span>) <span class="sc">+</span></span>
<span id="cb221-42"><a href="#cb221-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'fp'</span>) <span class="sc">+</span></span>
<span id="cb221-43"><a href="#cb221-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Ront'</span>) <span class="sc">+</span> </span>
<span id="cb221-44"><a href="#cb221-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">40</span>,<span class="dv">200</span>) <span class="sc">+</span> </span>
<span id="cb221-45"><a href="#cb221-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.68</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">1.68</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="dv">7</span>, <span class="dv">15</span>, <span class="dv">23</span>, <span class="fl">28.5</span>)) <span class="sc">+</span> </span>
<span id="cb221-46"><a href="#cb221-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb221-47"><a href="#cb221-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-48"><a href="#cb221-48" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(p1_Ront, p2_Ront, p3_Ront, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MOEA_XGB_Internal_turning_PEEK_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Interaction plots:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>pp_12a_Ront <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span>        </span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Ront, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Ront, <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(x1_grid_Ront, </span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>                                                                          <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ront)), </span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>                                                                          <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ront))),</span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Ront), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a>  ))),</span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">'0.125'</span>, <span class="at">linetype =</span> <span class="st">'0.125'</span>)) <span class="sc">+</span></span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Ront vs vc,f'</span>) <span class="sc">+</span></span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'vc'</span>) <span class="sc">+</span></span>
<span id="cb222-10"><a href="#cb222-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Ront'</span>) <span class="sc">+</span> </span>
<span id="cb222-11"><a href="#cb222-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">40</span>,<span class="dv">200</span>) <span class="sc">+</span> </span>
<span id="cb222-12"><a href="#cb222-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.68</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">1.68</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="dv">107</span>, <span class="dv">165</span>, <span class="dv">250</span>, <span class="dv">335</span>, <span class="dv">393</span>)) <span class="sc">+</span> </span>
<span id="cb222-13"><a href="#cb222-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb222-14"><a href="#cb222-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-15"><a href="#cb222-15" aria-hidden="true" tabindex="-1"></a>pp_12_Ront <span class="ot">&lt;-</span> pp_12a_Ront <span class="sc">+</span> </span>
<span id="cb222-16"><a href="#cb222-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Ront, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Ront, <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(x1_grid_Ront, </span>
<span id="cb222-17"><a href="#cb222-17" aria-hidden="true" tabindex="-1"></a>                                                                          <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fu">length</span>(x1_grid_Ront)), </span>
<span id="cb222-18"><a href="#cb222-18" aria-hidden="true" tabindex="-1"></a>                                                                          <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ront))),</span>
<span id="cb222-19"><a href="#cb222-19" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Ront), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb222-20"><a href="#cb222-20" aria-hidden="true" tabindex="-1"></a>  ))),</span>
<span id="cb222-21"><a href="#cb222-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">'0.085'</span>, <span class="at">linetype =</span> <span class="st">'0.085'</span>)) <span class="sc">+</span></span>
<span id="cb222-22"><a href="#cb222-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Ront, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Ront, <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(x1_grid_Ront, </span>
<span id="cb222-23"><a href="#cb222-23" aria-hidden="true" tabindex="-1"></a>                                                                          <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(x1_grid_Ront)), </span>
<span id="cb222-24"><a href="#cb222-24" aria-hidden="true" tabindex="-1"></a>                                                                          <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ront))),</span>
<span id="cb222-25"><a href="#cb222-25" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Ront), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb222-26"><a href="#cb222-26" aria-hidden="true" tabindex="-1"></a>  ))),</span>
<span id="cb222-27"><a href="#cb222-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">'0.165'</span>, <span class="at">linetype =</span> <span class="st">'0.165'</span>)) <span class="sc">+</span> </span>
<span id="cb222-28"><a href="#cb222-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"f"</span>, </span>
<span id="cb222-29"><a href="#cb222-29" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"0.085"</span> <span class="ot">=</span> <span class="st">"orange2"</span>, </span>
<span id="cb222-30"><a href="#cb222-30" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"0.125"</span> <span class="ot">=</span> <span class="st">"olivedrab3"</span>, </span>
<span id="cb222-31"><a href="#cb222-31" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"0.165"</span> <span class="ot">=</span> <span class="st">"mediumvioletred"</span>)) <span class="sc">+</span> </span>
<span id="cb222-32"><a href="#cb222-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">name =</span> <span class="st">"f"</span>, </span>
<span id="cb222-33"><a href="#cb222-33" aria-hidden="true" tabindex="-1"></a>                        <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"0.085"</span> <span class="ot">=</span> <span class="st">"dashed"</span>, </span>
<span id="cb222-34"><a href="#cb222-34" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"0.125"</span> <span class="ot">=</span> <span class="st">"longdash"</span>, </span>
<span id="cb222-35"><a href="#cb222-35" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"0.165"</span> <span class="ot">=</span> <span class="st">"solid"</span>))</span>
<span id="cb222-36"><a href="#cb222-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-37"><a href="#cb222-37" aria-hidden="true" tabindex="-1"></a>pp_13a_Ront <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span>        </span>
<span id="cb222-38"><a href="#cb222-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Ront, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Ront, <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(x1_grid_Ront, </span>
<span id="cb222-39"><a href="#cb222-39" aria-hidden="true" tabindex="-1"></a>                                                                          <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ront)), </span>
<span id="cb222-40"><a href="#cb222-40" aria-hidden="true" tabindex="-1"></a>                                                                          <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ront))),</span>
<span id="cb222-41"><a href="#cb222-41" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Ront), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb222-42"><a href="#cb222-42" aria-hidden="true" tabindex="-1"></a>  ))),</span>
<span id="cb222-43"><a href="#cb222-43" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">'15'</span>, <span class="at">linetype =</span> <span class="st">'15'</span>)) <span class="sc">+</span></span>
<span id="cb222-44"><a href="#cb222-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Ront vs vc,fp'</span>) <span class="sc">+</span></span>
<span id="cb222-45"><a href="#cb222-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'vc'</span>) <span class="sc">+</span></span>
<span id="cb222-46"><a href="#cb222-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Ront'</span>) <span class="sc">+</span> </span>
<span id="cb222-47"><a href="#cb222-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">40</span>,<span class="dv">200</span>) <span class="sc">+</span></span>
<span id="cb222-48"><a href="#cb222-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.68</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">1.68</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="dv">107</span>, <span class="dv">165</span>, <span class="dv">250</span>, <span class="dv">335</span>, <span class="dv">393</span>)) <span class="sc">+</span> </span>
<span id="cb222-49"><a href="#cb222-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb222-50"><a href="#cb222-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-51"><a href="#cb222-51" aria-hidden="true" tabindex="-1"></a>pp_13_Ront <span class="ot">&lt;-</span> pp_13a_Ront <span class="sc">+</span> </span>
<span id="cb222-52"><a href="#cb222-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Ront, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Ront, </span>
<span id="cb222-53"><a href="#cb222-53" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(x1_grid_Ront, </span>
<span id="cb222-54"><a href="#cb222-54" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ront)), </span>
<span id="cb222-55"><a href="#cb222-55" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fu">length</span>(x1_grid_Ront))),</span>
<span id="cb222-56"><a href="#cb222-56" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Ront), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb222-57"><a href="#cb222-57" aria-hidden="true" tabindex="-1"></a>                                              ))),</span>
<span id="cb222-58"><a href="#cb222-58" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">'7'</span>, <span class="at">linetype =</span> <span class="st">'7'</span>)) <span class="sc">+</span></span>
<span id="cb222-59"><a href="#cb222-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Ront, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Ront, </span>
<span id="cb222-60"><a href="#cb222-60" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(x1_grid_Ront, </span>
<span id="cb222-61"><a href="#cb222-61" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ront)), </span>
<span id="cb222-62"><a href="#cb222-62" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(x1_grid_Ront))),</span>
<span id="cb222-63"><a href="#cb222-63" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Ront), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb222-64"><a href="#cb222-64" aria-hidden="true" tabindex="-1"></a>                                              ))),</span>
<span id="cb222-65"><a href="#cb222-65" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">'23'</span>, <span class="at">linetype =</span> <span class="st">'23'</span>)) <span class="sc">+</span> </span>
<span id="cb222-66"><a href="#cb222-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"fp"</span>, </span>
<span id="cb222-67"><a href="#cb222-67" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"7"</span> <span class="ot">=</span> <span class="st">"orange2"</span>, </span>
<span id="cb222-68"><a href="#cb222-68" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"15"</span> <span class="ot">=</span> <span class="st">"olivedrab3"</span>, </span>
<span id="cb222-69"><a href="#cb222-69" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"23"</span> <span class="ot">=</span> <span class="st">"mediumvioletred"</span>)) <span class="sc">+</span> </span>
<span id="cb222-70"><a href="#cb222-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">name =</span> <span class="st">"fp"</span>, </span>
<span id="cb222-71"><a href="#cb222-71" aria-hidden="true" tabindex="-1"></a>                        <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"7"</span> <span class="ot">=</span> <span class="st">"dashed"</span>, </span>
<span id="cb222-72"><a href="#cb222-72" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"15"</span> <span class="ot">=</span> <span class="st">"longdash"</span>, </span>
<span id="cb222-73"><a href="#cb222-73" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"23"</span> <span class="ot">=</span> <span class="st">"solid"</span>))</span>
<span id="cb222-74"><a href="#cb222-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-75"><a href="#cb222-75" aria-hidden="true" tabindex="-1"></a>pp_23a_Ront <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span>        </span>
<span id="cb222-76"><a href="#cb222-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Ront, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Ront, <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ront)),</span>
<span id="cb222-77"><a href="#cb222-77" aria-hidden="true" tabindex="-1"></a>                                                                          x1_grid_Ront, </span>
<span id="cb222-78"><a href="#cb222-78" aria-hidden="true" tabindex="-1"></a>                                                                          <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ront))),</span>
<span id="cb222-79"><a href="#cb222-79" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Ront), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb222-80"><a href="#cb222-80" aria-hidden="true" tabindex="-1"></a>  ))),</span>
<span id="cb222-81"><a href="#cb222-81" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">'15'</span>, <span class="at">linetype =</span> <span class="st">'15'</span>)) <span class="sc">+</span></span>
<span id="cb222-82"><a href="#cb222-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Ront vs f,fp'</span>) <span class="sc">+</span></span>
<span id="cb222-83"><a href="#cb222-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'f'</span>) <span class="sc">+</span></span>
<span id="cb222-84"><a href="#cb222-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Ront'</span>) <span class="sc">+</span> </span>
<span id="cb222-85"><a href="#cb222-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">40</span>,<span class="dv">200</span>) <span class="sc">+</span></span>
<span id="cb222-86"><a href="#cb222-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.68</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">1.68</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="fl">0.058</span>, <span class="fl">0.085</span>, <span class="fl">0.125</span>, <span class="fl">0.165</span>, <span class="fl">0.192</span>)) <span class="sc">+</span> </span>
<span id="cb222-87"><a href="#cb222-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb222-88"><a href="#cb222-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-89"><a href="#cb222-89" aria-hidden="true" tabindex="-1"></a>pp_23_Ront <span class="ot">&lt;-</span> pp_23a_Ront <span class="sc">+</span> </span>
<span id="cb222-90"><a href="#cb222-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Ront, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Ront, </span>
<span id="cb222-91"><a href="#cb222-91" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ront)),</span>
<span id="cb222-92"><a href="#cb222-92" aria-hidden="true" tabindex="-1"></a>                                                                 x1_grid_Ront, </span>
<span id="cb222-93"><a href="#cb222-93" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fu">length</span>(x1_grid_Ront))),</span>
<span id="cb222-94"><a href="#cb222-94" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Ront), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb222-95"><a href="#cb222-95" aria-hidden="true" tabindex="-1"></a>                                              ))),</span>
<span id="cb222-96"><a href="#cb222-96" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">'7'</span>, <span class="at">linetype =</span> <span class="st">'7'</span>)) <span class="sc">+</span></span>
<span id="cb222-97"><a href="#cb222-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid_Ront, <span class="at">y =</span> (<span class="fu">predict</span>(xgb_Ront, </span>
<span id="cb222-98"><a href="#cb222-98" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x1_grid_Ront)),</span>
<span id="cb222-99"><a href="#cb222-99" aria-hidden="true" tabindex="-1"></a>                                                                 x1_grid_Ront, </span>
<span id="cb222-100"><a href="#cb222-100" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(x1_grid_Ront))),</span>
<span id="cb222-101"><a href="#cb222-101" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">nrow =</span> <span class="fu">length</span>(x1_grid_Ront), <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb222-102"><a href="#cb222-102" aria-hidden="true" tabindex="-1"></a>                                              ))),</span>
<span id="cb222-103"><a href="#cb222-103" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">'23'</span>, <span class="at">linetype =</span> <span class="st">'23'</span>)) <span class="sc">+</span> </span>
<span id="cb222-104"><a href="#cb222-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"fp"</span>, </span>
<span id="cb222-105"><a href="#cb222-105" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"7"</span> <span class="ot">=</span> <span class="st">"orange2"</span>, </span>
<span id="cb222-106"><a href="#cb222-106" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"15"</span> <span class="ot">=</span> <span class="st">"olivedrab3"</span>, </span>
<span id="cb222-107"><a href="#cb222-107" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"23"</span> <span class="ot">=</span> <span class="st">"mediumvioletred"</span>)) <span class="sc">+</span> </span>
<span id="cb222-108"><a href="#cb222-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">name =</span> <span class="st">"fp"</span>, </span>
<span id="cb222-109"><a href="#cb222-109" aria-hidden="true" tabindex="-1"></a>                        <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"7"</span> <span class="ot">=</span> <span class="st">"dashed"</span>, </span>
<span id="cb222-110"><a href="#cb222-110" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"15"</span> <span class="ot">=</span> <span class="st">"longdash"</span>, </span>
<span id="cb222-111"><a href="#cb222-111" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"23"</span> <span class="ot">=</span> <span class="st">"solid"</span>))</span>
<span id="cb222-112"><a href="#cb222-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-113"><a href="#cb222-113" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(pp_12_Ront, pp_13_Ront, pp_23_Ront, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MOEA_XGB_Internal_turning_PEEK_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Contour plots:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>x1grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(plan_respostas<span class="sc">$</span>x1), <span class="fu">max</span>(plan_respostas<span class="sc">$</span>x1), <span class="fl">0.05</span>)</span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">x1 =</span> x1grid,</span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x2 =</span> x1grid,</span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x3 =</span> <span class="dv">0</span>)</span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a>y_hat_xgb <span class="ot">&lt;-</span> <span class="fu">predict</span>(xgb_Ront, <span class="at">newdata =</span> <span class="fu">as.matrix</span>(grid))</span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a>grid<span class="sc">$</span>Ront <span class="ot">&lt;-</span> y_hat_xgb</span>
<span id="cb223-9"><a href="#cb223-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-10"><a href="#cb223-10" aria-hidden="true" tabindex="-1"></a>cp1_xgb <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> grid,</span>
<span id="cb223-11"><a href="#cb223-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">z =</span> Ront, <span class="at">fill =</span> Ront)) <span class="sc">+</span></span>
<span id="cb223-12"><a href="#cb223-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb223-13"><a href="#cb223-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"Spectral"</span>,</span>
<span id="cb223-14"><a href="#cb223-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">40</span>,<span class="dv">180</span>)) <span class="sc">+</span></span>
<span id="cb223-15"><a href="#cb223-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">bins =</span> <span class="dv">10</span>) <span class="sc">+</span> </span>
<span id="cb223-16"><a href="#cb223-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="dv">165</span>, <span class="dv">250</span>, <span class="dv">335</span>)) <span class="sc">+</span> </span>
<span id="cb223-17"><a href="#cb223-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="fl">0.085</span>, <span class="fl">0.125</span>, <span class="fl">0.165</span>)) <span class="sc">+</span> </span>
<span id="cb223-18"><a href="#cb223-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"vc"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"f"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb223-19"><a href="#cb223-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-20"><a href="#cb223-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-21"><a href="#cb223-21" aria-hidden="true" tabindex="-1"></a>grid2 <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">x1 =</span> x1grid,</span>
<span id="cb223-22"><a href="#cb223-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x2 =</span> <span class="dv">0</span>,</span>
<span id="cb223-23"><a href="#cb223-23" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x3 =</span> x1grid)</span>
<span id="cb223-24"><a href="#cb223-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-25"><a href="#cb223-25" aria-hidden="true" tabindex="-1"></a>y_hat_xgb2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(xgb_Ront, <span class="at">newdata =</span> <span class="fu">as.matrix</span>(grid2))</span>
<span id="cb223-26"><a href="#cb223-26" aria-hidden="true" tabindex="-1"></a>grid2<span class="sc">$</span>Ront <span class="ot">&lt;-</span> y_hat_xgb2</span>
<span id="cb223-27"><a href="#cb223-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-28"><a href="#cb223-28" aria-hidden="true" tabindex="-1"></a>cp2_xgb <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> grid2,</span>
<span id="cb223-29"><a href="#cb223-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x3, <span class="at">z =</span> Ront, <span class="at">fill =</span> Ront)) <span class="sc">+</span></span>
<span id="cb223-30"><a href="#cb223-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb223-31"><a href="#cb223-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"Spectral"</span>,</span>
<span id="cb223-32"><a href="#cb223-32" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">40</span>,<span class="dv">180</span>)) <span class="sc">+</span></span>
<span id="cb223-33"><a href="#cb223-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">bins =</span> <span class="dv">10</span>) <span class="sc">+</span> </span>
<span id="cb223-34"><a href="#cb223-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="dv">165</span>, <span class="dv">250</span>, <span class="dv">335</span>)) <span class="sc">+</span> </span>
<span id="cb223-35"><a href="#cb223-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">15</span>, <span class="dv">23</span>)) <span class="sc">+</span> </span>
<span id="cb223-36"><a href="#cb223-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"vc"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"fp"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb223-37"><a href="#cb223-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-38"><a href="#cb223-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-39"><a href="#cb223-39" aria-hidden="true" tabindex="-1"></a>grid3 <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">x1 =</span> <span class="dv">0</span>,</span>
<span id="cb223-40"><a href="#cb223-40" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x2 =</span> x1grid,</span>
<span id="cb223-41"><a href="#cb223-41" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x3 =</span> x1grid)</span>
<span id="cb223-42"><a href="#cb223-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-43"><a href="#cb223-43" aria-hidden="true" tabindex="-1"></a>y_hat_xgb3 <span class="ot">&lt;-</span> <span class="fu">predict</span>(xgb_Ront, <span class="at">newdata =</span> <span class="fu">as.matrix</span>(grid3))</span>
<span id="cb223-44"><a href="#cb223-44" aria-hidden="true" tabindex="-1"></a>grid3<span class="sc">$</span>Ront <span class="ot">&lt;-</span> y_hat_xgb3</span>
<span id="cb223-45"><a href="#cb223-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-46"><a href="#cb223-46" aria-hidden="true" tabindex="-1"></a>cp3_xgb <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> grid3,</span>
<span id="cb223-47"><a href="#cb223-47" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x2, <span class="at">y =</span> x3, <span class="at">z =</span> Ront, <span class="at">fill =</span> Ront)) <span class="sc">+</span></span>
<span id="cb223-48"><a href="#cb223-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb223-49"><a href="#cb223-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"Spectral"</span>,</span>
<span id="cb223-50"><a href="#cb223-50" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">40</span>,<span class="dv">180</span>)) <span class="sc">+</span></span>
<span id="cb223-51"><a href="#cb223-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">bins =</span> <span class="dv">10</span>) <span class="sc">+</span> </span>
<span id="cb223-52"><a href="#cb223-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="fl">0.085</span>, <span class="fl">0.125</span>, <span class="fl">0.165</span>)) <span class="sc">+</span> </span>
<span id="cb223-53"><a href="#cb223-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">15</span>, <span class="dv">23</span>)) <span class="sc">+</span> </span>
<span id="cb223-54"><a href="#cb223-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"f"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"fp"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb223-55"><a href="#cb223-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-56"><a href="#cb223-56" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(cp1_xgb, cp2_xgb, cp3_xgb, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MOEA_XGB_Internal_turning_PEEK_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Feature importance plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>importance_matrix_Ront <span class="ot">&lt;-</span> <span class="fu">xgb.importance</span>(<span class="fu">colnames</span>(plan_respostas[,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>]), <span class="at">model =</span> xgb_Ront)</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(importance_matrix_Ront, <span class="fu">aes</span>(<span class="at">x=</span> <span class="fu">reorder</span>(Feature, Gain), <span class="at">y =</span> Gain)) <span class="sc">+</span></span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"pink4"</span>, <span class="at">fill =</span> <span class="st">"pink"</span>) <span class="sc">+</span> </span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Importance"</span>, <span class="at">x =</span> <span class="st">"Feature"</span>) <span class="sc">+</span> </span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"fp"</span>, <span class="st">"f"</span>, <span class="st">"vc"</span>)) <span class="sc">+</span></span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MOEA_XGB_Internal_turning_PEEK_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
</section>
<section id="multi-objective-evolutionary-optimization" class="level2">
<h2 class="anchored" data-anchor-id="multi-objective-evolutionary-optimization">Multi-objective evolutionary optimization</h2>
<section id="solving-through-caramel" class="level3">
<h3 class="anchored" data-anchor-id="solving-through-caramel">Solving through caramel</h3>
<p>Three-objective optimization function considering caramel package syntax:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>xgb_Fc_Ront_caRamel <span class="ot">&lt;-</span> <span class="cf">function</span>(i){</span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>  f1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(xgb_Fc, <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="at">x1 =</span> x[i,<span class="dv">1</span>],</span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">x2 =</span> x[i,<span class="dv">2</span>],</span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">x3 =</span> x[i,<span class="dv">3</span>]), </span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">nrow =</span> <span class="dv">1</span>))</span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a>  f2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(xgb_Ront, <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="at">x1 =</span> x[i,<span class="dv">1</span>],</span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">x2 =</span> x[i,<span class="dv">2</span>],</span>
<span id="cb225-10"><a href="#cb225-10" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">x3 =</span> x[i,<span class="dv">3</span>]), </span>
<span id="cb225-11"><a href="#cb225-11" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">nrow =</span> <span class="dv">1</span>))</span>
<span id="cb225-12"><a href="#cb225-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-13"><a href="#cb225-13" aria-hidden="true" tabindex="-1"></a>  f3 <span class="ot">&lt;-</span> <span class="sc">-</span>((x[i,<span class="dv">1</span>]<span class="sc">*</span><span class="dv">85</span><span class="sc">+</span><span class="dv">250</span>)<span class="sc">*</span>(x[i,<span class="dv">2</span>]<span class="sc">*</span><span class="fl">0.04+0.125</span>)<span class="sc">*</span><span class="fl">0.8</span>)</span>
<span id="cb225-14"><a href="#cb225-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb225-15"><a href="#cb225-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(x[i,<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> x[i,<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> x[i,<span class="dv">3</span>]<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> ro<span class="sc">^</span><span class="dv">2</span> <span class="sc">&gt;</span> <span class="fl">0.</span>) {</span>
<span id="cb225-16"><a href="#cb225-16" aria-hidden="true" tabindex="-1"></a>    f1 <span class="ot">&lt;-</span> <span class="cn">NaN</span></span>
<span id="cb225-17"><a href="#cb225-17" aria-hidden="true" tabindex="-1"></a>    f2 <span class="ot">&lt;-</span> <span class="cn">NaN</span></span>
<span id="cb225-18"><a href="#cb225-18" aria-hidden="true" tabindex="-1"></a>    f3 <span class="ot">&lt;-</span> <span class="cn">NaN</span></span>
<span id="cb225-19"><a href="#cb225-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb225-20"><a href="#cb225-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb225-21"><a href="#cb225-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(f1,f2,f3))</span>
<span id="cb225-22"><a href="#cb225-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Parameters for caramel algorithm:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>ro <span class="ot">&lt;-</span> (<span class="dv">2</span><span class="sc">^</span><span class="dv">3</span>)<span class="sc">^</span><span class="fl">0.25</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a>nvar <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a>bounds <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="fl">0.</span>, <span class="at">nrow =</span> nvar, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a>bounds[<span class="dv">1</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="sc">-</span>ro</span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true" tabindex="-1"></a>bounds[<span class="dv">1</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> ro</span>
<span id="cb226-7"><a href="#cb226-7" aria-hidden="true" tabindex="-1"></a>bounds[<span class="dv">2</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="sc">-</span>ro</span>
<span id="cb226-8"><a href="#cb226-8" aria-hidden="true" tabindex="-1"></a>bounds[<span class="dv">2</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> ro</span>
<span id="cb226-9"><a href="#cb226-9" aria-hidden="true" tabindex="-1"></a>bounds[<span class="dv">3</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="sc">-</span>ro</span>
<span id="cb226-10"><a href="#cb226-10" aria-hidden="true" tabindex="-1"></a>bounds[<span class="dv">3</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> ro</span>
<span id="cb226-11"><a href="#cb226-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-12"><a href="#cb226-12" aria-hidden="true" tabindex="-1"></a>nobj <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb226-13"><a href="#cb226-13" aria-hidden="true" tabindex="-1"></a>minmax <span class="ot">&lt;-</span> <span class="fu">c</span>(F, F, F)</span>
<span id="cb226-14"><a href="#cb226-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-15"><a href="#cb226-15" aria-hidden="true" tabindex="-1"></a>popsize <span class="ot">&lt;-</span> <span class="dv">300</span> </span>
<span id="cb226-16"><a href="#cb226-16" aria-hidden="true" tabindex="-1"></a>archsize <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb226-17"><a href="#cb226-17" aria-hidden="true" tabindex="-1"></a>maxrun <span class="ot">&lt;-</span> <span class="dv">30000</span></span>
<span id="cb226-18"><a href="#cb226-18" aria-hidden="true" tabindex="-1"></a>prec <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>.e<span class="dv">-7</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> nobj)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Solving through caramel:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>start <span class="ot">=</span> <span class="fu">Sys.time</span>()</span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>opttri2 <span class="ot">&lt;-</span></span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">caRamel</span>(nobj,</span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a>          nvar,</span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a>          minmax,</span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a>          bounds,</span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a>          xgb_Fc_Ront_caRamel,</span>
<span id="cb227-9"><a href="#cb227-9" aria-hidden="true" tabindex="-1"></a>          popsize,</span>
<span id="cb227-10"><a href="#cb227-10" aria-hidden="true" tabindex="-1"></a>          archsize,</span>
<span id="cb227-11"><a href="#cb227-11" aria-hidden="true" tabindex="-1"></a>          maxrun,</span>
<span id="cb227-12"><a href="#cb227-12" aria-hidden="true" tabindex="-1"></a>          prec,</span>
<span id="cb227-13"><a href="#cb227-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">carallel=</span><span class="cn">FALSE</span>,</span>
<span id="cb227-14"><a href="#cb227-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">graph =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>( <span class="fu">Sys.time</span>() <span class="sc">-</span> start )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 4.965056 mins</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>opttri2_res_caRamel <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(opttri2<span class="sc">$</span>objectives)</span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(opttri2_res_caRamel) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Fc"</span>, <span class="st">"Ront"</span>, <span class="st">"MRR"</span>)</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>opttri2_res_caRamel<span class="sc">$</span>MRR <span class="ot">&lt;-</span> <span class="sc">-</span>opttri2_res_caRamel<span class="sc">$</span>MRR </span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb230-6"><a href="#cb230-6" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter3D</span>(opttri2_res_caRamel<span class="sc">$</span>Fc, </span>
<span id="cb230-7"><a href="#cb230-7" aria-hidden="true" tabindex="-1"></a>          opttri2_res_caRamel<span class="sc">$</span>Ront, </span>
<span id="cb230-8"><a href="#cb230-8" aria-hidden="true" tabindex="-1"></a>          opttri2_res_caRamel<span class="sc">$</span>MRR, </span>
<span id="cb230-9"><a href="#cb230-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="st">"mediumseagreen"</span>, </span>
<span id="cb230-10"><a href="#cb230-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb230-11"><a href="#cb230-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">bty =</span> <span class="st">"b2"</span>,</span>
<span id="cb230-12"><a href="#cb230-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">theta =</span> <span class="dv">45</span>, <span class="at">phi =</span> <span class="dv">30</span>,</span>
<span id="cb230-13"><a href="#cb230-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">ticktype =</span> <span class="st">"detailed"</span>,</span>
<span id="cb230-14"><a href="#cb230-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"Ra"</span>,</span>
<span id="cb230-15"><a href="#cb230-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span><span class="st">"Ront"</span>, </span>
<span id="cb230-16"><a href="#cb230-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">zlab =</span> <span class="st">"MRR"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MOEA_XGB_Internal_turning_PEEK_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Hypervolume calculation for caramel:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a>ref <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">165</span>, <span class="sc">-</span><span class="dv">7</span>)</span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dominated_hypervolume</span>(<span class="fu">as.matrix</span>(<span class="fu">t</span>(opttri2<span class="sc">$</span>objectives)), ref)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 67538.72</code></pre>
</div>
</div>
<p>Spacing between solutions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a>ed <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(opttri2<span class="sc">$</span>objectives, <span class="at">diag =</span> F, <span class="at">upper =</span> T), <span class="at">nrow =</span> <span class="fu">nrow</span>(opttri2<span class="sc">$</span>value))</span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>ed <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(ed)</span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>ed[ed <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a>mindist <span class="ot">&lt;-</span> <span class="fu">apply</span>(ed, <span class="dv">1</span>, <span class="at">FUN =</span> min, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true" tabindex="-1"></a>Spacing <span class="ot">&lt;-</span> <span class="fu">sd</span>(mindist)</span>
<span id="cb233-6"><a href="#cb233-6" aria-hidden="true" tabindex="-1"></a>Spacing</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.436398</code></pre>
</div>
</div>
</section>
<section id="solving-through-mopsocd" class="level3">
<h3 class="anchored" data-anchor-id="solving-through-mopsocd">Solving through MOPSOCD</h3>
<p>MOPSOCD function: (Author: Pros Naval <a href="mailto:pcnaval@dcs.upd.edu.ph" class="email">pcnaval@dcs.upd.edu.ph</a>, available at: <a href="https://cran.r-project.org/src/contrib/Archive/mopsocd/" class="uri">https://cran.r-project.org/src/contrib/Archive/mopsocd/</a>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a>mopsocd <span class="ot">&lt;-</span> <span class="cf">function</span>(fn,gn,varcnt,fncnt,lowerbound,upperbound,opt,popsize,maxgen,archivesize,verbosity,pMut,w,c1,c2) <span class="fu">UseMethod</span>(<span class="st">"mopsocd"</span>)</span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>mopsocd <span class="ot">&lt;-</span> <span class="cf">function</span>(fn,<span class="at">gn=</span><span class="cn">NULL</span>,varcnt,fncnt,lowerbound,upperbound,opt,<span class="at">popsize=</span><span class="dv">100</span>,<span class="at">maxgen=</span><span class="dv">100</span>,<span class="at">archivesize=</span><span class="dv">250</span>,<span class="at">verbosity=</span><span class="dv">0</span>,<span class="at">pMut=</span><span class="fl">0.5</span>,<span class="at">w=</span><span class="fl">0.4</span>,<span class="at">c1=</span><span class="fl">1.0</span>,<span class="at">c2=</span><span class="fl">1.0</span>)</span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a>  varcnt <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(varcnt)</span>
<span id="cb235-6"><a href="#cb235-6" aria-hidden="true" tabindex="-1"></a>  fncnt <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(fncnt)</span>
<span id="cb235-7"><a href="#cb235-7" aria-hidden="true" tabindex="-1"></a>  lowerbound <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(lowerbound)</span>
<span id="cb235-8"><a href="#cb235-8" aria-hidden="true" tabindex="-1"></a>  upperbound <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(upperbound)</span>
<span id="cb235-9"><a href="#cb235-9" aria-hidden="true" tabindex="-1"></a>  opt <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(opt)</span>
<span id="cb235-10"><a href="#cb235-10" aria-hidden="true" tabindex="-1"></a>  popsize <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(popsize)</span>
<span id="cb235-11"><a href="#cb235-11" aria-hidden="true" tabindex="-1"></a>  maxgen <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(maxgen)</span>
<span id="cb235-12"><a href="#cb235-12" aria-hidden="true" tabindex="-1"></a>  archivesize <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(archivesize)</span>
<span id="cb235-13"><a href="#cb235-13" aria-hidden="true" tabindex="-1"></a>  verbosity <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(verbosity)</span>
<span id="cb235-14"><a href="#cb235-14" aria-hidden="true" tabindex="-1"></a>  pMut <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(pMut)</span>
<span id="cb235-15"><a href="#cb235-15" aria-hidden="true" tabindex="-1"></a>  w <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(w)</span>
<span id="cb235-16"><a href="#cb235-16" aria-hidden="true" tabindex="-1"></a>  c1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(c1)</span>
<span id="cb235-17"><a href="#cb235-17" aria-hidden="true" tabindex="-1"></a>  c2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(c2)</span>
<span id="cb235-18"><a href="#cb235-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pareto &lt;- mopsocdbase(fn,gn,varcnt,fncnt,lowerbound,upperbound,opt,popsize,maxgen,archivesize,verbosity,pMut,w,c1,c2)  </span></span>
<span id="cb235-19"><a href="#cb235-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-20"><a href="#cb235-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pareto$call &lt;- match.call()</span></span>
<span id="cb235-21"><a href="#cb235-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-22"><a href="#cb235-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># class(pareto) &lt;- "pareto"</span></span>
<span id="cb235-23"><a href="#cb235-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pareto</span></span>
<span id="cb235-24"><a href="#cb235-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># }</span></span>
<span id="cb235-25"><a href="#cb235-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-26"><a href="#cb235-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mopsocdbase &lt;- function(fn,gn,varcnt,fncnt,lowerbound,upperbound,opt,popsize,maxgen,archivesize,verbosity,pMut,w,c1,c2)</span></span>
<span id="cb235-27"><a href="#cb235-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># {</span></span>
<span id="cb235-28"><a href="#cb235-28" aria-hidden="true" tabindex="-1"></a>  <span class="do">####################</span></span>
<span id="cb235-29"><a href="#cb235-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Global Variables #</span></span>
<span id="cb235-30"><a href="#cb235-30" aria-hidden="true" tabindex="-1"></a>  <span class="do">####################</span></span>
<span id="cb235-31"><a href="#cb235-31" aria-hidden="true" tabindex="-1"></a>  minvalue <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length=</span>varcnt)</span>
<span id="cb235-32"><a href="#cb235-32" aria-hidden="true" tabindex="-1"></a>  maxvalue <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length=</span>varcnt)</span>
<span id="cb235-33"><a href="#cb235-33" aria-hidden="true" tabindex="-1"></a>  archiveVar <span class="ot">&lt;-</span> <span class="fu">matrix</span>(,<span class="at">nrow=</span>archivesize,<span class="at">ncol=</span>varcnt) </span>
<span id="cb235-34"><a href="#cb235-34" aria-hidden="true" tabindex="-1"></a>  archiveFit <span class="ot">&lt;-</span> <span class="fu">matrix</span>(,<span class="at">nrow=</span>archivesize,<span class="at">ncol=</span>fncnt)</span>
<span id="cb235-35"><a href="#cb235-35" aria-hidden="true" tabindex="-1"></a>  popVar <span class="ot">&lt;-</span> <span class="fu">matrix</span>(,<span class="at">nrow=</span>popsize,<span class="at">ncol=</span>varcnt)</span>
<span id="cb235-36"><a href="#cb235-36" aria-hidden="true" tabindex="-1"></a>  popFit <span class="ot">&lt;-</span> <span class="fu">matrix</span>(,<span class="at">nrow=</span>popsize,<span class="at">ncol=</span>fncnt)</span>
<span id="cb235-37"><a href="#cb235-37" aria-hidden="true" tabindex="-1"></a>  pbestsVar <span class="ot">&lt;-</span> <span class="fu">matrix</span>(,<span class="at">nrow=</span>popsize, <span class="at">ncol=</span>varcnt)</span>
<span id="cb235-38"><a href="#cb235-38" aria-hidden="true" tabindex="-1"></a>  pbestsFit <span class="ot">&lt;-</span> <span class="fu">matrix</span>(,<span class="at">nrow=</span>popsize, <span class="at">ncol=</span>fncnt)</span>
<span id="cb235-39"><a href="#cb235-39" aria-hidden="true" tabindex="-1"></a>  velocity <span class="ot">&lt;-</span> <span class="fu">matrix</span>(,<span class="at">nrow=</span>popsize, <span class="at">ncol=</span>varcnt) </span>
<span id="cb235-40"><a href="#cb235-40" aria-hidden="true" tabindex="-1"></a>  crowdDist <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length=</span>archivesize)</span>
<span id="cb235-41"><a href="#cb235-41" aria-hidden="true" tabindex="-1"></a>  minvaluetemp <span class="ot">&lt;-</span> <span class="fu">matrix</span>(,<span class="at">nrow=</span>popsize,<span class="at">ncol=</span>varcnt)</span>
<span id="cb235-42"><a href="#cb235-42" aria-hidden="true" tabindex="-1"></a>  maxvaluetemp <span class="ot">&lt;-</span> <span class="fu">matrix</span>(,<span class="at">nrow=</span>popsize,<span class="at">ncol=</span>varcnt)</span>
<span id="cb235-43"><a href="#cb235-43" aria-hidden="true" tabindex="-1"></a>  ndomCtr <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb235-44"><a href="#cb235-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-45"><a href="#cb235-45" aria-hidden="true" tabindex="-1"></a>  maxvalue <span class="ot">&lt;-</span> upperbound</span>
<span id="cb235-46"><a href="#cb235-46" aria-hidden="true" tabindex="-1"></a>  minvalue <span class="ot">&lt;-</span> lowerbound</span>
<span id="cb235-47"><a href="#cb235-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-48"><a href="#cb235-48" aria-hidden="true" tabindex="-1"></a>  <span class="do">#########################</span></span>
<span id="cb235-49"><a href="#cb235-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize Population #</span></span>
<span id="cb235-50"><a href="#cb235-50" aria-hidden="true" tabindex="-1"></a>  <span class="do">#########################</span></span>
<span id="cb235-51"><a href="#cb235-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-52"><a href="#cb235-52" aria-hidden="true" tabindex="-1"></a>  initialize_pop <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb235-53"><a href="#cb235-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-54"><a href="#cb235-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>varcnt) {</span>
<span id="cb235-55"><a href="#cb235-55" aria-hidden="true" tabindex="-1"></a>      popVar[<span class="dv">1</span><span class="sc">:</span>popsize,i] <span class="ot">&lt;&lt;-</span> <span class="fu">runif</span>(popsize,<span class="at">min=</span>minvalue[i],<span class="at">max=</span>maxvalue[i])</span>
<span id="cb235-56"><a href="#cb235-56" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb235-57"><a href="#cb235-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-58"><a href="#cb235-58" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb235-59"><a href="#cb235-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-60"><a href="#cb235-60" aria-hidden="true" tabindex="-1"></a>  <span class="do">##################################</span></span>
<span id="cb235-61"><a href="#cb235-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize Particle Velocities #</span></span>
<span id="cb235-62"><a href="#cb235-62" aria-hidden="true" tabindex="-1"></a>  <span class="do">##################################</span></span>
<span id="cb235-63"><a href="#cb235-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-64"><a href="#cb235-64" aria-hidden="true" tabindex="-1"></a>  initialize_vel <span class="ot">&lt;-</span> <span class="cf">function</span>() { </span>
<span id="cb235-65"><a href="#cb235-65" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-66"><a href="#cb235-66" aria-hidden="true" tabindex="-1"></a>    velocity[<span class="dv">1</span><span class="sc">:</span>popsize,<span class="dv">1</span><span class="sc">:</span>varcnt] <span class="ot">&lt;&lt;-</span> <span class="fl">0.0</span>  </span>
<span id="cb235-67"><a href="#cb235-67" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-68"><a href="#cb235-68" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb235-69"><a href="#cb235-69" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-70"><a href="#cb235-70" aria-hidden="true" tabindex="-1"></a>  <span class="do">##########################################################</span></span>
<span id="cb235-71"><a href="#cb235-71" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Evaluate: Compute Value of each Particle in Population #</span></span>
<span id="cb235-72"><a href="#cb235-72" aria-hidden="true" tabindex="-1"></a>  <span class="do">##########################################################</span></span>
<span id="cb235-73"><a href="#cb235-73" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-74"><a href="#cb235-74" aria-hidden="true" tabindex="-1"></a>  evaluate <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb235-75"><a href="#cb235-75" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-76"><a href="#cb235-76" aria-hidden="true" tabindex="-1"></a>    popFit[<span class="dv">1</span><span class="sc">:</span>popsize,] <span class="ot">&lt;&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(popVar,<span class="dv">1</span>,fn))</span>
<span id="cb235-77"><a href="#cb235-77" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-78"><a href="#cb235-78" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb235-79"><a href="#cb235-79" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-80"><a href="#cb235-80" aria-hidden="true" tabindex="-1"></a>  <span class="do">######################################################</span></span>
<span id="cb235-81"><a href="#cb235-81" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store Values and Fitness Values for Best Particles #</span></span>
<span id="cb235-82"><a href="#cb235-82" aria-hidden="true" tabindex="-1"></a>  <span class="do">######################################################</span></span>
<span id="cb235-83"><a href="#cb235-83" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-84"><a href="#cb235-84" aria-hidden="true" tabindex="-1"></a>  store_pbests <span class="ot">&lt;-</span> <span class="cf">function</span>() {  </span>
<span id="cb235-85"><a href="#cb235-85" aria-hidden="true" tabindex="-1"></a>    pbestsVar[<span class="dv">1</span><span class="sc">:</span>popsize,] <span class="ot">&lt;&lt;-</span> popVar[<span class="dv">1</span><span class="sc">:</span>popsize,]</span>
<span id="cb235-86"><a href="#cb235-86" aria-hidden="true" tabindex="-1"></a>    pbestsFit[<span class="dv">1</span><span class="sc">:</span>popsize,] <span class="ot">&lt;&lt;-</span> popFit[<span class="dv">1</span><span class="sc">:</span>popsize,]</span>
<span id="cb235-87"><a href="#cb235-87" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb235-88"><a href="#cb235-88" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-89"><a href="#cb235-89" aria-hidden="true" tabindex="-1"></a>  <span class="do">##########################################</span></span>
<span id="cb235-90"><a href="#cb235-90" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Insert ndominated Particles in Archive #</span></span>
<span id="cb235-91"><a href="#cb235-91" aria-hidden="true" tabindex="-1"></a>  <span class="do">##########################################</span></span>
<span id="cb235-92"><a href="#cb235-92" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-93"><a href="#cb235-93" aria-hidden="true" tabindex="-1"></a>  insert_nondom <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb235-94"><a href="#cb235-94" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-95"><a href="#cb235-95" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(gn)) {</span>
<span id="cb235-96"><a href="#cb235-96" aria-hidden="true" tabindex="-1"></a>      z <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(<span class="fu">t</span>(<span class="fu">matrix</span>(<span class="sc">!</span><span class="fu">apply</span>(popVar,<span class="dv">1</span>,gn),<span class="at">ncol=</span>popsize)<span class="sc">*</span><span class="dv">1</span>)) </span>
<span id="cb235-97"><a href="#cb235-97" aria-hidden="true" tabindex="-1"></a>      minz <span class="ot">&lt;-</span> <span class="fu">min</span>(z)</span>
<span id="cb235-98"><a href="#cb235-98" aria-hidden="true" tabindex="-1"></a>      ix <span class="ot">&lt;-</span> <span class="fu">which</span>(z <span class="sc">==</span> minz)</span>
<span id="cb235-99"><a href="#cb235-99" aria-hidden="true" tabindex="-1"></a>      lenix <span class="ot">&lt;-</span> <span class="fu">length</span>(ix)</span>
<span id="cb235-100"><a href="#cb235-100" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb235-101"><a href="#cb235-101" aria-hidden="true" tabindex="-1"></a>      ixfpop <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb235-102"><a href="#cb235-102" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (i <span class="cf">in</span> ix) {   </span>
<span id="cb235-103"><a href="#cb235-103" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (opt <span class="sc">==</span> <span class="dv">1</span>) {    </span>
<span id="cb235-104"><a href="#cb235-104" aria-hidden="true" tabindex="-1"></a>          x <span class="ot">&lt;-</span> (<span class="fu">t</span>(<span class="fu">matrix</span>(<span class="fu">rep</span>(popFit[i,],lenix),<span class="at">nrow=</span>fncnt))<span class="sc">-</span>popFit[ix,] <span class="sc">&lt;</span> <span class="fl">0.0</span>)<span class="sc">*</span><span class="dv">1</span></span>
<span id="cb235-105"><a href="#cb235-105" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb235-106"><a href="#cb235-106" aria-hidden="true" tabindex="-1"></a>          x <span class="ot">&lt;-</span> (<span class="fu">t</span>(<span class="fu">matrix</span>(<span class="fu">rep</span>(popFit[i,],lenix),<span class="at">nrow=</span>fncnt))<span class="sc">-</span>popFit[ix,] <span class="sc">&gt;</span> <span class="fl">0.0</span>)<span class="sc">*</span><span class="dv">1</span></span>
<span id="cb235-107"><a href="#cb235-107" aria-hidden="true" tabindex="-1"></a>        }         </span>
<span id="cb235-108"><a href="#cb235-108" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>((<span class="fu">max</span>(<span class="fu">rowSums</span>(x)) <span class="sc">==</span> fncnt) <span class="sc">==</span> <span class="cn">FALSE</span>){</span>
<span id="cb235-109"><a href="#cb235-109" aria-hidden="true" tabindex="-1"></a>          ixfpop <span class="ot">&lt;-</span> <span class="fu">c</span>(ixfpop,i)</span>
<span id="cb235-110"><a href="#cb235-110" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb235-111"><a href="#cb235-111" aria-hidden="true" tabindex="-1"></a>      }  </span>
<span id="cb235-112"><a href="#cb235-112" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb235-113"><a href="#cb235-113" aria-hidden="true" tabindex="-1"></a>      ixfpop <span class="ot">=</span><span class="fu">seq</span>(popsize)</span>
<span id="cb235-114"><a href="#cb235-114" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb235-115"><a href="#cb235-115" aria-hidden="true" tabindex="-1"></a>    lenfpop <span class="ot">&lt;-</span> <span class="fu">length</span>(ixfpop)</span>
<span id="cb235-116"><a href="#cb235-116" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-117"><a href="#cb235-117" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(lenfpop <span class="sc">!=</span> <span class="dv">0</span>){</span>
<span id="cb235-118"><a href="#cb235-118" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (ndomCtr <span class="sc">+</span> lenfpop <span class="sc">&lt;=</span> archivesize) {</span>
<span id="cb235-119"><a href="#cb235-119" aria-hidden="true" tabindex="-1"></a>        archiveVar[(ndomCtr<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(ndomCtr<span class="sc">+</span>lenfpop),] <span class="ot">&lt;&lt;-</span> popVar[ixfpop,]</span>
<span id="cb235-120"><a href="#cb235-120" aria-hidden="true" tabindex="-1"></a>        archiveFit[(ndomCtr<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(ndomCtr<span class="sc">+</span>lenfpop),] <span class="ot">&lt;&lt;-</span> popFit[ixfpop,]</span>
<span id="cb235-121"><a href="#cb235-121" aria-hidden="true" tabindex="-1"></a>        ndomCtr <span class="ot">&lt;&lt;-</span> ndomCtr <span class="sc">+</span> lenfpop</span>
<span id="cb235-122"><a href="#cb235-122" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb235-123"><a href="#cb235-123" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">"FATAL ERROR:</span><span class="sc">\n</span><span class="st">Archive Size Value "</span>,archivesize,<span class="st">" too small</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb235-124"><a href="#cb235-124" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">"Recommended Archive Size: 2.5*population size</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb235-125"><a href="#cb235-125" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">"Press Enter to exit</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb235-126"><a href="#cb235-126" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scan</span>(<span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb235-127"><a href="#cb235-127" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">"Goodbye !</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb235-128"><a href="#cb235-128" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>()    </span>
<span id="cb235-129"><a href="#cb235-129" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb235-130"><a href="#cb235-130" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb235-131"><a href="#cb235-131" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"No solution (Unreasonable constraints)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb235-132"><a href="#cb235-132" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Press Enter to exit</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb235-133"><a href="#cb235-133" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scan</span>(<span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb235-134"><a href="#cb235-134" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Goodbye !</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb235-135"><a href="#cb235-135" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stop</span>()</span>
<span id="cb235-136"><a href="#cb235-136" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb235-137"><a href="#cb235-137" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-138"><a href="#cb235-138" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb235-139"><a href="#cb235-139" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-140"><a href="#cb235-140" aria-hidden="true" tabindex="-1"></a>  <span class="do">#############################</span></span>
<span id="cb235-141"><a href="#cb235-141" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute Crowding Distance #</span></span>
<span id="cb235-142"><a href="#cb235-142" aria-hidden="true" tabindex="-1"></a>  <span class="do">#############################</span></span>
<span id="cb235-143"><a href="#cb235-143" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-144"><a href="#cb235-144" aria-hidden="true" tabindex="-1"></a>  crowding <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb235-145"><a href="#cb235-145" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-146"><a href="#cb235-146" aria-hidden="true" tabindex="-1"></a>    crowdDist[<span class="dv">1</span><span class="sc">:</span>ndomCtr] <span class="ot">&lt;&lt;-</span> <span class="fl">0.0</span></span>
<span id="cb235-147"><a href="#cb235-147" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-148"><a href="#cb235-148" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(fncnt)) {</span>
<span id="cb235-149"><a href="#cb235-149" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb235-150"><a href="#cb235-150" aria-hidden="true" tabindex="-1"></a>      sorted_archive <span class="ot">&lt;-</span> <span class="fu">sort</span>(archiveFit[<span class="dv">1</span><span class="sc">:</span>ndomCtr,i],<span class="at">index.return=</span><span class="cn">TRUE</span>)</span>
<span id="cb235-151"><a href="#cb235-151" aria-hidden="true" tabindex="-1"></a>      valsa <span class="ot">&lt;-</span> sorted_archive<span class="sc">$</span>x</span>
<span id="cb235-152"><a href="#cb235-152" aria-hidden="true" tabindex="-1"></a>      ixsa <span class="ot">&lt;-</span> sorted_archive<span class="sc">$</span>ix  </span>
<span id="cb235-153"><a href="#cb235-153" aria-hidden="true" tabindex="-1"></a>      crowdDist[ixsa[<span class="dv">2</span><span class="sc">:</span>(ndomCtr<span class="dv">-1</span>)]] <span class="ot">&lt;&lt;-</span> crowdDist[ixsa[<span class="dv">2</span><span class="sc">:</span>(ndomCtr<span class="dv">-1</span>)]] <span class="sc">+</span> valsa[<span class="dv">3</span><span class="sc">:</span>ndomCtr] <span class="sc">-</span> valsa[<span class="dv">1</span><span class="sc">:</span>(ndomCtr<span class="dv">-2</span>)]</span>
<span id="cb235-154"><a href="#cb235-154" aria-hidden="true" tabindex="-1"></a>      maxcd <span class="ot">&lt;-</span> <span class="fu">which.max</span>(crowdDist[<span class="dv">1</span><span class="sc">:</span>ndomCtr])</span>
<span id="cb235-155"><a href="#cb235-155" aria-hidden="true" tabindex="-1"></a>      crowdDist[ixsa[<span class="dv">1</span>]] <span class="ot">&lt;&lt;-</span> crowdDist[ixsa[<span class="dv">1</span>]] <span class="sc">+</span> crowdDist[maxcd]</span>
<span id="cb235-156"><a href="#cb235-156" aria-hidden="true" tabindex="-1"></a>      crowdDist[ixsa[ndomCtr]] <span class="ot">&lt;&lt;-</span> crowdDist[ixsa[ndomCtr]] <span class="sc">+</span> crowdDist[maxcd]   </span>
<span id="cb235-157"><a href="#cb235-157" aria-hidden="true" tabindex="-1"></a>      mincd <span class="ot">&lt;-</span> <span class="fu">which.min</span>(crowdDist[<span class="dv">1</span><span class="sc">:</span>ndomCtr])</span>
<span id="cb235-158"><a href="#cb235-158" aria-hidden="true" tabindex="-1"></a>      crowdDist[<span class="dv">1</span><span class="sc">:</span>ndomCtr] <span class="ot">&lt;&lt;-</span> crowdDist[<span class="dv">1</span><span class="sc">:</span>ndomCtr]<span class="sc">/</span>(crowdDist[maxcd]<span class="sc">-</span>crowdDist[mincd])</span>
<span id="cb235-159"><a href="#cb235-159" aria-hidden="true" tabindex="-1"></a>    }  </span>
<span id="cb235-160"><a href="#cb235-160" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-161"><a href="#cb235-161" aria-hidden="true" tabindex="-1"></a>    sorted_cd <span class="ot">&lt;-</span> <span class="fu">sort</span>(crowdDist[<span class="dv">1</span><span class="sc">:</span>ndomCtr],<span class="at">decreasing=</span><span class="cn">TRUE</span>,<span class="at">index.return=</span><span class="cn">TRUE</span>)</span>
<span id="cb235-162"><a href="#cb235-162" aria-hidden="true" tabindex="-1"></a>    archiveVar[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sorted_cd<span class="sc">$</span>ix),] <span class="ot">&lt;&lt;-</span> archiveVar[sorted_cd<span class="sc">$</span>ix,]</span>
<span id="cb235-163"><a href="#cb235-163" aria-hidden="true" tabindex="-1"></a>    archiveFit[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sorted_cd<span class="sc">$</span>ix),] <span class="ot">&lt;&lt;-</span> archiveFit[sorted_cd<span class="sc">$</span>ix,]</span>
<span id="cb235-164"><a href="#cb235-164" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-165"><a href="#cb235-165" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb235-166"><a href="#cb235-166" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-167"><a href="#cb235-167" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-168"><a href="#cb235-168" aria-hidden="true" tabindex="-1"></a>  <span class="do">######################################</span></span>
<span id="cb235-169"><a href="#cb235-169" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update Personal Bests of Particles #</span></span>
<span id="cb235-170"><a href="#cb235-170" aria-hidden="true" tabindex="-1"></a>  <span class="do">######################################</span></span>
<span id="cb235-171"><a href="#cb235-171" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-172"><a href="#cb235-172" aria-hidden="true" tabindex="-1"></a>  update_pbests <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb235-173"><a href="#cb235-173" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-174"><a href="#cb235-174" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(opt <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb235-175"><a href="#cb235-175" aria-hidden="true" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">rowSums</span>((popFit<span class="sc">-</span>pbestsFit <span class="sc">&gt;</span>  <span class="fl">0.0</span>)<span class="sc">*</span><span class="dv">1</span>)</span>
<span id="cb235-176"><a href="#cb235-176" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb235-177"><a href="#cb235-177" aria-hidden="true" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">rowSums</span>((popFit<span class="sc">-</span>pbestsFit <span class="sc">&lt;</span>  <span class="fl">0.0</span>)<span class="sc">*</span><span class="dv">1</span>)</span>
<span id="cb235-178"><a href="#cb235-178" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb235-179"><a href="#cb235-179" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-180"><a href="#cb235-180" aria-hidden="true" tabindex="-1"></a>    ix1 <span class="ot">&lt;-</span> <span class="fu">which</span>(x <span class="sc">!=</span> <span class="dv">0</span> <span class="sc">&amp;</span> x <span class="sc">!=</span> fncnt)</span>
<span id="cb235-181"><a href="#cb235-181" aria-hidden="true" tabindex="-1"></a>    ix2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(ix1,<span class="fu">floor</span>(<span class="fu">length</span>(ix1)<span class="sc">/</span><span class="dv">2</span>),<span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb235-182"><a href="#cb235-182" aria-hidden="true" tabindex="-1"></a>    ix <span class="ot">&lt;-</span> <span class="fu">union</span>(<span class="fu">which</span>(x <span class="sc">==</span> fncnt),ix2)</span>
<span id="cb235-183"><a href="#cb235-183" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-184"><a href="#cb235-184" aria-hidden="true" tabindex="-1"></a>    pbestsVar[ix,] <span class="ot">&lt;&lt;-</span> popVar[ix,]  </span>
<span id="cb235-185"><a href="#cb235-185" aria-hidden="true" tabindex="-1"></a>    pbestsFit[ix,] <span class="ot">&lt;&lt;-</span> popFit[ix,]</span>
<span id="cb235-186"><a href="#cb235-186" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-187"><a href="#cb235-187" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb235-188"><a href="#cb235-188" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-189"><a href="#cb235-189" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################</span></span>
<span id="cb235-190"><a href="#cb235-190" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update Archive Particles #</span></span>
<span id="cb235-191"><a href="#cb235-191" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################</span></span>
<span id="cb235-192"><a href="#cb235-192" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-193"><a href="#cb235-193" aria-hidden="true" tabindex="-1"></a>  update_archive <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb235-194"><a href="#cb235-194" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(gn)) {</span>
<span id="cb235-195"><a href="#cb235-195" aria-hidden="true" tabindex="-1"></a>      z <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(<span class="fu">t</span>(<span class="fu">matrix</span>(<span class="sc">!</span><span class="fu">apply</span>(popVar,<span class="dv">1</span>,gn),<span class="at">ncol=</span>popsize)<span class="sc">*</span><span class="dv">1</span>)) </span>
<span id="cb235-196"><a href="#cb235-196" aria-hidden="true" tabindex="-1"></a>      minz <span class="ot">&lt;-</span> <span class="fu">min</span>(z)</span>
<span id="cb235-197"><a href="#cb235-197" aria-hidden="true" tabindex="-1"></a>      ix <span class="ot">&lt;-</span> <span class="fu">which</span>(z <span class="sc">==</span> minz)</span>
<span id="cb235-198"><a href="#cb235-198" aria-hidden="true" tabindex="-1"></a>      lenix <span class="ot">&lt;-</span> <span class="fu">length</span>(ix)</span>
<span id="cb235-199"><a href="#cb235-199" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb235-200"><a href="#cb235-200" aria-hidden="true" tabindex="-1"></a>      ixfpop <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb235-201"><a href="#cb235-201" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (i <span class="cf">in</span> ix) {   </span>
<span id="cb235-202"><a href="#cb235-202" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (opt <span class="sc">==</span> <span class="dv">1</span>) {    </span>
<span id="cb235-203"><a href="#cb235-203" aria-hidden="true" tabindex="-1"></a>          x <span class="ot">&lt;-</span> (<span class="fu">t</span>(<span class="fu">matrix</span>(<span class="fu">rep</span>(popFit[i,],lenix),<span class="at">nrow=</span>fncnt))<span class="sc">-</span>popFit[ix,] <span class="sc">&lt;</span> <span class="fl">0.0</span>)<span class="sc">*</span><span class="dv">1</span></span>
<span id="cb235-204"><a href="#cb235-204" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb235-205"><a href="#cb235-205" aria-hidden="true" tabindex="-1"></a>          x <span class="ot">&lt;-</span> (<span class="fu">t</span>(<span class="fu">matrix</span>(<span class="fu">rep</span>(popFit[i,],lenix),<span class="at">nrow=</span>fncnt))<span class="sc">-</span>popFit[ix,] <span class="sc">&gt;</span> <span class="fl">0.0</span>)<span class="sc">*</span><span class="dv">1</span></span>
<span id="cb235-206"><a href="#cb235-206" aria-hidden="true" tabindex="-1"></a>        }         </span>
<span id="cb235-207"><a href="#cb235-207" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>((<span class="fu">max</span>(<span class="fu">rowSums</span>(x)) <span class="sc">==</span> fncnt) <span class="sc">==</span> <span class="cn">FALSE</span>){</span>
<span id="cb235-208"><a href="#cb235-208" aria-hidden="true" tabindex="-1"></a>          ixfpop <span class="ot">&lt;-</span> <span class="fu">c</span>(ixfpop,i)</span>
<span id="cb235-209"><a href="#cb235-209" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb235-210"><a href="#cb235-210" aria-hidden="true" tabindex="-1"></a>      } </span>
<span id="cb235-211"><a href="#cb235-211" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb235-212"><a href="#cb235-212" aria-hidden="true" tabindex="-1"></a>      ixfpop <span class="ot">=</span><span class="fu">seq</span>(popsize)</span>
<span id="cb235-213"><a href="#cb235-213" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb235-214"><a href="#cb235-214" aria-hidden="true" tabindex="-1"></a>    lenfpop <span class="ot">&lt;-</span> <span class="fu">length</span>(ixfpop)</span>
<span id="cb235-215"><a href="#cb235-215" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-216"><a href="#cb235-216" aria-hidden="true" tabindex="-1"></a>    ixinspop <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb235-217"><a href="#cb235-217" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> ixfpop) { </span>
<span id="cb235-218"><a href="#cb235-218" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb235-219"><a href="#cb235-219" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (opt <span class="sc">==</span> <span class="dv">1</span>) {    </span>
<span id="cb235-220"><a href="#cb235-220" aria-hidden="true" tabindex="-1"></a>        x <span class="ot">&lt;-</span> (<span class="fu">t</span>(<span class="fu">matrix</span>(<span class="fu">rep</span>(popFit[i,],ndomCtr),<span class="at">nrow=</span>fncnt))<span class="sc">-</span>archiveFit[<span class="dv">1</span><span class="sc">:</span>ndomCtr,] <span class="sc">&lt;</span> <span class="fl">0.0</span>)<span class="sc">*</span><span class="dv">1</span></span>
<span id="cb235-221"><a href="#cb235-221" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb235-222"><a href="#cb235-222" aria-hidden="true" tabindex="-1"></a>        x <span class="ot">&lt;-</span> (<span class="fu">t</span>(<span class="fu">matrix</span>(<span class="fu">rep</span>(popFit[i,],ndomCtr),<span class="at">nrow=</span>fncnt))<span class="sc">-</span>archiveFit[<span class="dv">1</span><span class="sc">:</span>ndomCtr,] <span class="sc">&gt;</span> <span class="fl">0.0</span>)<span class="sc">*</span><span class="dv">1</span></span>
<span id="cb235-223"><a href="#cb235-223" aria-hidden="true" tabindex="-1"></a>      }         </span>
<span id="cb235-224"><a href="#cb235-224" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>((<span class="fu">max</span>(<span class="fu">rowSums</span>(x)) <span class="sc">==</span> fncnt) <span class="sc">==</span> <span class="cn">FALSE</span>) {</span>
<span id="cb235-225"><a href="#cb235-225" aria-hidden="true" tabindex="-1"></a>        ixinspop <span class="ot">&lt;-</span> <span class="fu">c</span>(ixinspop,i)</span>
<span id="cb235-226"><a href="#cb235-226" aria-hidden="true" tabindex="-1"></a>      } </span>
<span id="cb235-227"><a href="#cb235-227" aria-hidden="true" tabindex="-1"></a>    }  </span>
<span id="cb235-228"><a href="#cb235-228" aria-hidden="true" tabindex="-1"></a>    leninspop <span class="ot">&lt;-</span> <span class="fu">length</span>(ixinspop)</span>
<span id="cb235-229"><a href="#cb235-229" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-230"><a href="#cb235-230" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(leninspop <span class="sc">!=</span> <span class="dv">0</span>){  </span>
<span id="cb235-231"><a href="#cb235-231" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (ndomCtr <span class="sc">+</span> leninspop <span class="sc">&lt;=</span> archivesize) {</span>
<span id="cb235-232"><a href="#cb235-232" aria-hidden="true" tabindex="-1"></a>        archiveVar[(ndomCtr<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(ndomCtr<span class="sc">+</span>leninspop),] <span class="ot">&lt;&lt;-</span> popVar[ixinspop,]</span>
<span id="cb235-233"><a href="#cb235-233" aria-hidden="true" tabindex="-1"></a>        archiveFit[(ndomCtr<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(ndomCtr<span class="sc">+</span>leninspop),] <span class="ot">&lt;&lt;-</span> popFit[ixinspop,]</span>
<span id="cb235-234"><a href="#cb235-234" aria-hidden="true" tabindex="-1"></a>        ndomCtr <span class="ot">&lt;&lt;-</span> ndomCtr <span class="sc">+</span> leninspop</span>
<span id="cb235-235"><a href="#cb235-235" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb235-236"><a href="#cb235-236" aria-hidden="true" tabindex="-1"></a>        <span class="fu">crowding</span>()</span>
<span id="cb235-237"><a href="#cb235-237" aria-hidden="true" tabindex="-1"></a>        bottom <span class="ot">&lt;-</span> <span class="fu">floor</span>(ndomCtr<span class="sc">*</span><span class="fl">0.9</span>)      </span>
<span id="cb235-238"><a href="#cb235-238" aria-hidden="true" tabindex="-1"></a>        cnt <span class="ot">&lt;-</span> <span class="fu">min</span>((archivesize<span class="sc">-</span>bottom),leninspop) </span>
<span id="cb235-239"><a href="#cb235-239" aria-hidden="true" tabindex="-1"></a>        ixinssel <span class="ot">&lt;-</span> <span class="fu">sample</span>(ixinspop,cnt,<span class="at">replace=</span>F)</span>
<span id="cb235-240"><a href="#cb235-240" aria-hidden="true" tabindex="-1"></a>        ixreplace <span class="ot">&lt;-</span> <span class="fu">sample</span>((archivesize<span class="sc">-</span>cnt)<span class="sc">:</span>archivesize,cnt,<span class="at">replace=</span>F)</span>
<span id="cb235-241"><a href="#cb235-241" aria-hidden="true" tabindex="-1"></a>        archiveVar[(archivesize<span class="sc">-</span>cnt<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>archivesize,] <span class="ot">&lt;&lt;-</span> popVar[ixinssel,]</span>
<span id="cb235-242"><a href="#cb235-242" aria-hidden="true" tabindex="-1"></a>        archiveFit[(archivesize<span class="sc">-</span>cnt<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>archivesize,] <span class="ot">&lt;&lt;-</span> popFit[ixinssel,]</span>
<span id="cb235-243"><a href="#cb235-243" aria-hidden="true" tabindex="-1"></a>        ndomCtr <span class="ot">&lt;&lt;-</span> archivesize  </span>
<span id="cb235-244"><a href="#cb235-244" aria-hidden="true" tabindex="-1"></a>      }      </span>
<span id="cb235-245"><a href="#cb235-245" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb235-246"><a href="#cb235-246" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="dv">0</span>) </span>
<span id="cb235-247"><a href="#cb235-247" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb235-248"><a href="#cb235-248" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-249"><a href="#cb235-249" aria-hidden="true" tabindex="-1"></a>    ixarc <span class="ot">&lt;-</span> <span class="fu">seq</span>(ndomCtr)</span>
<span id="cb235-250"><a href="#cb235-250" aria-hidden="true" tabindex="-1"></a>    ixndomarc <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb235-251"><a href="#cb235-251" aria-hidden="true" tabindex="-1"></a>    rmove <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb235-252"><a href="#cb235-252" aria-hidden="true" tabindex="-1"></a>    dup <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb235-253"><a href="#cb235-253" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> ixarc) {   </span>
<span id="cb235-254"><a href="#cb235-254" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (i <span class="sc">%in%</span> dup) {</span>
<span id="cb235-255"><a href="#cb235-255" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(verbosity <span class="sc">&gt;=</span> <span class="dv">3</span>) <span class="fu">cat</span>(<span class="st">"Duplicate Particle Found "</span>,i,<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb235-256"><a href="#cb235-256" aria-hidden="true" tabindex="-1"></a>        <span class="cf">next</span></span>
<span id="cb235-257"><a href="#cb235-257" aria-hidden="true" tabindex="-1"></a>      }  </span>
<span id="cb235-258"><a href="#cb235-258" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (opt <span class="sc">==</span> <span class="dv">1</span>) {    </span>
<span id="cb235-259"><a href="#cb235-259" aria-hidden="true" tabindex="-1"></a>        x <span class="ot">&lt;-</span> (<span class="fu">t</span>(<span class="fu">matrix</span>(<span class="fu">rep</span>(archiveFit[i,],ndomCtr),<span class="at">nrow=</span>fncnt))<span class="sc">-</span>archiveFit[ixarc,] <span class="sc">&lt;</span> <span class="fl">0.0</span>)<span class="sc">*</span><span class="dv">1</span></span>
<span id="cb235-260"><a href="#cb235-260" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb235-261"><a href="#cb235-261" aria-hidden="true" tabindex="-1"></a>        x <span class="ot">&lt;-</span> (<span class="fu">t</span>(<span class="fu">matrix</span>(<span class="fu">rep</span>(archiveFit[i,],ndomCtr),<span class="at">nrow=</span>fncnt))<span class="sc">-</span>archiveFit[ixarc,] <span class="sc">&gt;</span> <span class="fl">0.0</span>)<span class="sc">*</span><span class="dv">1</span></span>
<span id="cb235-262"><a href="#cb235-262" aria-hidden="true" tabindex="-1"></a>      }   </span>
<span id="cb235-263"><a href="#cb235-263" aria-hidden="true" tabindex="-1"></a>      rmove <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">setdiff</span>(<span class="fu">which</span>(<span class="fu">rowSums</span>(x) <span class="sc">==</span> <span class="dv">0</span>),i),rmove)</span>
<span id="cb235-264"><a href="#cb235-264" aria-hidden="true" tabindex="-1"></a>      wich1 <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">which</span>(<span class="fu">rowSums</span>(x)<span class="sc">==</span><span class="dv">0</span>),i) </span>
<span id="cb235-265"><a href="#cb235-265" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">length</span>(wich1) <span class="sc">!=</span> <span class="dv">0</span>) {</span>
<span id="cb235-266"><a href="#cb235-266" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="sc">!</span>(i <span class="sc">%in%</span> wich1)){</span>
<span id="cb235-267"><a href="#cb235-267" aria-hidden="true" tabindex="-1"></a>          <span class="cf">for</span> (j <span class="cf">in</span> wich1) {</span>
<span id="cb235-268"><a href="#cb235-268" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span>(<span class="fu">all</span>(archiveFit[j,] <span class="sc">==</span> archiveFit[i,])){</span>
<span id="cb235-269"><a href="#cb235-269" aria-hidden="true" tabindex="-1"></a>              dup <span class="ot">&lt;-</span> <span class="fu">c</span>(j,dup)</span>
<span id="cb235-270"><a href="#cb235-270" aria-hidden="true" tabindex="-1"></a>            } </span>
<span id="cb235-271"><a href="#cb235-271" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb235-272"><a href="#cb235-272" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb235-273"><a href="#cb235-273" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb235-274"><a href="#cb235-274" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb235-275"><a href="#cb235-275" aria-hidden="true" tabindex="-1"></a>    }  </span>
<span id="cb235-276"><a href="#cb235-276" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-277"><a href="#cb235-277" aria-hidden="true" tabindex="-1"></a>    rmove <span class="ot">&lt;-</span> <span class="fu">union</span>(rmove,dup)</span>
<span id="cb235-278"><a href="#cb235-278" aria-hidden="true" tabindex="-1"></a>    lenrem <span class="ot">&lt;-</span> <span class="fu">length</span>(rmove)</span>
<span id="cb235-279"><a href="#cb235-279" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(lenrem <span class="sc">!=</span> <span class="dv">0</span>){</span>
<span id="cb235-280"><a href="#cb235-280" aria-hidden="true" tabindex="-1"></a>      cor <span class="ot">=</span> <span class="fu">setdiff</span>(<span class="fu">seq</span>(ndomCtr),rmove)</span>
<span id="cb235-281"><a href="#cb235-281" aria-hidden="true" tabindex="-1"></a>      ndomCtr <span class="ot">&lt;&lt;-</span> <span class="fu">length</span>(cor)  </span>
<span id="cb235-282"><a href="#cb235-282" aria-hidden="true" tabindex="-1"></a>      archiveVar[<span class="dv">1</span><span class="sc">:</span>ndomCtr,] <span class="ot">&lt;&lt;-</span> archiveVar[cor,]</span>
<span id="cb235-283"><a href="#cb235-283" aria-hidden="true" tabindex="-1"></a>      archiveFit[<span class="dv">1</span><span class="sc">:</span>ndomCtr,] <span class="ot">&lt;&lt;-</span> archiveFit[cor,]</span>
<span id="cb235-284"><a href="#cb235-284" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb235-285"><a href="#cb235-285" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-286"><a href="#cb235-286" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb235-287"><a href="#cb235-287" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-288"><a href="#cb235-288" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-289"><a href="#cb235-289" aria-hidden="true" tabindex="-1"></a>  <span class="do">#############################################</span></span>
<span id="cb235-290"><a href="#cb235-290" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute Velocity of Particles in Population</span></span>
<span id="cb235-291"><a href="#cb235-291" aria-hidden="true" tabindex="-1"></a>  <span class="do">#############################################</span></span>
<span id="cb235-292"><a href="#cb235-292" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-293"><a href="#cb235-293" aria-hidden="true" tabindex="-1"></a>  compute_velocity <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb235-294"><a href="#cb235-294" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-295"><a href="#cb235-295" aria-hidden="true" tabindex="-1"></a>    top <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">floor</span>((ndomCtr<span class="sc">*</span><span class="fl">0.1</span>)),<span class="dv">1</span>)</span>
<span id="cb235-296"><a href="#cb235-296" aria-hidden="true" tabindex="-1"></a>    gBest <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>top,<span class="dv">1</span>,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb235-297"><a href="#cb235-297" aria-hidden="true" tabindex="-1"></a>    gBestmat <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">matrix</span>(<span class="fu">rep</span>(archiveVar[gBest,],popsize),<span class="at">nrow=</span>varcnt))</span>
<span id="cb235-298"><a href="#cb235-298" aria-hidden="true" tabindex="-1"></a>    randum1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(popsize<span class="sc">*</span>varcnt),popsize,varcnt) </span>
<span id="cb235-299"><a href="#cb235-299" aria-hidden="true" tabindex="-1"></a>    randum2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(popsize<span class="sc">*</span>varcnt),popsize,varcnt)</span>
<span id="cb235-300"><a href="#cb235-300" aria-hidden="true" tabindex="-1"></a>    velocity[<span class="dv">1</span><span class="sc">:</span>popsize,] <span class="ot">&lt;&lt;-</span> w<span class="sc">*</span>velocity[<span class="dv">1</span><span class="sc">:</span>popsize,] <span class="sc">+</span> c1<span class="sc">*</span>randum1<span class="sc">*</span>(pbestsVar<span class="sc">-</span>popVar) <span class="sc">+</span> c2<span class="sc">*</span>randum2<span class="sc">*</span>(gBestmat<span class="sc">-</span>popVar) </span>
<span id="cb235-301"><a href="#cb235-301" aria-hidden="true" tabindex="-1"></a>    popVar[<span class="dv">1</span><span class="sc">:</span>popsize,] <span class="ot">&lt;&lt;-</span> popVar[<span class="dv">1</span><span class="sc">:</span>popsize,] <span class="sc">+</span> velocity[<span class="dv">1</span><span class="sc">:</span>popsize,]</span>
<span id="cb235-302"><a href="#cb235-302" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-303"><a href="#cb235-303" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb235-304"><a href="#cb235-304" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-305"><a href="#cb235-305" aria-hidden="true" tabindex="-1"></a>  <span class="do">##############################################</span></span>
<span id="cb235-306"><a href="#cb235-306" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Maintain Particles within Feasibility Region</span></span>
<span id="cb235-307"><a href="#cb235-307" aria-hidden="true" tabindex="-1"></a>  <span class="do">##############################################</span></span>
<span id="cb235-308"><a href="#cb235-308" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-309"><a href="#cb235-309" aria-hidden="true" tabindex="-1"></a>  maintain_particles <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb235-310"><a href="#cb235-310" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-311"><a href="#cb235-311" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq</span>(varcnt)) {    </span>
<span id="cb235-312"><a href="#cb235-312" aria-hidden="true" tabindex="-1"></a>      wich1 <span class="ot">&lt;-</span> <span class="fu">which</span>(popVar[,j] <span class="sc">&lt;</span> minvalue[j])</span>
<span id="cb235-313"><a href="#cb235-313" aria-hidden="true" tabindex="-1"></a>      wich2 <span class="ot">&lt;-</span> <span class="fu">which</span>(popVar[,j] <span class="sc">&gt;</span> maxvalue[j])</span>
<span id="cb235-314"><a href="#cb235-314" aria-hidden="true" tabindex="-1"></a>      popVar[wich1,j] <span class="ot">&lt;&lt;-</span> minvalue[j]</span>
<span id="cb235-315"><a href="#cb235-315" aria-hidden="true" tabindex="-1"></a>      popVar[wich2,j] <span class="ot">&lt;&lt;-</span> maxvalue[j]</span>
<span id="cb235-316"><a href="#cb235-316" aria-hidden="true" tabindex="-1"></a>      wich12 <span class="ot">&lt;-</span> <span class="fu">union</span>(wich1,wich2)</span>
<span id="cb235-317"><a href="#cb235-317" aria-hidden="true" tabindex="-1"></a>      velocity[wich12,j] <span class="ot">&lt;&lt;-</span> <span class="sc">-</span><span class="fl">1.0</span><span class="sc">*</span>velocity[wich12,j]</span>
<span id="cb235-318"><a href="#cb235-318" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb235-319"><a href="#cb235-319" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-320"><a href="#cb235-320" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb235-321"><a href="#cb235-321" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-322"><a href="#cb235-322" aria-hidden="true" tabindex="-1"></a>  <span class="do">######################################</span></span>
<span id="cb235-323"><a href="#cb235-323" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Mutate Function (adapted from MOPSO)</span></span>
<span id="cb235-324"><a href="#cb235-324" aria-hidden="true" tabindex="-1"></a>  <span class="do">######################################</span></span>
<span id="cb235-325"><a href="#cb235-325" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-326"><a href="#cb235-326" aria-hidden="true" tabindex="-1"></a>  mutate <span class="ot">&lt;-</span> <span class="cf">function</span>() { </span>
<span id="cb235-327"><a href="#cb235-327" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-328"><a href="#cb235-328" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(t <span class="sc">&gt;=</span> maxgen<span class="sc">*</span>pMut)</span>
<span id="cb235-329"><a href="#cb235-329" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb235-330"><a href="#cb235-330" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-331"><a href="#cb235-331" aria-hidden="true" tabindex="-1"></a>    rangev <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length=</span>varcnt)</span>
<span id="cb235-332"><a href="#cb235-332" aria-hidden="true" tabindex="-1"></a>    flip <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> (<span class="dv">1</span><span class="sc">-</span>(t<span class="sc">/</span>(maxgen<span class="sc">*</span>pMut)))<span class="sc">^</span><span class="fl">1.5</span>,<span class="dv">1</span>,<span class="dv">0</span>) </span>
<span id="cb235-333"><a href="#cb235-333" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(flip) {</span>
<span id="cb235-334"><a href="#cb235-334" aria-hidden="true" tabindex="-1"></a>      dim <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>varcnt,<span class="dv">1</span>,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb235-335"><a href="#cb235-335" aria-hidden="true" tabindex="-1"></a>      rangev[<span class="dv">1</span><span class="sc">:</span>varcnt] <span class="ot">&lt;-</span> (maxvalue[<span class="dv">1</span><span class="sc">:</span>varcnt] <span class="sc">-</span> minvalue[<span class="dv">1</span><span class="sc">:</span>varcnt])<span class="sc">*</span><span class="fl">0.5</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>(t<span class="sc">/</span>(maxgen<span class="sc">*</span>pMut)))<span class="sc">^</span><span class="fl">1.5</span></span>
<span id="cb235-336"><a href="#cb235-336" aria-hidden="true" tabindex="-1"></a>      wich1 <span class="ot">&lt;-</span> <span class="fu">which</span>((popVar[,dim] <span class="sc">-</span> rangev[dim]) <span class="sc">&lt;</span> minvalue[dim])</span>
<span id="cb235-337"><a href="#cb235-337" aria-hidden="true" tabindex="-1"></a>      wich2 <span class="ot">&lt;-</span> <span class="fu">which</span>((popVar[,dim] <span class="sc">+</span> rangev[dim]) <span class="sc">&gt;</span> maxvalue[dim])</span>
<span id="cb235-338"><a href="#cb235-338" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">length</span>(wich1) <span class="sc">!=</span> <span class="dv">0</span>) {</span>
<span id="cb235-339"><a href="#cb235-339" aria-hidden="true" tabindex="-1"></a>        minvaluetemp[wich1,dim] <span class="ot">&lt;&lt;-</span> minvalue[dim]</span>
<span id="cb235-340"><a href="#cb235-340" aria-hidden="true" tabindex="-1"></a>        minvaluetemp[<span class="sc">-</span>wich1,dim] <span class="ot">&lt;&lt;-</span> popVar[<span class="sc">-</span>wich1,dim] <span class="sc">-</span> rangev[dim]</span>
<span id="cb235-341"><a href="#cb235-341" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb235-342"><a href="#cb235-342" aria-hidden="true" tabindex="-1"></a>        minvaluetemp[,dim] <span class="ot">&lt;&lt;-</span> popVar[,dim] <span class="sc">-</span> rangev[dim]      </span>
<span id="cb235-343"><a href="#cb235-343" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb235-344"><a href="#cb235-344" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">length</span>(wich2) <span class="sc">!=</span> <span class="dv">0</span>) {</span>
<span id="cb235-345"><a href="#cb235-345" aria-hidden="true" tabindex="-1"></a>        maxvaluetemp[wich2,dim] <span class="ot">&lt;&lt;-</span> maxvalue[dim]</span>
<span id="cb235-346"><a href="#cb235-346" aria-hidden="true" tabindex="-1"></a>        maxvaluetemp[<span class="sc">-</span>wich2,dim] <span class="ot">&lt;&lt;-</span> popVar[<span class="sc">-</span>wich2,dim] <span class="sc">+</span> rangev[dim]</span>
<span id="cb235-347"><a href="#cb235-347" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb235-348"><a href="#cb235-348" aria-hidden="true" tabindex="-1"></a>        maxvaluetemp[,dim] <span class="ot">&lt;&lt;-</span> popVar[,dim] <span class="sc">+</span> rangev[dim]</span>
<span id="cb235-349"><a href="#cb235-349" aria-hidden="true" tabindex="-1"></a>      } </span>
<span id="cb235-350"><a href="#cb235-350" aria-hidden="true" tabindex="-1"></a>      popVar[,dim] <span class="ot">&lt;&lt;-</span> <span class="fu">runif</span>(popsize,<span class="at">min=</span>minvaluetemp[,dim],<span class="at">max=</span>maxvaluetemp[,dim]) </span>
<span id="cb235-351"><a href="#cb235-351" aria-hidden="true" tabindex="-1"></a>    } </span>
<span id="cb235-352"><a href="#cb235-352" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-353"><a href="#cb235-353" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb235-354"><a href="#cb235-354" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-355"><a href="#cb235-355" aria-hidden="true" tabindex="-1"></a>  <span class="do">##############</span></span>
<span id="cb235-356"><a href="#cb235-356" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Main Program</span></span>
<span id="cb235-357"><a href="#cb235-357" aria-hidden="true" tabindex="-1"></a>  <span class="do">##############</span></span>
<span id="cb235-358"><a href="#cb235-358" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(verbosity <span class="sc">&gt;=</span> <span class="dv">1</span>) <span class="fu">cat</span>(<span class="st">"Welcome to MOPSO-CD</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb235-359"><a href="#cb235-359" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-360"><a href="#cb235-360" aria-hidden="true" tabindex="-1"></a>  t1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb235-361"><a href="#cb235-361" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb235-362"><a href="#cb235-362" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-363"><a href="#cb235-363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">initialize_pop</span>()</span>
<span id="cb235-364"><a href="#cb235-364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">initialize_vel</span>()</span>
<span id="cb235-365"><a href="#cb235-365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">evaluate</span>()</span>
<span id="cb235-366"><a href="#cb235-366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">store_pbests</span>()</span>
<span id="cb235-367"><a href="#cb235-367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">insert_nondom</span>()</span>
<span id="cb235-368"><a href="#cb235-368" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-369"><a href="#cb235-369" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (t <span class="sc">&lt;</span> maxgen) {</span>
<span id="cb235-370"><a href="#cb235-370" aria-hidden="true" tabindex="-1"></a>    t <span class="ot">&lt;-</span> t <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb235-371"><a href="#cb235-371" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-372"><a href="#cb235-372" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(verbosity <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb235-373"><a href="#cb235-373" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Generation "</span>,t,<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb235-374"><a href="#cb235-374" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-375"><a href="#cb235-375" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (ndomCtr<span class="sc">&gt;</span><span class="dv">2</span><span class="sc">*</span>fncnt)</span>
<span id="cb235-376"><a href="#cb235-376" aria-hidden="true" tabindex="-1"></a>      <span class="fu">crowding</span>()</span>
<span id="cb235-377"><a href="#cb235-377" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-378"><a href="#cb235-378" aria-hidden="true" tabindex="-1"></a>    <span class="fu">compute_velocity</span>()</span>
<span id="cb235-379"><a href="#cb235-379" aria-hidden="true" tabindex="-1"></a>    <span class="fu">maintain_particles</span>()</span>
<span id="cb235-380"><a href="#cb235-380" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>()</span>
<span id="cb235-381"><a href="#cb235-381" aria-hidden="true" tabindex="-1"></a>    <span class="fu">evaluate</span>()</span>
<span id="cb235-382"><a href="#cb235-382" aria-hidden="true" tabindex="-1"></a>    <span class="fu">update_archive</span>()</span>
<span id="cb235-383"><a href="#cb235-383" aria-hidden="true" tabindex="-1"></a>    <span class="fu">update_pbests</span>()</span>
<span id="cb235-384"><a href="#cb235-384" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-385"><a href="#cb235-385" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(verbosity <span class="sc">&gt;=</span> <span class="dv">3</span>){</span>
<span id="cb235-386"><a href="#cb235-386" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Variables</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb235-387"><a href="#cb235-387" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(archiveVar[<span class="dv">1</span><span class="sc">:</span>ndomCtr,])</span>
<span id="cb235-388"><a href="#cb235-388" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Objective Function Values:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb235-389"><a href="#cb235-389" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(archiveFit[<span class="dv">1</span><span class="sc">:</span>ndomCtr,])  </span>
<span id="cb235-390"><a href="#cb235-390" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb235-391"><a href="#cb235-391" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb235-392"><a href="#cb235-392" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-393"><a href="#cb235-393" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb235-394"><a href="#cb235-394" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-395"><a href="#cb235-395" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(verbosity <span class="sc">&gt;=</span> <span class="dv">2</span>){</span>
<span id="cb235-396"><a href="#cb235-396" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"###############################</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb235-397"><a href="#cb235-397" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"         FINAL VALUES</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb235-398"><a href="#cb235-398" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"###############################</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb235-399"><a href="#cb235-399" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Variables:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb235-400"><a href="#cb235-400" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(archiveVar[<span class="dv">1</span><span class="sc">:</span>ndomCtr,])</span>
<span id="cb235-401"><a href="#cb235-401" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Objective Function Values:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb235-402"><a href="#cb235-402" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(archiveFit[<span class="dv">1</span><span class="sc">:</span>ndomCtr,])  </span>
<span id="cb235-403"><a href="#cb235-403" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb235-404"><a href="#cb235-404" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-405"><a href="#cb235-405" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(verbosity <span class="sc">&gt;=</span> <span class="dv">1</span>){</span>
<span id="cb235-406"><a href="#cb235-406" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Nondominated Solutions: "</span>,ndomCtr,<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb235-407"><a href="#cb235-407" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Number of Generations: "</span>,t,<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb235-408"><a href="#cb235-408" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Computation Time: "</span>,<span class="fu">Sys.time</span>() <span class="sc">-</span> t1,<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb235-409"><a href="#cb235-409" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb235-410"><a href="#cb235-410" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-411"><a href="#cb235-411" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(gn)) {</span>
<span id="cb235-412"><a href="#cb235-412" aria-hidden="true" tabindex="-1"></a>    pareto <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"paramvalues"</span><span class="ot">=</span>archiveVar[<span class="dv">1</span><span class="sc">:</span>ndomCtr,],<span class="st">"objfnvalues"</span><span class="ot">=</span>archiveFit[<span class="dv">1</span><span class="sc">:</span>ndomCtr,],<span class="st">"numsols"</span><span class="ot">=</span>ndomCtr,</span>
<span id="cb235-413"><a href="#cb235-413" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"fn"</span><span class="ot">=</span>fn,<span class="st">"gn"</span><span class="ot">=</span>gn,<span class="st">"varcnt"</span><span class="ot">=</span>varcnt,<span class="st">"fncnt"</span><span class="ot">=</span>fncnt,<span class="st">"lowerbound"</span><span class="ot">=</span>lowerbound,<span class="st">"upperbound"</span><span class="ot">=</span>upperbound,<span class="st">"opt"</span><span class="ot">=</span>opt,<span class="st">"popsize"</span><span class="ot">=</span>popsize,<span class="st">"maxgen"</span><span class="ot">=</span>maxgen,<span class="st">"archivesize"</span><span class="ot">=</span>archivesize,<span class="st">"pMut"</span><span class="ot">=</span>pMut,<span class="st">"w"</span><span class="ot">=</span>w,<span class="st">"c1"</span><span class="ot">=</span>c1,<span class="st">"c2"</span><span class="ot">=</span>c2)</span>
<span id="cb235-414"><a href="#cb235-414" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb235-415"><a href="#cb235-415" aria-hidden="true" tabindex="-1"></a>    pareto <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"paramvalues"</span><span class="ot">=</span>archiveVar[<span class="dv">1</span><span class="sc">:</span>ndomCtr,],<span class="st">"objfnvalues"</span><span class="ot">=</span>archiveFit[<span class="dv">1</span><span class="sc">:</span>ndomCtr,],<span class="st">"numsols"</span><span class="ot">=</span>ndomCtr,</span>
<span id="cb235-416"><a href="#cb235-416" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"fn"</span><span class="ot">=</span>fn,<span class="st">"gn"</span><span class="ot">=</span><span class="cn">NULL</span>,<span class="st">"varcnt"</span><span class="ot">=</span>varcnt,<span class="st">"fncnt"</span><span class="ot">=</span>fncnt,<span class="st">"lowerbound"</span><span class="ot">=</span>lowerbound,<span class="st">"upperbound"</span><span class="ot">=</span>upperbound,<span class="st">"opt"</span><span class="ot">=</span>opt,<span class="st">"popsize"</span><span class="ot">=</span>popsize,<span class="st">"maxgen"</span><span class="ot">=</span>maxgen,<span class="st">"archivesize"</span><span class="ot">=</span>archivesize,<span class="st">"pMut"</span><span class="ot">=</span>pMut,<span class="st">"w"</span><span class="ot">=</span>w,<span class="st">"c1"</span><span class="ot">=</span>c1,<span class="st">"c2"</span><span class="ot">=</span>c2)  </span>
<span id="cb235-417"><a href="#cb235-417" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb235-418"><a href="#cb235-418" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-419"><a href="#cb235-419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">warnings</span>()</span>
<span id="cb235-420"><a href="#cb235-420" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-421"><a href="#cb235-421" aria-hidden="true" tabindex="-1"></a>  pareto<span class="sc">$</span>call <span class="ot">&lt;-</span> <span class="fu">match.call</span>()</span>
<span id="cb235-422"><a href="#cb235-422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">class</span>(pareto) <span class="ot">&lt;-</span> <span class="st">"pareto"</span></span>
<span id="cb235-423"><a href="#cb235-423" aria-hidden="true" tabindex="-1"></a>  pareto</span>
<span id="cb235-424"><a href="#cb235-424" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-425"><a href="#cb235-425" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Constraint of experimental design considering MOPSOCD syntax:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a>ro <span class="ot">&lt;-</span> (<span class="dv">2</span><span class="sc">^</span><span class="dv">3</span>)<span class="sc">^</span><span class="fl">0.25</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a>  g1 <span class="ot">&lt;-</span> <span class="sc">-</span>x[<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> x[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span>x[<span class="dv">3</span>]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> ro<span class="sc">^</span><span class="dv">2</span> <span class="sc">&lt;=</span> <span class="dv">0</span></span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(g1))</span>
<span id="cb236-6"><a href="#cb236-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Three-objective optimization function considering Fc, Ront, and MRR:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a>xgb_Fc_Ront_MRR <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># xgb_Ra</span></span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a>  f1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(xgb_Fc, <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="at">x1 =</span> x[<span class="dv">1</span>],</span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">x2 =</span> x[<span class="dv">2</span>],</span>
<span id="cb237-6"><a href="#cb237-6" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">x3 =</span> x[<span class="dv">3</span>]), <span class="at">nrow =</span> <span class="dv">1</span>))</span>
<span id="cb237-7"><a href="#cb237-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb237-8"><a href="#cb237-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># xgb_Fc</span></span>
<span id="cb237-9"><a href="#cb237-9" aria-hidden="true" tabindex="-1"></a>  f2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(xgb_Ront, <span class="at">newdata =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="at">x1 =</span> x[<span class="dv">1</span>],</span>
<span id="cb237-10"><a href="#cb237-10" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">x2 =</span> x[<span class="dv">2</span>],</span>
<span id="cb237-11"><a href="#cb237-11" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">x3 =</span> x[<span class="dv">3</span>]), <span class="at">nrow =</span> <span class="dv">1</span>))</span>
<span id="cb237-12"><a href="#cb237-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb237-13"><a href="#cb237-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># MRR, ap = 0.8</span></span>
<span id="cb237-14"><a href="#cb237-14" aria-hidden="true" tabindex="-1"></a>  f3 <span class="ot">&lt;-</span> <span class="sc">-</span>((x[<span class="dv">1</span>]<span class="sc">*</span><span class="dv">85</span><span class="sc">+</span><span class="dv">250</span>)<span class="sc">*</span>(x[<span class="dv">2</span>]<span class="sc">*</span><span class="fl">0.04+0.125</span>)<span class="sc">*</span><span class="fl">0.8</span>)</span>
<span id="cb237-15"><a href="#cb237-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb237-16"><a href="#cb237-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(f1,f2,f3))</span>
<span id="cb237-17"><a href="#cb237-17" aria-hidden="true" tabindex="-1"></a>} </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Solving through MOPSOCD:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>start <span class="ot">=</span> <span class="fu">Sys.time</span>()</span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>opttri2 <span class="ot">&lt;-</span> <span class="fu">mopsocd</span>(<span class="at">fn =</span> xgb_Fc_Ront_MRR, </span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">gn =</span> g,</span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">varcnt =</span> <span class="dv">3</span>,</span>
<span id="cb238-5"><a href="#cb238-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fncnt =</span> <span class="dv">3</span>,</span>
<span id="cb238-6"><a href="#cb238-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">lowerbound =</span> <span class="fu">rep</span>(<span class="sc">-</span>ro,<span class="dv">3</span>),</span>
<span id="cb238-7"><a href="#cb238-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">upperbound =</span> <span class="fu">rep</span>(ro,<span class="dv">3</span>), </span>
<span id="cb238-8"><a href="#cb238-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">opt =</span> <span class="dv">0</span>,</span>
<span id="cb238-9"><a href="#cb238-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">archivesize =</span> <span class="dv">300</span>)</span>
<span id="cb238-10"><a href="#cb238-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Sys.time</span>() <span class="sc">-</span> start)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 28.17396 secs</code></pre>
</div>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>opttri2_res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(opttri2<span class="sc">$</span>objfnvalues)</span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(opttri2_res) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Fc"</span>, <span class="st">"Ront"</span>, <span class="st">"MRR"</span>)</span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a>opttri2_res<span class="sc">$</span>MRR <span class="ot">&lt;-</span> <span class="sc">-</span>opttri2_res<span class="sc">$</span>MRR </span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter3D</span>(opttri2_res<span class="sc">$</span>Fc, </span>
<span id="cb240-6"><a href="#cb240-6" aria-hidden="true" tabindex="-1"></a>          opttri2_res<span class="sc">$</span>Ront, </span>
<span id="cb240-7"><a href="#cb240-7" aria-hidden="true" tabindex="-1"></a>          opttri2_res<span class="sc">$</span>MRR, </span>
<span id="cb240-8"><a href="#cb240-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="st">"navy"</span>, </span>
<span id="cb240-9"><a href="#cb240-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb240-10"><a href="#cb240-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">bty =</span> <span class="st">"b2"</span>,</span>
<span id="cb240-11"><a href="#cb240-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">theta =</span> <span class="dv">45</span>, <span class="at">phi =</span> <span class="dv">30</span>,</span>
<span id="cb240-12"><a href="#cb240-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">ticktype =</span> <span class="st">"detailed"</span>,</span>
<span id="cb240-13"><a href="#cb240-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"Ra"</span>,</span>
<span id="cb240-14"><a href="#cb240-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span><span class="st">"Ront"</span>, </span>
<span id="cb240-15"><a href="#cb240-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">zlab =</span> <span class="st">"MRR"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MOEA_XGB_Internal_turning_PEEK_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Hypervolume calculation for MOPSOCD:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a>ref <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">165</span>, <span class="sc">-</span><span class="dv">7</span>)</span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dominated_hypervolume</span>(<span class="fu">as.matrix</span>(<span class="fu">t</span>(opttri2<span class="sc">$</span>objfnvalues)), ref)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 60343.94</code></pre>
</div>
</div>
<p>Spacing between solutions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a>ed <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(opttri2<span class="sc">$</span>objfnvalues, <span class="at">diag =</span> F, <span class="at">upper =</span> T), <span class="at">nrow =</span> <span class="fu">nrow</span>(opttri2<span class="sc">$</span>value))</span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a>ed <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(ed)</span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a>ed[ed <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a>mindist <span class="ot">&lt;-</span> <span class="fu">apply</span>(ed, <span class="dv">1</span>, <span class="at">FUN =</span> min, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true" tabindex="-1"></a>Spacing <span class="ot">&lt;-</span> <span class="fu">sd</span>(mindist)</span>
<span id="cb243-6"><a href="#cb243-6" aria-hidden="true" tabindex="-1"></a>Spacing</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.046342</code></pre>
</div>
</div>
</section>
<section id="solving-through-nsga-ii" class="level3">
<h3 class="anchored" data-anchor-id="solving-through-nsga-ii">Solving through NSGA-II</h3>
<p>Constraint related to CCD design:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a>ro <span class="ot">&lt;-</span> (<span class="dv">2</span><span class="sc">^</span><span class="dv">3</span>)<span class="sc">^</span><span class="fl">0.25</span></span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a>  g1 <span class="ot">&lt;-</span> <span class="sc">-</span>x[<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> x[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span>x[<span class="dv">3</span>]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> ro<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(g1))</span>
<span id="cb245-6"><a href="#cb245-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Solving through NSGA-II:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">13</span>)</span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a>start <span class="ot">=</span> <span class="fu">Sys.time</span>()</span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a>opttri2 <span class="ot">&lt;-</span> <span class="fu">nsga2</span>(<span class="at">fn =</span> xgb_Fc_Ront_MRR, </span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">idim =</span> <span class="dv">3</span>,</span>
<span id="cb246-5"><a href="#cb246-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">odim =</span> <span class="dv">3</span>, </span>
<span id="cb246-6"><a href="#cb246-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">constraints =</span> gg,</span>
<span id="cb246-7"><a href="#cb246-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cdim =</span> <span class="dv">1</span>,</span>
<span id="cb246-8"><a href="#cb246-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">lower.bounds =</span> <span class="fu">rep</span>(<span class="sc">-</span>ro,<span class="dv">3</span>),</span>
<span id="cb246-9"><a href="#cb246-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">upper.bounds =</span> <span class="fu">rep</span>(ro,<span class="dv">3</span>), </span>
<span id="cb246-10"><a href="#cb246-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">popsize =</span> <span class="dv">300</span>, <span class="at">generations =</span> <span class="dv">100</span>)</span>
<span id="cb246-11"><a href="#cb246-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Sys.time</span>() <span class="sc">-</span> start)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 1.349235 mins</code></pre>
</div>
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a>opttri2_res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(opttri2<span class="sc">$</span>value)</span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(opttri2_res) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Fc"</span>, <span class="st">"Ront"</span>, <span class="st">"MRR"</span>)</span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a>opttri2_res<span class="sc">$</span>MRR <span class="ot">&lt;-</span> <span class="sc">-</span>opttri2_res<span class="sc">$</span>MRR </span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-5"><a href="#cb248-5" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter3D</span>(opttri2_res<span class="sc">$</span>Fc, </span>
<span id="cb248-6"><a href="#cb248-6" aria-hidden="true" tabindex="-1"></a>          opttri2_res<span class="sc">$</span>Ront, </span>
<span id="cb248-7"><a href="#cb248-7" aria-hidden="true" tabindex="-1"></a>          opttri2_res<span class="sc">$</span>MRR, </span>
<span id="cb248-8"><a href="#cb248-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="st">"mediumvioletred"</span>, </span>
<span id="cb248-9"><a href="#cb248-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb248-10"><a href="#cb248-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">bty =</span> <span class="st">"b2"</span>,</span>
<span id="cb248-11"><a href="#cb248-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">theta =</span> <span class="dv">45</span>, <span class="at">phi =</span> <span class="dv">30</span>,</span>
<span id="cb248-12"><a href="#cb248-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">ticktype =</span> <span class="st">"detailed"</span>,</span>
<span id="cb248-13"><a href="#cb248-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"Fc"</span>,</span>
<span id="cb248-14"><a href="#cb248-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span><span class="st">"Ront"</span>, </span>
<span id="cb248-15"><a href="#cb248-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">zlab =</span> <span class="st">"MRR"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MOEA_XGB_Internal_turning_PEEK_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Hypervolume calculation for NSGA-II:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a>ref <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">165</span>, <span class="sc">-</span><span class="dv">7</span>)</span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dominated_hypervolume</span>(<span class="fu">as.matrix</span>(<span class="fu">t</span>(opttri2<span class="sc">$</span>value)), ref)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 67945.77</code></pre>
</div>
</div>
<p>Spacing between solutions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a>ed <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(opttri2<span class="sc">$</span>value, <span class="at">diag =</span> F, <span class="at">upper =</span> T), <span class="at">nrow =</span> <span class="fu">nrow</span>(opttri2<span class="sc">$</span>value))</span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a>ed <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(ed)</span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a>ed[ed <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a>mindist <span class="ot">&lt;-</span> <span class="fu">apply</span>(ed, <span class="dv">1</span>, <span class="at">FUN =</span> min, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb251-5"><a href="#cb251-5" aria-hidden="true" tabindex="-1"></a>Spacing <span class="ot">&lt;-</span> <span class="fu">sd</span>(mindist)</span>
<span id="cb251-6"><a href="#cb251-6" aria-hidden="true" tabindex="-1"></a>Spacing</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.813947</code></pre>
</div>
</div>
</section>
<section id="convergence-of-hypervolume-considering-nsga-ii-best-results" class="level3">
<h3 class="anchored" data-anchor-id="convergence-of-hypervolume-considering-nsga-ii-best-results">Convergence of hypervolume considering NSGA-II (best results)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a>hv <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">10</span>)</span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb253-3"><a href="#cb253-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-4"><a href="#cb253-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">10</span>,<span class="dv">100</span>,<span class="at">by=</span><span class="dv">10</span>)){</span>
<span id="cb253-5"><a href="#cb253-5" aria-hidden="true" tabindex="-1"></a><span class="co">#print(g)</span></span>
<span id="cb253-6"><a href="#cb253-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb253-7"><a href="#cb253-7" aria-hidden="true" tabindex="-1"></a>opt_nsga2 <span class="ot">&lt;-</span> mco<span class="sc">::</span><span class="fu">nsga2</span>(<span class="at">fn =</span> xgb_Fc_Ront_MRR, </span>
<span id="cb253-8"><a href="#cb253-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">idim =</span> <span class="dv">3</span>,</span>
<span id="cb253-9"><a href="#cb253-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">odim =</span> <span class="dv">3</span>, </span>
<span id="cb253-10"><a href="#cb253-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">constraints =</span> gg,</span>
<span id="cb253-11"><a href="#cb253-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">cdim =</span> <span class="dv">1</span>,</span>
<span id="cb253-12"><a href="#cb253-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">lower.bounds =</span> <span class="fu">rep</span>(<span class="sc">-</span>ro,<span class="dv">3</span>),</span>
<span id="cb253-13"><a href="#cb253-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">upper.bounds =</span> <span class="fu">rep</span>(ro,<span class="dv">3</span>), </span>
<span id="cb253-14"><a href="#cb253-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">popsize =</span> <span class="dv">300</span>, <span class="at">generations =</span> i)</span>
<span id="cb253-15"><a href="#cb253-15" aria-hidden="true" tabindex="-1"></a>sol_nsga2 <span class="ot">&lt;-</span> opt_nsga2<span class="sc">$</span>value</span>
<span id="cb253-16"><a href="#cb253-16" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(sol_nsga2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>)</span>
<span id="cb253-17"><a href="#cb253-17" aria-hidden="true" tabindex="-1"></a>sol_nsga2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(sol_nsga2)</span>
<span id="cb253-18"><a href="#cb253-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-19"><a href="#cb253-19" aria-hidden="true" tabindex="-1"></a>hv[g] <span class="ot">&lt;-</span> <span class="fu">dominatedHypervolume</span>(<span class="fu">as.matrix</span>(sol_nsga2), ref)</span>
<span id="cb253-20"><a href="#cb253-20" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb253-21"><a href="#cb253-21" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb253-22"><a href="#cb253-22" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb253-23"><a href="#cb253-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb253-24"><a href="#cb253-24" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb253-25"><a href="#cb253-25" aria-hidden="true" tabindex="-1"></a>hv <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">generations =</span> <span class="fu">seq</span>(<span class="dv">10</span>,<span class="dv">100</span>,<span class="at">by=</span><span class="dv">10</span>),</span>
<span id="cb253-26"><a href="#cb253-26" aria-hidden="true" tabindex="-1"></a>                 <span class="at">hv =</span> hv)</span>
<span id="cb253-27"><a href="#cb253-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-28"><a href="#cb253-28" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(hv, <span class="fu">aes</span>(<span class="at">x =</span> generations, <span class="at">y =</span> hv)) <span class="sc">+</span> </span>
<span id="cb253-29"><a href="#cb253-29" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_line</span>(<span class="at">col =</span> <span class="st">"navy"</span>) <span class="sc">+</span></span>
<span id="cb253-30"><a href="#cb253-30" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">col =</span> <span class="st">"navy"</span>) <span class="sc">+</span> </span>
<span id="cb253-31"><a href="#cb253-31" aria-hidden="true" tabindex="-1"></a> <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>, <span class="at">by =</span><span class="dv">20</span>)) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MOEA_XGB_Internal_turning_PEEK_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
<section id="decision-making-through-pseudo-weights" class="level3">
<h3 class="anchored" data-anchor-id="decision-making-through-pseudo-weights">Decision making through pseudo-weights</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>niveis_otimos2 <span class="ot">&lt;-</span> opttri2<span class="sc">$</span>par</span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(niveis_otimos2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"x1"</span>,<span class="st">"x2"</span>,<span class="st">"x3"</span>)</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>niveis_otimos2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(niveis_otimos2)</span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a>niveis_otimos2<span class="sc">$</span>vc <span class="ot">&lt;-</span> niveis_otimos2<span class="sc">$</span>x1<span class="sc">*</span><span class="dv">85</span> <span class="sc">+</span> <span class="dv">250</span></span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a>niveis_otimos2<span class="sc">$</span>f <span class="ot">&lt;-</span> niveis_otimos2<span class="sc">$</span>x2<span class="sc">*</span><span class="fl">0.04</span> <span class="sc">+</span> <span class="fl">0.125</span></span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a>niveis_otimos2<span class="sc">$</span>fp <span class="ot">&lt;-</span> niveis_otimos2<span class="sc">$</span>x3<span class="sc">*</span><span class="dv">8</span> <span class="sc">+</span> <span class="dv">15</span></span>
<span id="cb254-7"><a href="#cb254-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-8"><a href="#cb254-8" aria-hidden="true" tabindex="-1"></a>opttri2_res_norm <span class="ot">&lt;-</span> opttri2_res</span>
<span id="cb254-9"><a href="#cb254-9" aria-hidden="true" tabindex="-1"></a>opttri2_res_norm<span class="sc">$</span>Fc <span class="ot">&lt;-</span> (opttri2_res_norm<span class="sc">$</span>Fc <span class="sc">-</span> <span class="fu">min</span>(opttri2_res_norm<span class="sc">$</span>Fc))<span class="sc">/</span></span>
<span id="cb254-10"><a href="#cb254-10" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">max</span>(opttri2_res_norm<span class="sc">$</span>Fc) <span class="sc">-</span> <span class="fu">min</span>(opttri2_res_norm<span class="sc">$</span>Fc))</span>
<span id="cb254-11"><a href="#cb254-11" aria-hidden="true" tabindex="-1"></a>opttri2_res_norm<span class="sc">$</span>Ront <span class="ot">&lt;-</span> (opttri2_res_norm<span class="sc">$</span>Ront <span class="sc">-</span> <span class="fu">min</span>(opttri2_res_norm<span class="sc">$</span>Ront))<span class="sc">/</span></span>
<span id="cb254-12"><a href="#cb254-12" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">max</span>(opttri2_res_norm<span class="sc">$</span>Ront) <span class="sc">-</span> <span class="fu">min</span>(opttri2_res_norm<span class="sc">$</span>Ront))</span>
<span id="cb254-13"><a href="#cb254-13" aria-hidden="true" tabindex="-1"></a>opttri2_res_norm<span class="sc">$</span>MRR <span class="ot">&lt;-</span> (<span class="sc">-</span>opttri2_res_norm<span class="sc">$</span>MRR <span class="sc">-</span> <span class="fu">min</span>(<span class="sc">-</span>opttri2_res_norm<span class="sc">$</span>MRR))<span class="sc">/</span></span>
<span id="cb254-14"><a href="#cb254-14" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">max</span>(<span class="sc">-</span>opttri2_res_norm<span class="sc">$</span>MRR) <span class="sc">-</span> <span class="fu">min</span>(<span class="sc">-</span>opttri2_res_norm<span class="sc">$</span>MRR))</span>
<span id="cb254-15"><a href="#cb254-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-16"><a href="#cb254-16" aria-hidden="true" tabindex="-1"></a>w1 <span class="ot">&lt;-</span> ((<span class="fu">max</span>(opttri2_res_norm<span class="sc">$</span>Fc) <span class="sc">-</span> opttri2_res_norm<span class="sc">$</span>Fc)<span class="sc">/</span></span>
<span id="cb254-17"><a href="#cb254-17" aria-hidden="true" tabindex="-1"></a>         (<span class="fu">max</span>(opttri2_res_norm<span class="sc">$</span>Fc)<span class="sc">-</span><span class="fu">min</span>(opttri2_res_norm<span class="sc">$</span>Fc)))<span class="sc">/</span></span>
<span id="cb254-18"><a href="#cb254-18" aria-hidden="true" tabindex="-1"></a>  (((<span class="fu">max</span>(opttri2_res_norm<span class="sc">$</span>Fc) <span class="sc">-</span> opttri2_res_norm<span class="sc">$</span>Fc)<span class="sc">/</span></span>
<span id="cb254-19"><a href="#cb254-19" aria-hidden="true" tabindex="-1"></a>      (<span class="fu">max</span>(opttri2_res_norm<span class="sc">$</span>Fc)<span class="sc">-</span><span class="fu">min</span>(opttri2_res_norm<span class="sc">$</span>Fc))) <span class="sc">+</span></span>
<span id="cb254-20"><a href="#cb254-20" aria-hidden="true" tabindex="-1"></a>     ((<span class="fu">max</span>(opttri2_res_norm<span class="sc">$</span>Ront) <span class="sc">-</span> opttri2_res_norm<span class="sc">$</span>Ront)<span class="sc">/</span></span>
<span id="cb254-21"><a href="#cb254-21" aria-hidden="true" tabindex="-1"></a>        (<span class="fu">max</span>(opttri2_res_norm<span class="sc">$</span>Ront)<span class="sc">-</span><span class="fu">min</span>(opttri2_res_norm<span class="sc">$</span>Ront))) <span class="sc">+</span></span>
<span id="cb254-22"><a href="#cb254-22" aria-hidden="true" tabindex="-1"></a>     ((<span class="fu">max</span>(opttri2_res_norm<span class="sc">$</span>MRR) <span class="sc">-</span> opttri2_res_norm<span class="sc">$</span>MRR)<span class="sc">/</span></span>
<span id="cb254-23"><a href="#cb254-23" aria-hidden="true" tabindex="-1"></a>        (<span class="fu">max</span>(opttri2_res_norm<span class="sc">$</span>MRR)<span class="sc">-</span><span class="fu">min</span>(opttri2_res_norm<span class="sc">$</span>MRR))))</span>
<span id="cb254-24"><a href="#cb254-24" aria-hidden="true" tabindex="-1"></a>w2 <span class="ot">&lt;-</span> ((<span class="fu">max</span>(opttri2_res_norm<span class="sc">$</span>Ront) <span class="sc">-</span> opttri2_res_norm<span class="sc">$</span>Ront)<span class="sc">/</span></span>
<span id="cb254-25"><a href="#cb254-25" aria-hidden="true" tabindex="-1"></a>         (<span class="fu">max</span>(opttri2_res_norm<span class="sc">$</span>Ront)<span class="sc">-</span><span class="fu">min</span>(opttri2_res_norm<span class="sc">$</span>Ront)))<span class="sc">/</span></span>
<span id="cb254-26"><a href="#cb254-26" aria-hidden="true" tabindex="-1"></a>  (((<span class="fu">max</span>(opttri2_res_norm<span class="sc">$</span>Fc) <span class="sc">-</span> opttri2_res_norm<span class="sc">$</span>Fc)<span class="sc">/</span></span>
<span id="cb254-27"><a href="#cb254-27" aria-hidden="true" tabindex="-1"></a>      (<span class="fu">max</span>(opttri2_res_norm<span class="sc">$</span>Fc)<span class="sc">-</span><span class="fu">min</span>(opttri2_res_norm<span class="sc">$</span>Fc))) <span class="sc">+</span></span>
<span id="cb254-28"><a href="#cb254-28" aria-hidden="true" tabindex="-1"></a>     ((<span class="fu">max</span>(opttri2_res_norm<span class="sc">$</span>Ront) <span class="sc">-</span> opttri2_res_norm<span class="sc">$</span>Ront)<span class="sc">/</span></span>
<span id="cb254-29"><a href="#cb254-29" aria-hidden="true" tabindex="-1"></a>        (<span class="fu">max</span>(opttri2_res_norm<span class="sc">$</span>Ront)<span class="sc">-</span><span class="fu">min</span>(opttri2_res_norm<span class="sc">$</span>Ront))) <span class="sc">+</span></span>
<span id="cb254-30"><a href="#cb254-30" aria-hidden="true" tabindex="-1"></a>     ((<span class="fu">max</span>(opttri2_res_norm<span class="sc">$</span>MRR) <span class="sc">-</span> opttri2_res_norm<span class="sc">$</span>MRR)<span class="sc">/</span></span>
<span id="cb254-31"><a href="#cb254-31" aria-hidden="true" tabindex="-1"></a>        (<span class="fu">max</span>(opttri2_res_norm<span class="sc">$</span>MRR)<span class="sc">-</span><span class="fu">min</span>(opttri2_res_norm<span class="sc">$</span>MRR))))</span>
<span id="cb254-32"><a href="#cb254-32" aria-hidden="true" tabindex="-1"></a>w3 <span class="ot">&lt;-</span> ((<span class="fu">max</span>(opttri2_res_norm<span class="sc">$</span>MRR) <span class="sc">-</span> opttri2_res_norm<span class="sc">$</span>MRR)<span class="sc">/</span></span>
<span id="cb254-33"><a href="#cb254-33" aria-hidden="true" tabindex="-1"></a>         (<span class="fu">max</span>(opttri2_res_norm<span class="sc">$</span>MRR)<span class="sc">-</span><span class="fu">min</span>(opttri2_res_norm<span class="sc">$</span>MRR)))<span class="sc">/</span></span>
<span id="cb254-34"><a href="#cb254-34" aria-hidden="true" tabindex="-1"></a>  (((<span class="fu">max</span>(opttri2_res_norm<span class="sc">$</span>Fc) <span class="sc">-</span> opttri2_res_norm<span class="sc">$</span>Fc)<span class="sc">/</span></span>
<span id="cb254-35"><a href="#cb254-35" aria-hidden="true" tabindex="-1"></a>      (<span class="fu">max</span>(opttri2_res_norm<span class="sc">$</span>Fc)<span class="sc">-</span><span class="fu">min</span>(opttri2_res_norm<span class="sc">$</span>Fc))) <span class="sc">+</span></span>
<span id="cb254-36"><a href="#cb254-36" aria-hidden="true" tabindex="-1"></a>     ((<span class="fu">max</span>(opttri2_res_norm<span class="sc">$</span>Ront) <span class="sc">-</span> opttri2_res_norm<span class="sc">$</span>Ront)<span class="sc">/</span></span>
<span id="cb254-37"><a href="#cb254-37" aria-hidden="true" tabindex="-1"></a>        (<span class="fu">max</span>(opttri2_res_norm<span class="sc">$</span>Ront)<span class="sc">-</span><span class="fu">min</span>(opttri2_res_norm<span class="sc">$</span>Ront))) <span class="sc">+</span></span>
<span id="cb254-38"><a href="#cb254-38" aria-hidden="true" tabindex="-1"></a>     ((<span class="fu">max</span>(opttri2_res_norm<span class="sc">$</span>MRR) <span class="sc">-</span> opttri2_res_norm<span class="sc">$</span>MRR)<span class="sc">/</span></span>
<span id="cb254-39"><a href="#cb254-39" aria-hidden="true" tabindex="-1"></a>        (<span class="fu">max</span>(opttri2_res_norm<span class="sc">$</span>MRR)<span class="sc">-</span><span class="fu">min</span>(opttri2_res_norm<span class="sc">$</span>MRR))))</span>
<span id="cb254-40"><a href="#cb254-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-41"><a href="#cb254-41" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(w1,w2,w3)</span>
<span id="cb254-42"><a href="#cb254-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-43"><a href="#cb254-43" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">round</span>(w,<span class="dv">2</span>)</span>
<span id="cb254-44"><a href="#cb254-44" aria-hidden="true" tabindex="-1"></a><span class="co">#rowSums(w)</span></span>
<span id="cb254-45"><a href="#cb254-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-46"><a href="#cb254-46" aria-hidden="true" tabindex="-1"></a>desired_w <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">w1 =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>,<span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>,  <span class="dv">0</span>,  <span class="dv">0</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>),</span>
<span id="cb254-47"><a href="#cb254-47" aria-hidden="true" tabindex="-1"></a>                        <span class="at">w2 =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>,  <span class="dv">0</span>,<span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>,  <span class="dv">0</span>,<span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>),</span>
<span id="cb254-48"><a href="#cb254-48" aria-hidden="true" tabindex="-1"></a>                        <span class="at">w3 =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,  <span class="dv">0</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>,  <span class="dv">0</span>,<span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>,<span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>))</span>
<span id="cb254-49"><a href="#cb254-49" aria-hidden="true" tabindex="-1"></a><span class="co"># rowSums(desired_w)</span></span>
<span id="cb254-50"><a href="#cb254-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-51"><a href="#cb254-51" aria-hidden="true" tabindex="-1"></a>dists <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(w))</span>
<span id="cb254-52"><a href="#cb254-52" aria-hidden="true" tabindex="-1"></a>selected_w <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(desired_w)) </span>
<span id="cb254-53"><a href="#cb254-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-54"><a href="#cb254-54" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(desired_w)){</span>
<span id="cb254-55"><a href="#cb254-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb254-56"><a href="#cb254-56" aria-hidden="true" tabindex="-1"></a>  dists[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">dist</span>(<span class="fu">rbind</span>(w[<span class="dv">1</span>,], desired_w[j,]))</span>
<span id="cb254-57"><a href="#cb254-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb254-58"><a href="#cb254-58" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">nrow</span>(w)){</span>
<span id="cb254-59"><a href="#cb254-59" aria-hidden="true" tabindex="-1"></a>    dists[i] <span class="ot">&lt;-</span> <span class="fu">dist</span>(<span class="fu">rbind</span>(w[i,], desired_w[j,]))</span>
<span id="cb254-60"><a href="#cb254-60" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb254-61"><a href="#cb254-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb254-62"><a href="#cb254-62" aria-hidden="true" tabindex="-1"></a>  selected_w[j] <span class="ot">&lt;-</span> <span class="fu">which.min</span>(dists)</span>
<span id="cb254-63"><a href="#cb254-63" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb254-64"><a href="#cb254-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-65"><a href="#cb254-65" aria-hidden="true" tabindex="-1"></a><span class="co">#selected_w</span></span>
<span id="cb254-66"><a href="#cb254-66" aria-hidden="true" tabindex="-1"></a><span class="co">#w[selected_w,]</span></span>
<span id="cb254-67"><a href="#cb254-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-68"><a href="#cb254-68" aria-hidden="true" tabindex="-1"></a>Solucoes_pseudo_w <span class="ot">&lt;-</span> <span class="fu">cbind</span>(desired_w, </span>
<span id="cb254-69"><a href="#cb254-69" aria-hidden="true" tabindex="-1"></a>                           niveis_otimos2[selected_w,],</span>
<span id="cb254-70"><a href="#cb254-70" aria-hidden="true" tabindex="-1"></a>                           opttri2_res[selected_w,])</span>
<span id="cb254-71"><a href="#cb254-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-72"><a href="#cb254-72" aria-hidden="true" tabindex="-1"></a>Solucoes_pseudo_w <span class="ot">&lt;-</span> <span class="fu">round</span>(Solucoes_pseudo_w,<span class="dv">3</span>)</span>
<span id="cb254-73"><a href="#cb254-73" aria-hidden="true" tabindex="-1"></a>Solucoes_pseudo_w</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       w1    w2    w3     x1     x2     x3      vc     f     fp     Fc    Ront
3   1.000 0.000 0.000 -1.349 -0.667 -0.551 135.350 0.098 10.591 22.810 141.864
1   0.000 1.000 0.000  0.778 -0.445  0.843 316.107 0.107 21.741 34.143  70.911
4   0.000 0.000 1.000  0.777  1.458  0.304 316.068 0.183 17.431 41.828  99.123
5   0.667 0.333 0.000 -0.389 -0.667  0.995 216.939 0.098 22.956 26.750 128.280
77  0.667 0.000 0.333  0.166 -0.667 -0.590 264.084 0.098 10.278 25.864 143.924
6   0.333 0.667 0.000  0.824 -1.342  0.577 319.998 0.071 19.614 31.838  76.438
4.1 0.333 0.000 0.667  0.777  1.458  0.304 316.068 0.183 17.431 41.828  99.123
16  0.000 0.667 0.333  1.599  0.219  0.456 385.877 0.134 18.648 42.444  72.388
4.2 0.000 0.333 0.667  0.777  1.458  0.304 316.068 0.183 17.431 41.828  99.123
25  0.333 0.333 0.333  1.527 -0.667 -0.218 379.784 0.098 13.254 29.827  91.293
       MRR
3   10.647
1   27.112
4   46.352
5   17.062
77  20.774
6   18.259
4.1 46.352
16  41.296
4.2 46.352
25  29.875</code></pre>
</div>
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(xtable)</span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a><span class="co"># xtable(Solucoes_pseudo_w)</span></span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter3D</span>(opttri2_res<span class="sc">$</span>Fc, </span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a>          opttri2_res<span class="sc">$</span>Ront, </span>
<span id="cb256-6"><a href="#cb256-6" aria-hidden="true" tabindex="-1"></a>          opttri2_res<span class="sc">$</span>MRR, </span>
<span id="cb256-7"><a href="#cb256-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="st">"mediumvioletred"</span>, </span>
<span id="cb256-8"><a href="#cb256-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb256-9"><a href="#cb256-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">bty =</span> <span class="st">"b2"</span>,</span>
<span id="cb256-10"><a href="#cb256-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">theta =</span> <span class="dv">45</span>, <span class="at">phi =</span> <span class="dv">30</span>,</span>
<span id="cb256-11"><a href="#cb256-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">ticktype =</span> <span class="st">"detailed"</span>,</span>
<span id="cb256-12"><a href="#cb256-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"Fc"</span>,</span>
<span id="cb256-13"><a href="#cb256-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span><span class="st">"Ront"</span>, </span>
<span id="cb256-14"><a href="#cb256-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">zlab =</span> <span class="st">"MRR"</span>)</span>
<span id="cb256-15"><a href="#cb256-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-16"><a href="#cb256-16" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter3D</span>(opttri2_res[selected_w,]<span class="sc">$</span>Fc, </span>
<span id="cb256-17"><a href="#cb256-17" aria-hidden="true" tabindex="-1"></a>          opttri2_res[selected_w,]<span class="sc">$</span>Ront, </span>
<span id="cb256-18"><a href="#cb256-18" aria-hidden="true" tabindex="-1"></a>          opttri2_res[selected_w,]<span class="sc">$</span>MRR, </span>
<span id="cb256-19"><a href="#cb256-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">colvar =</span> <span class="cn">NULL</span>,</span>
<span id="cb256-20"><a href="#cb256-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">ticktype =</span> <span class="st">"detailed"</span>,</span>
<span id="cb256-21"><a href="#cb256-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">pch =</span> <span class="dv">0</span>, <span class="at">cex =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"b2"</span>,</span>
<span id="cb256-22"><a href="#cb256-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">phi =</span> <span class="dv">30</span>, <span class="at">theta =</span><span class="dv">140</span>,</span>
<span id="cb256-23"><a href="#cb256-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MOEA_XGB_Internal_turning_PEEK_files/figure-html/unnamed-chunk-86-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>